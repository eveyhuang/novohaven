{"ast":null,"code":"import _objectSpread from\"/Users/eveyhuang/Documents/novohaven-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useMemo,useRef}from'react';import{useParams,useNavigate}from'react-router-dom';import api from'../../services/api';import{Button,Input,TextArea,Select,Card,CardBody,CardHeader,Modal,DynamicInput}from'../common';import{useLanguage}from'../../context/LanguageContext';import ReactMarkdown from'react-markdown';// System variables that shouldn't be treated as user inputs\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SYSTEM_VARIABLES=['brand_voice','amazon_requirements','image_style_guidelines','social_media_guidelines','platform_requirements','tone_guidelines'];// Extract user input variables from prompt template\nfunction extractInputsFromPrompt(promptTemplate){const variables=[];const matches=promptTemplate.match(/\\{\\{([^}]+)\\}\\}/g)||[];matches.forEach(match=>{const varName=match.replace(/\\{\\{|\\}\\}/g,'').trim();if(!varName.match(/^step_\\d+_output$/)&&!SYSTEM_VARIABLES.includes(varName)){if(!variables.includes(varName)){variables.push(varName);}}});return variables;}const INPUT_TYPE_OPTIONS=[{value:'text',labelKey:'inputTypeText',icon:'ðŸ“'},{value:'textarea',labelKey:'inputTypeTextarea',icon:'ðŸ“„'},{value:'image',labelKey:'inputTypeImage',icon:'ðŸ–¼ï¸'},{value:'url_list',labelKey:'inputTypeUrlList',icon:'ðŸ”—'},{value:'file',labelKey:'inputTypeFile',icon:'ðŸ“'}];const DEFAULT_INPUT_CONFIG={type:'text',placeholder:'',description:''};export function TemplateEditor(){var _models$find;const{id}=useParams();const navigate=useNavigate();const{t}=useLanguage();const isNew=!id||id==='new';const promptTextAreaRef=useRef(null);const[template,setTemplate]=useState({name:'',description:'',step_name:'',step_type:'ai',ai_model:'mock',prompt_template:'',output_format:'text',model_config:JSON.stringify({temperature:0.7,maxTokens:2000}),input_config:JSON.stringify({variables:{}}),api_config:'',executor_config:''});const[models,setModels]=useState([]);const[executors,setExecutors]=useState([]);const[isLoading,setIsLoading]=useState(!isNew);const[isSaving,setIsSaving]=useState(false);const[error,setError]=useState(null);const[showVariableHelp,setShowVariableHelp]=useState(false);const[expandedVariable,setExpandedVariable]=useState(null);const[showAddVariable,setShowAddVariable]=useState(false);const[newVariableName,setNewVariableName]=useState('');const[newVariableType,setNewVariableType]=useState('text');const[editingVariableName,setEditingVariableName]=useState(null);const[editedName,setEditedName]=useState('');// Test mode state\nconst[showTestPanel,setShowTestPanel]=useState(false);const[testInputValues,setTestInputValues]=useState({});const[testOutput,setTestOutput]=useState(null);const[testGeneratedImages,setTestGeneratedImages]=useState([]);const[isTestRunning,setIsTestRunning]=useState(false);const[testError,setTestError]=useState(null);useEffect(()=>{loadModels();loadExecutors();if(!isNew&&id){loadTemplate(parseInt(id));}},[id,isNew]);const loadModels=async()=>{try{const{all}=await api.getAIModels();setModels(all);}catch(err){console.error('Failed to load models:',err);}};const loadExecutors=async()=>{try{const data=await api.getExecutors();setExecutors(data);}catch(err){console.error('Failed to load executors:',err);}};const loadTemplate=async templateId=>{setIsLoading(true);try{var _data$steps;const data=await api.getRecipe(templateId);const step=(_data$steps=data.steps)===null||_data$steps===void 0?void 0:_data$steps[0];console.log('DEBUG TemplateEditor - Full API response:',data);console.log('DEBUG TemplateEditor - First step:',step);console.log('DEBUG TemplateEditor - step_type value:',step===null||step===void 0?void 0:step.step_type);setTemplate({name:data.name,description:data.description||'',step_name:(step===null||step===void 0?void 0:step.step_name)||data.name,step_type:(step===null||step===void 0?void 0:step.step_type)||'ai',ai_model:(step===null||step===void 0?void 0:step.ai_model)||'mock',prompt_template:(step===null||step===void 0?void 0:step.prompt_template)||'',output_format:(step===null||step===void 0?void 0:step.output_format)||'text',model_config:(step===null||step===void 0?void 0:step.model_config)||JSON.stringify({temperature:0.7,maxTokens:2000}),input_config:(step===null||step===void 0?void 0:step.input_config)||JSON.stringify({variables:{}}),api_config:(step===null||step===void 0?void 0:step.api_config)||'',executor_config:(step===null||step===void 0?void 0:step.executor_config)||''});}catch(err){setError(err.message);}finally{setIsLoading(false);}};// Get input config for a variable\nconst getInputConfig=varName=>{try{var _config$variables;const config=JSON.parse(template.input_config);return((_config$variables=config.variables)===null||_config$variables===void 0?void 0:_config$variables[varName])||_objectSpread({},DEFAULT_INPUT_CONFIG);}catch(_unused){return _objectSpread({},DEFAULT_INPUT_CONFIG);}};// Update input config for a variable\nconst updateInputConfig=(varName,updates)=>{try{const config=JSON.parse(template.input_config);if(!config.variables)config.variables={};config.variables[varName]=_objectSpread(_objectSpread({},getInputConfig(varName)),updates);setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config)}));}catch(_unused2){const config={variables:{[varName]:_objectSpread(_objectSpread({},DEFAULT_INPUT_CONFIG),updates)}};setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config)}));}};// Get all configured variables (including those not in prompt)\nconst getConfiguredVariables=()=>{try{const config=JSON.parse(template.input_config);return Object.keys(config.variables||{});}catch(_unused3){return[];}};// Add a new variable\nconst addVariable=()=>{if(!newVariableName.trim())return;const varName=newVariableName.trim().replace(/\\s+/g,'_').toLowerCase();// Check if variable already exists\nconst allVars=[...new Set([...promptVariables,...getConfiguredVariables()])];if(allVars.includes(varName)){setError(t('variableAlreadyExists'));return;}updateInputConfig(varName,{type:newVariableType});setNewVariableName('');setNewVariableType('text');setShowAddVariable(false);setExpandedVariable(varName);};// Delete a variable from config\nconst deleteVariable=varName=>{try{var _config$variables2;const config=JSON.parse(template.input_config);if((_config$variables2=config.variables)!==null&&_config$variables2!==void 0&&_config$variables2[varName]){delete config.variables[varName];setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config)}));}}catch(_unused4){// Ignore\n}if(expandedVariable===varName){setExpandedVariable(null);}};// Rename a variable\nconst renameVariable=(oldName,newName)=>{if(!newName.trim()||oldName===newName){setEditingVariableName(null);return;}const formattedName=newName.trim().replace(/\\s+/g,'_').toLowerCase();// Update config\ntry{var _config$variables3;const config=JSON.parse(template.input_config);if((_config$variables3=config.variables)!==null&&_config$variables3!==void 0&&_config$variables3[oldName]){config.variables[formattedName]=config.variables[oldName];delete config.variables[oldName];}// Update prompt template - replace old variable with new one\nconst updatedPrompt=template.prompt_template.replace(new RegExp(\"\\\\{\\\\{\\\\s*\".concat(oldName,\"\\\\s*\\\\}\\\\}\"),'g'),\"{{\".concat(formattedName,\"}}\"));setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config),prompt_template:updatedPrompt}));}catch(_unused5){// Ignore\n}setEditingVariableName(null);if(expandedVariable===oldName){setExpandedVariable(formattedName);}};// Insert variable into prompt at cursor position\nconst insertVariableIntoPrompt=varName=>{const textarea=promptTextAreaRef.current;if(!textarea)return;const start=textarea.selectionStart;const end=textarea.selectionEnd;const text=template.prompt_template;const variableText=\"{{\".concat(varName,\"}}\");const newText=text.substring(0,start)+variableText+text.substring(end);setTemplate(_objectSpread(_objectSpread({},template),{},{prompt_template:newText}));// Focus and set cursor position after the inserted variable\nsetTimeout(()=>{textarea.focus();const newCursorPos=start+variableText.length;textarea.setSelectionRange(newCursorPos,newCursorPos);},0);};// Initialize test input values when test panel opens\nconst openTestPanel=()=>{const initialValues={};allVariables.forEach(varName=>{const config=getInputConfig(varName);if(config.type==='url_list'){initialValues[varName]=[''];}else if(config.type==='image'||config.type==='file'){initialValues[varName]=null;}else{initialValues[varName]='';}});setTestInputValues(initialValues);setTestOutput(null);setTestGeneratedImages([]);setTestError(null);setShowTestPanel(true);};// Run test execution\nconst runTest=async()=>{// Validate required inputs\nconst missingInputs=allVariables.filter(varName=>{const value=testInputValues[varName];const config=getInputConfig(varName);if(config.type==='image'||config.type==='file'){return!value;}else if(config.type==='url_list'){return!Array.isArray(value)||value.filter(u=>u.trim()).length===0;}return!value||typeof value==='string'&&!value.trim();});if(missingInputs.length>0){setTestError(\"\".concat(t('fillRequiredFields'),\": \").concat(missingInputs.map(v=>getInputConfig(v).label||v).join(', ')));return;}// Only require prompt_template for AI templates\nif(template.step_type==='ai'&&!template.prompt_template.trim()){setTestError(t('promptTemplateRequired'));return;}// Non-AI templates can't be tested in the same way\nif(template.step_type!=='ai'){setTestError('Only AI templates can be tested directly. Please run the template in a workflow to test.');return;}setIsTestRunning(true);setTestError(null);setTestOutput(null);setTestGeneratedImages([]);try{// Compile prompt by replacing variables\nlet compiledPrompt=template.prompt_template;const images=[];for(const varName of allVariables){const value=testInputValues[varName];const config=getInputConfig(varName);let replacementValue='';if(config.type==='image'&&value!==null&&value!==void 0&&value.base64){// Extract image for vision models\nimages.push({base64:value.base64,mediaType:value.type||'image/jpeg'});replacementValue=\"[See attached image: \".concat(varName,\"]\");}else if(config.type==='file'&&value!==null&&value!==void 0&&value.content){replacementValue=value.content;}else if(config.type==='url_list'&&Array.isArray(value)){replacementValue=value.filter(u=>u.trim()).join('\\n');}else{replacementValue=String(value||'');}compiledPrompt=compiledPrompt.replace(new RegExp(\"\\\\{\\\\{\\\\s*\".concat(varName,\"\\\\s*\\\\}\\\\}\"),'g'),replacementValue);}// Get model config\nconst modelConfig=JSON.parse(template.model_config||'{}');const modelInfo=models.find(m=>m.id===template.ai_model);const provider=(modelInfo===null||modelInfo===void 0?void 0:modelInfo.provider)||'mock';// Call AI test endpoint\nconst response=await api.testAI(provider,template.ai_model,compiledPrompt,{temperature:modelConfig.temperature,maxTokens:modelConfig.maxTokens},images.length>0?images:undefined);if(response.success){setTestOutput(response.content);if(response.generatedImages&&response.generatedImages.length>0){setTestGeneratedImages(response.generatedImages);}}else{setTestError(response.error||t('testFailed'));}}catch(err){setTestError(err.message||t('testFailed'));}finally{setIsTestRunning(false);}};const handleSave=async()=>{if(!template.name){setError(t('templateNameRequired'));return;}// Only require prompt_template for AI templates\nif(template.step_type==='ai'&&!template.prompt_template){setError(t('promptTemplateRequired'));return;}setIsSaving(true);setError(null);try{const step={step_order:1,step_name:template.step_name||template.name,step_type:template.step_type,ai_model:template.ai_model,prompt_template:template.prompt_template,output_format:template.output_format,model_config:template.model_config,input_config:template.input_config};// Include api_config for scraping templates\nif(template.step_type==='scraping'&&template.api_config){step.api_config=template.api_config;}// Include executor_config for non-AI/scraping types\nif(template.executor_config){step.executor_config=template.executor_config;}if(isNew){await api.createRecipe({name:template.name,description:template.description,steps:[step],is_template:true});navigate('/');}else if(id){await api.updateRecipe(parseInt(id),{name:template.name,description:template.description,steps:[step],is_template:true});navigate('/');}}catch(err){setError(err.message);}finally{setIsSaving(false);}};const handleDelete=async()=>{if(!id||!window.confirm(t('confirmDeleteTemplate')))return;try{await api.deleteRecipe(parseInt(id));navigate('/');}catch(err){setError(err.message);}};// Variables extracted from prompt\nconst promptVariables=useMemo(()=>extractInputsFromPrompt(template.prompt_template),[template.prompt_template]);// All variables (from prompt + configured)\nconst allVariables=useMemo(()=>{const configured=getConfiguredVariables();return[...new Set([...promptVariables,...configured])];},[promptVariables,template.input_config]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6 max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-secondary-900\",children:isNew?t('createNewTemplate'):t('editTemplate')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-600 mt-1\",children:t('templateEditorSubtitle')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>navigate('/'),children:t('cancel')}),!isNew&&/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:handleDelete,className:\"text-red-600 hover:text-red-700\",children:t('delete')}),template.step_type==='ai'?/*#__PURE__*//* For AI templates, show Test Template button */_jsxs(Button,{variant:\"secondary\",onClick:openTestPanel,children:[/*#__PURE__*/_jsx(PlayIcon,{className:\"w-4 h-4 mr-2\"}),t('testTemplate')]}):(/* For non-AI templates, show Run Workflow button */!isNew&&/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",onClick:()=>navigate(\"/recipes/\".concat(id,\"/run\")),children:[/*#__PURE__*/_jsx(PlayIcon,{className:\"w-4 h-4 mr-2\"}),t('run')]})),/*#__PURE__*/_jsx(Button,{onClick:handleSave,isLoading:isSaving,children:isNew?t('createTemplate'):t('saveChanges')})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\",children:error}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('templateDetails')})}),/*#__PURE__*/_jsxs(CardBody,{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('templateName'),value:template.name,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{name:e.target.value})),placeholder:t('templateNamePlaceholder')}),/*#__PURE__*/_jsx(TextArea,{label:t('description'),value:template.description,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{description:e.target.value})),placeholder:t('templateDescriptionPlaceholder'),rows:2})]})]}),executors.length>0&&/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('stepType')})}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-3 sm:grid-cols-5 gap-3\",children:executors.map(exec=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setTemplate(_objectSpread(_objectSpread({},template),{},{step_type:exec.type})),className:\"flex flex-col items-center p-4 rounded-lg border-2 transition-colors \".concat(template.step_type===exec.type?'border-primary-500 bg-primary-50':'border-secondary-200 hover:border-secondary-300'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mb-1\",children:exec.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-secondary-900\",children:exec.displayName}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-secondary-500 mt-0.5 text-center\",children:exec.description.slice(0,50)})]},exec.type))})})]}),template.step_type==='scraping'?/*#__PURE__*//* Scraping Configuration */_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:\"\\uD83D\\uDD0D\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('scrapingConfiguration')})]})}),/*#__PURE__*/_jsxs(CardBody,{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 border border-blue-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-blue-700\",children:t('scrapingStepDescription')}),template.api_config&&(()=>{try{const apiConfig=JSON.parse(template.api_config);return/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-sm\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-blue-600 font-medium\",children:[t('service'),\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-blue-800\",children:apiConfig.service}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-4 text-blue-600 font-medium\",children:[t('endpoint'),\":\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-blue-800\",children:apiConfig.endpoint})]});}catch(_unused6){return null;}})()]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-secondary-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-secondary-700 mb-2\",children:t('supportedPlatforms')}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1.5 bg-orange-100 text-orange-800 text-sm rounded border border-orange-200\",children:\"\\uD83D\\uDCE6 Amazon\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-yellow-800 mb-2\",children:t('howItWorks')}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-yellow-700 space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",t('scrapingHowItWorks1')]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",t('scrapingHowItWorks2')]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 \",t('scrapingHowItWorks3')]})]})]}),/*#__PURE__*/_jsx(Select,{label:t('outputFormat'),value:template.output_format,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{output_format:e.target.value})),options:[{value:'json',label:t('json')},{value:'text',label:t('plainText')}]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-green-50 border border-green-200 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"text-sm font-medium text-green-800 mb-2\",children:t('usageTracking')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-700\",children:t('usageTrackingDescription')})]})]})]}):template.step_type==='ai'?/*#__PURE__*//* AI Configuration */_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('aiConfiguration')})}),/*#__PURE__*/_jsxs(CardBody,{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Select,{label:t('aiModel'),value:template.ai_model,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{ai_model:e.target.value})),options:models.map(m=>({value:m.id,label:\"\".concat(m.name).concat(m.available?'':\" (\".concat(t('notConfigured'),\")\"))}))}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700\",children:t('promptTemplate')}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowVariableHelp(true),className:\"text-sm text-primary-600 hover:text-primary-700\",children:t('variableHelp')})]}),/*#__PURE__*/_jsx(\"textarea\",{ref:promptTextAreaRef,value:template.prompt_template,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{prompt_template:e.target.value})),placeholder:t('promptTemplatePlaceholder'),rows:12,className:\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-secondary-500\",children:t('templatePromptHelp')})]}),/*#__PURE__*/_jsx(Select,{label:t('outputFormat'),value:template.output_format,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{output_format:e.target.value})),options:[{value:'text',label:t('plainText')},{value:'markdown',label:t('markdown')},{value:'json',label:t('json')},{value:'image',label:t('generatedImages')}]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-secondary-200 pt-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-secondary-700 mb-3\",children:t('modelSettings')}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('temperature'),type:\"number\",min:\"0\",max:\"2\",step:\"0.1\",value:JSON.parse(template.model_config||'{}').temperature||0.7,onChange:e=>{const config=JSON.parse(template.model_config||'{}');config.temperature=parseFloat(e.target.value);setTemplate(_objectSpread(_objectSpread({},template),{},{model_config:JSON.stringify(config)}));}}),/*#__PURE__*/_jsx(Input,{label:t('maxTokens'),type:\"number\",min:\"100\",max:\"100000\",step:\"100\",value:JSON.parse(template.model_config||'{}').maxTokens||2000,onChange:e=>{const config=JSON.parse(template.model_config||'{}');config.maxTokens=parseInt(e.target.value);setTemplate(_objectSpread(_objectSpread({},template),{},{model_config:JSON.stringify(config)}));}})]})]})]})]}):/*#__PURE__*//* Dynamic Executor Configuration (script, http, transform, etc.) */_jsx(ExecutorConfigForm,{stepType:template.step_type,executors:executors,executorConfig:template.executor_config,onConfigChange:config=>setTemplate(_objectSpread(_objectSpread({},template),{},{executor_config:config}))}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('inputVariables')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-secondary-500 mt-1\",children:t('inputVariablesDesc')})]}),/*#__PURE__*/_jsxs(Button,{size:\"sm\",onClick:()=>setShowAddVariable(true),children:[\"+ \",t('addVariable')]})]})}),/*#__PURE__*/_jsx(CardBody,{children:allVariables.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-secondary-500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-2\",children:\"\\uD83D\\uDCE5\"}),/*#__PURE__*/_jsx(\"p\",{children:t('noVariablesYet')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1\",children:t('addVariablesHint')})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:allVariables.map(varName=>{const config=getInputConfig(varName);const isExpanded=expandedVariable===varName;const typeOption=INPUT_TYPE_OPTIONS.find(o=>o.value===config.type);const isInPrompt=promptVariables.includes(varName);const isEditing=editingVariableName===varName;return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-secondary-200 rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-4 py-3 bg-secondary-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 flex-1 cursor-pointer\",onClick:()=>setExpandedVariable(isExpanded?null:varName),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:(typeOption===null||typeOption===void 0?void 0:typeOption.icon)||'ðŸ“'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editedName,onChange:e=>setEditedName(e.target.value),onBlur:()=>renameVariable(varName,editedName),onKeyDown:e=>{if(e.key==='Enter')renameVariable(varName,editedName);if(e.key==='Escape')setEditingVariableName(null);},onClick:e=>e.stopPropagation(),className:\"px-2 py-1 border border-primary-300 rounded text-sm font-mono focus:outline-none focus:ring-2 focus:ring-primary-500\",autoFocus:true}):/*#__PURE__*/_jsx(\"code\",{className:\"font-semibold text-secondary-900\",children:varName}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-secondary-500\",children:typeOption?t(typeOption.labelKey):t('inputTypeText')}),isInPrompt?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded\",children:t('inPrompt')}):/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded\",children:t('notInPrompt')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[!isInPrompt&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();insertVariableIntoPrompt(varName);},className:\"p-1.5 text-primary-600 hover:bg-primary-50 rounded\",title:t('insertIntoPrompt'),children:/*#__PURE__*/_jsx(InsertIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setEditedName(varName);setEditingVariableName(varName);},className:\"p-1.5 text-secondary-500 hover:bg-secondary-100 rounded\",title:t('rename'),children:/*#__PURE__*/_jsx(EditIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();if(isInPrompt){if(window.confirm(t('confirmDeleteVariableInPrompt'))){deleteVariable(varName);}}else{deleteVariable(varName);}},className:\"p-1.5 text-red-500 hover:bg-red-50 rounded\",title:t('delete'),children:/*#__PURE__*/_jsx(TrashIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpandedVariable(isExpanded?null:varName),className:\"p-1.5 text-secondary-400 hover:bg-secondary-100 rounded\",children:/*#__PURE__*/_jsx(ChevronIcon,{className:\"w-5 h-5 transition-transform \".concat(isExpanded?'rotate-180':'')})})]})]}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-4 space-y-4 border-t border-secondary-200\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700 mb-2\",children:t('inputType')}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:INPUT_TYPE_OPTIONS.map(option=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>updateInputConfig(varName,{type:option.value}),className:\"flex flex-col items-center p-3 rounded-lg border-2 transition-colors \".concat(config.type===option.value?'border-primary-500 bg-primary-50':'border-secondary-200 hover:border-secondary-300'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mb-1\",children:option.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-secondary-700\",children:t(option.labelKey)})]},option.value))})]}),/*#__PURE__*/_jsx(Input,{label:t('fieldLabel'),value:config.label||'',onChange:e=>updateInputConfig(varName,{label:e.target.value}),placeholder:varName}),/*#__PURE__*/_jsx(Input,{label:t('placeholderText'),value:config.placeholder||'',onChange:e=>updateInputConfig(varName,{placeholder:e.target.value}),placeholder:t('placeholderExample')}),/*#__PURE__*/_jsx(TextArea,{label:t('helpText'),value:config.description||'',onChange:e=>updateInputConfig(varName,{description:e.target.value}),placeholder:t('helpTextExample'),rows:2}),config.type==='file'&&/*#__PURE__*/_jsx(Input,{label:t('acceptedFileTypes'),value:(config.acceptedFileTypes||[]).join(', '),onChange:e=>updateInputConfig(varName,{acceptedFileTypes:e.target.value.split(',').map(s=>s.trim()).filter(Boolean)}),placeholder:\".csv, .xlsx, .json\"}),config.type==='url_list'&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('minUrls'),type:\"number\",min:\"1\",value:config.minUrls||1,onChange:e=>updateInputConfig(varName,{minUrls:parseInt(e.target.value)})}),/*#__PURE__*/_jsx(Input,{label:t('maxUrls'),type:\"number\",min:\"1\",value:config.maxUrls||10,onChange:e=>updateInputConfig(varName,{maxUrls:parseInt(e.target.value)})})]}),config.type==='image'&&/*#__PURE__*/_jsx(Input,{label:t('maxImageSizeMB'),type:\"number\",min:\"1\",max:\"50\",value:config.maxImageSize||10,onChange:e=>updateInputConfig(varName,{maxImageSize:parseInt(e.target.value)})})]})]},varName);})})})]}),/*#__PURE__*/_jsx(Modal,{isOpen:showAddVariable,onClose:()=>{setShowAddVariable(false);setNewVariableName('');setNewVariableType('text');},title:t('addNewVariable'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('variableName'),value:newVariableName,onChange:e=>setNewVariableName(e.target.value),placeholder:t('variableNamePlaceholder')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-secondary-500 -mt-2\",children:t('variableNameHint')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700 mb-2\",children:t('inputType')}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:INPUT_TYPE_OPTIONS.map(option=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setNewVariableType(option.value),className:\"flex flex-col items-center p-3 rounded-lg border-2 transition-colors \".concat(newVariableType===option.value?'border-primary-500 bg-primary-50':'border-secondary-200 hover:border-secondary-300'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mb-1\",children:option.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-secondary-700\",children:t(option.labelKey)})]},option.value))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 pt-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>setShowAddVariable(false),children:t('cancel')}),/*#__PURE__*/_jsx(Button,{onClick:addVariable,disabled:!newVariableName.trim(),children:t('addVariable')})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:showVariableHelp,onClose:()=>setShowVariableHelp(false),title:t('variableReference'),size:\"lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-secondary-900\",children:t('supportedInputTypes')}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 space-y-2\",children:INPUT_TYPE_OPTIONS.map(option=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:option.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:t(option.labelKey)}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary-500\",children:[\"- \",t(\"inputType_\".concat(option.value,\"_desc\"))]})]},option.value))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-secondary-900\",children:t('variableSyntax')}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-secondary-600 mt-1\",children:[/*#__PURE__*/_jsx(\"code\",{className:\"bg-secondary-100 px-1 rounded\",children:'{{variable_name}}'}),\" \",t('templateVariableDesc')]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\",children:['{{product_image}}',\" - \",t('forImageUpload'),/*#__PURE__*/_jsx(\"br\",{}),'{{product_urls}}',\" - \",t('forUrlList'),/*#__PURE__*/_jsx(\"br\",{}),'{{sales_data}}',\" - \",t('forFileUpload')]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-secondary-900\",children:t('companyStandards')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-secondary-600 mt-1\",children:t('companyStandardsDesc')}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\",children:['{{brand_voice}}',/*#__PURE__*/_jsx(\"br\",{}),'{{amazon_requirements}}',/*#__PURE__*/_jsx(\"br\",{}),'{{image_style_guidelines}}']})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:showTestPanel,onClose:()=>setShowTestPanel(false),title:t('testTemplate'),size:\"xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-secondary-900\",children:template.name||t('untitledTemplate')}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-secondary-500 mt-1\",children:[t('model'),\": \",((_models$find=models.find(m=>m.id===template.ai_model))===null||_models$find===void 0?void 0:_models$find.name)||template.ai_model]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded\",children:template.output_format})]})}),allVariables.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-secondary-900 mb-3\",children:t('inputValues')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:allVariables.map(varName=>{const config=getInputConfig(varName);const displayConfig=_objectSpread(_objectSpread({},config),{},{label:config.label||varName});return/*#__PURE__*/_jsx(DynamicInput,{name:varName,config:displayConfig,value:testInputValues[varName],onChange:value=>setTestInputValues(_objectSpread(_objectSpread({},testInputValues),{},{[varName]:value})),t:t},varName);})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-secondary-500\",children:/*#__PURE__*/_jsx(\"p\",{children:t('noInputVariables')})}),testError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\",children:testError}),(testOutput||testGeneratedImages.length>0)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-secondary-900 mb-3\",children:t('output')}),testGeneratedImages.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:testGeneratedImages.map((image,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-100 rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(image.mimeType,\";base64,\").concat(image.base64),alt:\"Generated image \".concat(index+1),className:\"w-full h-auto object-contain\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Open image in new tab for full size view\nconst win=window.open();if(win){win.document.write(\"\\n                                  <html>\\n                                    <head><title>Generated Image \".concat(index+1,\"</title></head>\\n                                    <body style=\\\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\\\">\\n                                      <img src=\\\"data:\").concat(image.mimeType,\";base64,\").concat(image.base64,\"\\\" style=\\\"max-width:100%;max-height:100vh;\\\" />\\n                                    </body>\\n                                  </html>\\n                                \"));}},className:\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm\",title:t('viewFullSize'),children:/*#__PURE__*/_jsx(ExpandIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Download image\nconst link=document.createElement('a');link.href=\"data:\".concat(image.mimeType,\";base64,\").concat(image.base64);link.download=\"generated-image-\".concat(index+1,\".\").concat(image.mimeType.split('/')[1]||'png');document.body.appendChild(link);link.click();document.body.removeChild(link);},className:\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm\",title:t('downloadImage'),children:/*#__PURE__*/_jsx(DownloadIcon,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-black/50 text-white text-xs rounded\",children:[t('image'),\" \",index+1]})})]},index))})}),testOutput&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-50 rounded-lg p-4 max-h-96 overflow-auto\",children:template.output_format==='markdown'?/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm max-w-none\",children:/*#__PURE__*/_jsx(ReactMarkdown,{children:testOutput})}):template.output_format==='json'?/*#__PURE__*/_jsx(\"pre\",{className:\"text-sm font-mono whitespace-pre-wrap\",children:(()=>{try{return JSON.stringify(JSON.parse(testOutput),null,2);}catch(_unused7){return testOutput;}})()}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm whitespace-pre-wrap\",children:testOutput})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pt-4 border-t border-secondary-200\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>setShowTestPanel(false),children:t('close')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[(testOutput||testGeneratedImages.length>0)&&/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setTestOutput(null);setTestGeneratedImages([]);setTestError(null);},children:t('clearOutput')}),/*#__PURE__*/_jsxs(Button,{onClick:runTest,isLoading:isTestRunning,children:[/*#__PURE__*/_jsx(PlayIcon,{className:\"w-4 h-4 mr-2\"}),t('runTest')]})]})]})]})})]});}/**\n * Dynamic config form for executor types (script, http, transform, etc.)\n * Renders form fields based on the executor's config schema.\n */function ExecutorConfigForm(_ref){let{stepType,executors,executorConfig,onConfigChange}=_ref;const executor=executors.find(e=>e.type===stepType);if(!executor)return null;let config={};try{config=executorConfig?JSON.parse(executorConfig):{};}catch(_unused8){config={};}const updateField=(name,value)=>{const updated=_objectSpread(_objectSpread({},config),{},{[name]:value});onConfigChange(JSON.stringify(updated));};return/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl\",children:executor.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"font-semibold text-secondary-900\",children:[executor.displayName,\" Configuration\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-secondary-500\",children:executor.description})]})]})}),/*#__PURE__*/_jsx(CardBody,{className:\"space-y-4\",children:executor.configSchema.fields.map(field=>{var _ref2,_config$field$name;const value=(_ref2=(_config$field$name=config[field.name])!==null&&_config$field$name!==void 0?_config$field$name:field.defaultValue)!==null&&_ref2!==void 0?_ref2:'';switch(field.type){case'select':return/*#__PURE__*/_jsx(Select,{label:field.label,value:value,onChange:e=>updateField(field.name,e.target.value),options:field.options||[]},field.name);case'textarea':return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(TextArea,{label:field.label,value:value,onChange:e=>updateField(field.name,e.target.value),rows:6,className:\"font-mono text-sm\"}),field.helpText&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-secondary-500\",children:field.helpText})]},field.name);case'code':return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"label\",{className:\"block text-sm font-medium text-secondary-700 mb-1\",children:[field.label,field.required&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-500 ml-1\",children:\"*\"})]}),/*#__PURE__*/_jsx(\"textarea\",{value:value,onChange:e=>updateField(field.name,e.target.value),rows:12,className:\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm bg-secondary-50\",placeholder:\"Enter \".concat(field.language||'code',\" here...\")}),field.helpText&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-secondary-500\",children:field.helpText})]},field.name);case'number':return/*#__PURE__*/_jsx(Input,{label:field.label,type:\"number\",value:value,onChange:e=>updateField(field.name,parseInt(e.target.value)||0)},field.name);case'json':return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700 mb-1\",children:field.label}),/*#__PURE__*/_jsx(\"textarea\",{value:typeof value==='string'?value:JSON.stringify(value,null,2),onChange:e=>{try{updateField(field.name,JSON.parse(e.target.value));}catch(_unused9){// Allow invalid JSON while typing\nconst updated=_objectSpread(_objectSpread({},config),{},{[field.name]:e.target.value});onConfigChange(JSON.stringify(updated));}},rows:4,className:\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm\",placeholder:\"{\\\"key\\\": \\\"value\\\"}\"}),field.helpText&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-secondary-500\",children:field.helpText})]},field.name);case'boolean':return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:!!value,onChange:e=>updateField(field.name,e.target.checked),className:\"rounded border-secondary-300 text-primary-600 focus:ring-primary-500\"}),/*#__PURE__*/_jsx(\"label\",{className:\"text-sm font-medium text-secondary-700\",children:field.label})]},field.name);default:// 'text'\nreturn/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Input,{label:field.label,value:value,onChange:e=>updateField(field.name,e.target.value),placeholder:field.helpText||''}),field.helpText&&/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-secondary-500\",children:field.helpText})]},field.name);}})})]});}function ChevronIcon(_ref3){let{className}=_ref3;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 9l-7 7-7-7\"})});}function InsertIcon(_ref4){let{className}=_ref4;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"})});}function EditIcon(_ref5){let{className}=_ref5;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"})});}function TrashIcon(_ref6){let{className}=_ref6;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"})});}function PlayIcon(_ref7){let{className}=_ref7;return/*#__PURE__*/_jsxs(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"}),/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"})]});}function ExpandIcon(_ref8){let{className}=_ref8;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"})});}function DownloadIcon(_ref9){let{className}=_ref9;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"})});}","map":{"version":3,"names":["React","useEffect","useState","useMemo","useRef","useParams","useNavigate","api","Button","Input","TextArea","Select","Card","CardBody","CardHeader","Modal","DynamicInput","useLanguage","ReactMarkdown","jsx","_jsx","jsxs","_jsxs","SYSTEM_VARIABLES","extractInputsFromPrompt","promptTemplate","variables","matches","match","forEach","varName","replace","trim","includes","push","INPUT_TYPE_OPTIONS","value","labelKey","icon","DEFAULT_INPUT_CONFIG","type","placeholder","description","TemplateEditor","_models$find","id","navigate","t","isNew","promptTextAreaRef","template","setTemplate","name","step_name","step_type","ai_model","prompt_template","output_format","model_config","JSON","stringify","temperature","maxTokens","input_config","api_config","executor_config","models","setModels","executors","setExecutors","isLoading","setIsLoading","isSaving","setIsSaving","error","setError","showVariableHelp","setShowVariableHelp","expandedVariable","setExpandedVariable","showAddVariable","setShowAddVariable","newVariableName","setNewVariableName","newVariableType","setNewVariableType","editingVariableName","setEditingVariableName","editedName","setEditedName","showTestPanel","setShowTestPanel","testInputValues","setTestInputValues","testOutput","setTestOutput","testGeneratedImages","setTestGeneratedImages","isTestRunning","setIsTestRunning","testError","setTestError","loadModels","loadExecutors","loadTemplate","parseInt","all","getAIModels","err","console","data","getExecutors","templateId","_data$steps","getRecipe","step","steps","log","message","getInputConfig","_config$variables","config","parse","_objectSpread","_unused","updateInputConfig","updates","_unused2","getConfiguredVariables","Object","keys","_unused3","addVariable","toLowerCase","allVars","Set","promptVariables","deleteVariable","_config$variables2","_unused4","renameVariable","oldName","newName","formattedName","_config$variables3","updatedPrompt","RegExp","concat","_unused5","insertVariableIntoPrompt","textarea","current","start","selectionStart","end","selectionEnd","text","variableText","newText","substring","setTimeout","focus","newCursorPos","length","setSelectionRange","openTestPanel","initialValues","allVariables","runTest","missingInputs","filter","Array","isArray","u","map","v","label","join","compiledPrompt","images","replacementValue","base64","mediaType","content","String","modelConfig","modelInfo","find","m","provider","response","testAI","undefined","success","generatedImages","handleSave","step_order","createRecipe","is_template","updateRecipe","handleDelete","window","confirm","deleteRecipe","configured","className","children","variant","onClick","PlayIcon","onChange","e","target","rows","exec","displayName","slice","apiConfig","service","endpoint","_unused6","options","available","ref","min","max","parseFloat","ExecutorConfigForm","stepType","executorConfig","onConfigChange","size","isExpanded","typeOption","o","isInPrompt","isEditing","onBlur","onKeyDown","key","stopPropagation","autoFocus","title","InsertIcon","EditIcon","TrashIcon","ChevronIcon","option","acceptedFileTypes","split","s","Boolean","minUrls","maxUrls","maxImageSize","isOpen","onClose","disabled","displayConfig","image","index","src","mimeType","alt","win","open","document","write","ExpandIcon","link","createElement","href","download","body","appendChild","click","removeChild","DownloadIcon","_unused7","_ref","executor","_unused8","updateField","updated","configSchema","fields","field","_ref2","_config$field$name","defaultValue","helpText","required","language","_unused9","checked","_ref3","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_ref4","_ref5","_ref6","_ref7","_ref8","_ref9"],"sources":["/Users/eveyhuang/Documents/novohaven-app/client/src/components/TemplateEditor/TemplateEditor.tsx"],"sourcesContent":["import React, { useEffect, useState, useMemo, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Recipe, RecipeStep, AIModel, InputType, InputTypeConfig, TemplateInputConfig, GeneratedImage, StepType } from '../../types';\nimport api, { ExecutorInfo } from '../../services/api';\nimport { Button, Input, TextArea, Select, Card, CardBody, CardHeader, Modal, DynamicInput } from '../common';\nimport { useLanguage } from '../../context/LanguageContext';\nimport { TranslationKey } from '../../i18n/translations';\nimport ReactMarkdown from 'react-markdown';\n\n// System variables that shouldn't be treated as user inputs\nconst SYSTEM_VARIABLES = [\n  'brand_voice', 'amazon_requirements', 'image_style_guidelines',\n  'social_media_guidelines', 'platform_requirements', 'tone_guidelines'\n];\n\n// Extract user input variables from prompt template\nfunction extractInputsFromPrompt(promptTemplate: string): string[] {\n  const variables: string[] = [];\n  const matches = promptTemplate.match(/\\{\\{([^}]+)\\}\\}/g) || [];\n  matches.forEach((match) => {\n    const varName = match.replace(/\\{\\{|\\}\\}/g, '').trim();\n    if (!varName.match(/^step_\\d+_output$/) && !SYSTEM_VARIABLES.includes(varName)) {\n      if (!variables.includes(varName)) {\n        variables.push(varName);\n      }\n    }\n  });\n  return variables;\n}\n\nconst INPUT_TYPE_OPTIONS: { value: InputType; labelKey: TranslationKey; icon: string }[] = [\n  { value: 'text', labelKey: 'inputTypeText', icon: 'ðŸ“' },\n  { value: 'textarea', labelKey: 'inputTypeTextarea', icon: 'ðŸ“„' },\n  { value: 'image', labelKey: 'inputTypeImage', icon: 'ðŸ–¼ï¸' },\n  { value: 'url_list', labelKey: 'inputTypeUrlList', icon: 'ðŸ”—' },\n  { value: 'file', labelKey: 'inputTypeFile', icon: 'ðŸ“' },\n];\n\nconst DEFAULT_INPUT_CONFIG: InputTypeConfig = {\n  type: 'text',\n  placeholder: '',\n  description: '',\n};\n\nexport function TemplateEditor() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { t } = useLanguage();\n  const isNew = !id || id === 'new';\n  const promptTextAreaRef = useRef<HTMLTextAreaElement>(null);\n\n  const [template, setTemplate] = useState<{\n    name: string;\n    description: string;\n    step_name: string;\n    step_type: StepType;\n    ai_model: string;\n    prompt_template: string;\n    output_format: 'text' | 'json' | 'markdown' | 'image';\n    model_config: string;\n    input_config: string;\n    api_config: string;\n    executor_config: string;\n  }>({\n    name: '',\n    description: '',\n    step_name: '',\n    step_type: 'ai',\n    ai_model: 'mock',\n    prompt_template: '',\n    output_format: 'text',\n    model_config: JSON.stringify({ temperature: 0.7, maxTokens: 2000 }),\n    input_config: JSON.stringify({ variables: {} }),\n    api_config: '',\n    executor_config: '',\n  });\n\n  const [models, setModels] = useState<AIModel[]>([]);\n  const [executors, setExecutors] = useState<ExecutorInfo[]>([]);\n  const [isLoading, setIsLoading] = useState(!isNew);\n  const [isSaving, setIsSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [showVariableHelp, setShowVariableHelp] = useState(false);\n  const [expandedVariable, setExpandedVariable] = useState<string | null>(null);\n  const [showAddVariable, setShowAddVariable] = useState(false);\n  const [newVariableName, setNewVariableName] = useState('');\n  const [newVariableType, setNewVariableType] = useState<InputType>('text');\n  const [editingVariableName, setEditingVariableName] = useState<string | null>(null);\n  const [editedName, setEditedName] = useState('');\n\n  // Test mode state\n  const [showTestPanel, setShowTestPanel] = useState(false);\n  const [testInputValues, setTestInputValues] = useState<Record<string, any>>({});\n  const [testOutput, setTestOutput] = useState<string | null>(null);\n  const [testGeneratedImages, setTestGeneratedImages] = useState<GeneratedImage[]>([]);\n  const [isTestRunning, setIsTestRunning] = useState(false);\n  const [testError, setTestError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadModels();\n    loadExecutors();\n    if (!isNew && id) {\n      loadTemplate(parseInt(id));\n    }\n  }, [id, isNew]);\n\n  const loadModels = async () => {\n    try {\n      const { all } = await api.getAIModels();\n      setModels(all);\n    } catch (err: any) {\n      console.error('Failed to load models:', err);\n    }\n  };\n\n  const loadExecutors = async () => {\n    try {\n      const data = await api.getExecutors();\n      setExecutors(data);\n    } catch (err: any) {\n      console.error('Failed to load executors:', err);\n    }\n  };\n\n  const loadTemplate = async (templateId: number) => {\n    setIsLoading(true);\n    try {\n      const data = await api.getRecipe(templateId);\n      const step = data.steps?.[0];\n      console.log('DEBUG TemplateEditor - Full API response:', data);\n      console.log('DEBUG TemplateEditor - First step:', step);\n      console.log('DEBUG TemplateEditor - step_type value:', step?.step_type);\n      setTemplate({\n        name: data.name,\n        description: data.description || '',\n        step_name: step?.step_name || data.name,\n        step_type: (step?.step_type as StepType) || 'ai',\n        ai_model: step?.ai_model || 'mock',\n        prompt_template: step?.prompt_template || '',\n        output_format: step?.output_format || 'text',\n        model_config: step?.model_config || JSON.stringify({ temperature: 0.7, maxTokens: 2000 }),\n        input_config: step?.input_config || JSON.stringify({ variables: {} }),\n        api_config: step?.api_config || '',\n        executor_config: step?.executor_config || '',\n      });\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Get input config for a variable\n  const getInputConfig = (varName: string): InputTypeConfig => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      return config.variables?.[varName] || { ...DEFAULT_INPUT_CONFIG };\n    } catch {\n      return { ...DEFAULT_INPUT_CONFIG };\n    }\n  };\n\n  // Update input config for a variable\n  const updateInputConfig = (varName: string, updates: Partial<InputTypeConfig>) => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      if (!config.variables) config.variables = {};\n      config.variables[varName] = { ...getInputConfig(varName), ...updates };\n      setTemplate({ ...template, input_config: JSON.stringify(config) });\n    } catch {\n      const config: TemplateInputConfig = { variables: { [varName]: { ...DEFAULT_INPUT_CONFIG, ...updates } } };\n      setTemplate({ ...template, input_config: JSON.stringify(config) });\n    }\n  };\n\n  // Get all configured variables (including those not in prompt)\n  const getConfiguredVariables = (): string[] => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      return Object.keys(config.variables || {});\n    } catch {\n      return [];\n    }\n  };\n\n  // Add a new variable\n  const addVariable = () => {\n    if (!newVariableName.trim()) return;\n    const varName = newVariableName.trim().replace(/\\s+/g, '_').toLowerCase();\n\n    // Check if variable already exists\n    const allVars = [...new Set([...promptVariables, ...getConfiguredVariables()])];\n    if (allVars.includes(varName)) {\n      setError(t('variableAlreadyExists'));\n      return;\n    }\n\n    updateInputConfig(varName, { type: newVariableType });\n    setNewVariableName('');\n    setNewVariableType('text');\n    setShowAddVariable(false);\n    setExpandedVariable(varName);\n  };\n\n  // Delete a variable from config\n  const deleteVariable = (varName: string) => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      if (config.variables?.[varName]) {\n        delete config.variables[varName];\n        setTemplate({ ...template, input_config: JSON.stringify(config) });\n      }\n    } catch {\n      // Ignore\n    }\n    if (expandedVariable === varName) {\n      setExpandedVariable(null);\n    }\n  };\n\n  // Rename a variable\n  const renameVariable = (oldName: string, newName: string) => {\n    if (!newName.trim() || oldName === newName) {\n      setEditingVariableName(null);\n      return;\n    }\n\n    const formattedName = newName.trim().replace(/\\s+/g, '_').toLowerCase();\n\n    // Update config\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      if (config.variables?.[oldName]) {\n        config.variables[formattedName] = config.variables[oldName];\n        delete config.variables[oldName];\n      }\n\n      // Update prompt template - replace old variable with new one\n      const updatedPrompt = template.prompt_template.replace(\n        new RegExp(`\\\\{\\\\{\\\\s*${oldName}\\\\s*\\\\}\\\\}`, 'g'),\n        `{{${formattedName}}}`\n      );\n\n      setTemplate({\n        ...template,\n        input_config: JSON.stringify(config),\n        prompt_template: updatedPrompt\n      });\n    } catch {\n      // Ignore\n    }\n\n    setEditingVariableName(null);\n    if (expandedVariable === oldName) {\n      setExpandedVariable(formattedName);\n    }\n  };\n\n  // Insert variable into prompt at cursor position\n  const insertVariableIntoPrompt = (varName: string) => {\n    const textarea = promptTextAreaRef.current;\n    if (!textarea) return;\n\n    const start = textarea.selectionStart;\n    const end = textarea.selectionEnd;\n    const text = template.prompt_template;\n    const variableText = `{{${varName}}}`;\n\n    const newText = text.substring(0, start) + variableText + text.substring(end);\n    setTemplate({ ...template, prompt_template: newText });\n\n    // Focus and set cursor position after the inserted variable\n    setTimeout(() => {\n      textarea.focus();\n      const newCursorPos = start + variableText.length;\n      textarea.setSelectionRange(newCursorPos, newCursorPos);\n    }, 0);\n  };\n\n  // Initialize test input values when test panel opens\n  const openTestPanel = () => {\n    const initialValues: Record<string, any> = {};\n    allVariables.forEach((varName) => {\n      const config = getInputConfig(varName);\n      if (config.type === 'url_list') {\n        initialValues[varName] = [''];\n      } else if (config.type === 'image' || config.type === 'file') {\n        initialValues[varName] = null;\n      } else {\n        initialValues[varName] = '';\n      }\n    });\n    setTestInputValues(initialValues);\n    setTestOutput(null);\n    setTestGeneratedImages([]);\n    setTestError(null);\n    setShowTestPanel(true);\n  };\n\n  // Run test execution\n  const runTest = async () => {\n    // Validate required inputs\n    const missingInputs = allVariables.filter((varName) => {\n      const value = testInputValues[varName];\n      const config = getInputConfig(varName);\n      if (config.type === 'image' || config.type === 'file') {\n        return !value;\n      } else if (config.type === 'url_list') {\n        return !Array.isArray(value) || value.filter((u: string) => u.trim()).length === 0;\n      }\n      return !value || (typeof value === 'string' && !value.trim());\n    });\n\n    if (missingInputs.length > 0) {\n      setTestError(`${t('fillRequiredFields')}: ${missingInputs.map(v => getInputConfig(v).label || v).join(', ')}`);\n      return;\n    }\n\n    // Only require prompt_template for AI templates\n    if (template.step_type === 'ai' && !template.prompt_template.trim()) {\n      setTestError(t('promptTemplateRequired'));\n      return;\n    }\n\n    // Non-AI templates can't be tested in the same way\n    if (template.step_type !== 'ai') {\n      setTestError('Only AI templates can be tested directly. Please run the template in a workflow to test.');\n      return;\n    }\n\n    setIsTestRunning(true);\n    setTestError(null);\n    setTestOutput(null);\n    setTestGeneratedImages([]);\n\n    try {\n      // Compile prompt by replacing variables\n      let compiledPrompt = template.prompt_template;\n      const images: Array<{ base64: string; mediaType: string }> = [];\n\n      for (const varName of allVariables) {\n        const value = testInputValues[varName];\n        const config = getInputConfig(varName);\n        let replacementValue = '';\n\n        if (config.type === 'image' && value?.base64) {\n          // Extract image for vision models\n          images.push({\n            base64: value.base64,\n            mediaType: value.type || 'image/jpeg',\n          });\n          replacementValue = `[See attached image: ${varName}]`;\n        } else if (config.type === 'file' && value?.content) {\n          replacementValue = value.content;\n        } else if (config.type === 'url_list' && Array.isArray(value)) {\n          replacementValue = value.filter((u: string) => u.trim()).join('\\n');\n        } else {\n          replacementValue = String(value || '');\n        }\n\n        compiledPrompt = compiledPrompt.replace(\n          new RegExp(`\\\\{\\\\{\\\\s*${varName}\\\\s*\\\\}\\\\}`, 'g'),\n          replacementValue\n        );\n      }\n\n      // Get model config\n      const modelConfig = JSON.parse(template.model_config || '{}');\n      const modelInfo = models.find(m => m.id === template.ai_model);\n      const provider = modelInfo?.provider || 'mock';\n\n      // Call AI test endpoint\n      const response = await api.testAI(\n        provider,\n        template.ai_model,\n        compiledPrompt,\n        {\n          temperature: modelConfig.temperature,\n          maxTokens: modelConfig.maxTokens,\n        },\n        images.length > 0 ? images : undefined\n      );\n\n      if (response.success) {\n        setTestOutput(response.content);\n        if (response.generatedImages && response.generatedImages.length > 0) {\n          setTestGeneratedImages(response.generatedImages);\n        }\n      } else {\n        setTestError(response.error || t('testFailed'));\n      }\n    } catch (err: any) {\n      setTestError(err.message || t('testFailed'));\n    } finally {\n      setIsTestRunning(false);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!template.name) {\n      setError(t('templateNameRequired'));\n      return;\n    }\n    // Only require prompt_template for AI templates\n    if (template.step_type === 'ai' && !template.prompt_template) {\n      setError(t('promptTemplateRequired'));\n      return;\n    }\n\n    setIsSaving(true);\n    setError(null);\n    try {\n      const step: any = {\n        step_order: 1,\n        step_name: template.step_name || template.name,\n        step_type: template.step_type,\n        ai_model: template.ai_model,\n        prompt_template: template.prompt_template,\n        output_format: template.output_format,\n        model_config: template.model_config,\n        input_config: template.input_config,\n      };\n\n      // Include api_config for scraping templates\n      if (template.step_type === 'scraping' && template.api_config) {\n        step.api_config = template.api_config;\n      }\n\n      // Include executor_config for non-AI/scraping types\n      if (template.executor_config) {\n        step.executor_config = template.executor_config;\n      }\n\n      if (isNew) {\n        await api.createRecipe({\n          name: template.name,\n          description: template.description,\n          steps: [step],\n          is_template: true,\n        });\n        navigate('/');\n      } else if (id) {\n        await api.updateRecipe(parseInt(id), {\n          name: template.name,\n          description: template.description,\n          steps: [step],\n          is_template: true,\n        });\n        navigate('/');\n      }\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!id || !window.confirm(t('confirmDeleteTemplate'))) return;\n    try {\n      await api.deleteRecipe(parseInt(id));\n      navigate('/');\n    } catch (err: any) {\n      setError(err.message);\n    }\n  };\n\n  // Variables extracted from prompt\n  const promptVariables = useMemo(() => extractInputsFromPrompt(template.prompt_template), [template.prompt_template]);\n\n  // All variables (from prompt + configured)\n  const allVariables = useMemo(() => {\n    const configured = getConfiguredVariables();\n    return [...new Set([...promptVariables, ...configured])];\n  }, [promptVariables, template.input_config]);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 max-w-4xl mx-auto\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-secondary-900\">\n            {isNew ? t('createNewTemplate') : t('editTemplate')}\n          </h1>\n          <p className=\"text-secondary-600 mt-1\">\n            {t('templateEditorSubtitle')}\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-3\">\n          <Button variant=\"ghost\" onClick={() => navigate('/')}>\n            {t('cancel')}\n          </Button>\n          {!isNew && (\n            <Button variant=\"ghost\" onClick={handleDelete} className=\"text-red-600 hover:text-red-700\">\n              {t('delete')}\n            </Button>\n          )}\n          {template.step_type === 'ai' ? (\n            /* For AI templates, show Test Template button */\n            <Button variant=\"secondary\" onClick={openTestPanel}>\n              <PlayIcon className=\"w-4 h-4 mr-2\" />\n              {t('testTemplate')}\n            </Button>\n          ) : (\n            /* For non-AI templates, show Run Workflow button */\n            !isNew && (\n              <Button variant=\"secondary\" onClick={() => navigate(`/recipes/${id}/run`)}>\n                <PlayIcon className=\"w-4 h-4 mr-2\" />\n                {t('run')}\n              </Button>\n            )\n          )}\n          <Button onClick={handleSave} isLoading={isSaving}>\n            {isNew ? t('createTemplate') : t('saveChanges')}\n          </Button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\">\n          {error}\n        </div>\n      )}\n\n      {/* Template Info */}\n      <Card>\n        <CardHeader>\n          <h2 className=\"font-semibold text-secondary-900\">{t('templateDetails')}</h2>\n        </CardHeader>\n        <CardBody className=\"space-y-4\">\n          <Input\n            label={t('templateName')}\n            value={template.name}\n            onChange={(e) => setTemplate({ ...template, name: e.target.value })}\n            placeholder={t('templateNamePlaceholder')}\n          />\n          <TextArea\n            label={t('description')}\n            value={template.description}\n            onChange={(e) => setTemplate({ ...template, description: e.target.value })}\n            placeholder={t('templateDescriptionPlaceholder')}\n            rows={2}\n          />\n        </CardBody>\n      </Card>\n\n      {/* Step Type Selector */}\n      {executors.length > 0 && (\n        <Card>\n          <CardHeader>\n            <h2 className=\"font-semibold text-secondary-900\">{t('stepType')}</h2>\n          </CardHeader>\n          <CardBody>\n            <div className=\"grid grid-cols-3 sm:grid-cols-5 gap-3\">\n              {executors.map((exec) => (\n                <button\n                  key={exec.type}\n                  onClick={() => setTemplate({ ...template, step_type: exec.type as StepType })}\n                  className={`flex flex-col items-center p-4 rounded-lg border-2 transition-colors ${\n                    template.step_type === exec.type\n                      ? 'border-primary-500 bg-primary-50'\n                      : 'border-secondary-200 hover:border-secondary-300'\n                  }`}\n                >\n                  <span className=\"text-2xl mb-1\">{exec.icon}</span>\n                  <span className=\"text-sm font-medium text-secondary-900\">{exec.displayName}</span>\n                  <span className=\"text-xs text-secondary-500 mt-0.5 text-center\">{exec.description.slice(0, 50)}</span>\n                </button>\n              ))}\n            </div>\n          </CardBody>\n        </Card>\n      )}\n\n      {/* Configuration - Dynamic based on step type */}\n      {template.step_type === 'scraping' ? (\n        /* Scraping Configuration */\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center space-x-2\">\n              <span className=\"text-2xl\">ðŸ”</span>\n              <h2 className=\"font-semibold text-secondary-900\">{t('scrapingConfiguration')}</h2>\n            </div>\n          </CardHeader>\n          <CardBody className=\"space-y-4\">\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n              <p className=\"text-sm text-blue-700\">\n                {t('scrapingStepDescription')}\n              </p>\n              {template.api_config && (() => {\n                try {\n                  const apiConfig = JSON.parse(template.api_config);\n                  return (\n                    <div className=\"mt-3 text-sm\">\n                      <span className=\"text-blue-600 font-medium\">{t('service')}:</span>\n                      <span className=\"ml-2 text-blue-800\">{apiConfig.service}</span>\n                      <span className=\"ml-4 text-blue-600 font-medium\">{t('endpoint')}:</span>\n                      <span className=\"ml-2 text-blue-800\">{apiConfig.endpoint}</span>\n                    </div>\n                  );\n                } catch {\n                  return null;\n                }\n              })()}\n            </div>\n\n            <div className=\"bg-secondary-50 rounded-lg p-4\">\n              <h5 className=\"text-sm font-medium text-secondary-700 mb-2\">{t('supportedPlatforms')}</h5>\n              <div className=\"flex space-x-2\">\n                <span className=\"px-3 py-1.5 bg-orange-100 text-orange-800 text-sm rounded border border-orange-200\">\n                  ðŸ“¦ Amazon\n                </span>\n              </div>\n            </div>\n\n            <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n              <h5 className=\"text-sm font-medium text-yellow-800 mb-2\">{t('howItWorks')}</h5>\n              <ul className=\"text-sm text-yellow-700 space-y-1\">\n                <li>â€¢ {t('scrapingHowItWorks1')}</li>\n                <li>â€¢ {t('scrapingHowItWorks2')}</li>\n                <li>â€¢ {t('scrapingHowItWorks3')}</li>\n              </ul>\n            </div>\n\n            <Select\n              label={t('outputFormat')}\n              value={template.output_format}\n              onChange={(e) => setTemplate({ ...template, output_format: e.target.value as any })}\n              options={[\n                { value: 'json', label: t('json') },\n                { value: 'text', label: t('plainText') },\n              ]}\n            />\n\n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n              <h5 className=\"text-sm font-medium text-green-800 mb-2\">{t('usageTracking')}</h5>\n              <p className=\"text-sm text-green-700\">\n                {t('usageTrackingDescription')}\n              </p>\n            </div>\n          </CardBody>\n        </Card>\n      ) : template.step_type === 'ai' ? (\n        /* AI Configuration */\n        <Card>\n          <CardHeader>\n            <h2 className=\"font-semibold text-secondary-900\">{t('aiConfiguration')}</h2>\n          </CardHeader>\n          <CardBody className=\"space-y-4\">\n            <Select\n              label={t('aiModel')}\n              value={template.ai_model}\n              onChange={(e) => setTemplate({ ...template, ai_model: e.target.value })}\n              options={models.map(m => ({\n                value: m.id,\n                label: `${m.name}${m.available ? '' : ` (${t('notConfigured')})`}`,\n              }))}\n            />\n\n            <div>\n              <div className=\"flex items-center justify-between mb-1\">\n                <label className=\"block text-sm font-medium text-secondary-700\">\n                  {t('promptTemplate')}\n                </label>\n                <button\n                  onClick={() => setShowVariableHelp(true)}\n                  className=\"text-sm text-primary-600 hover:text-primary-700\"\n                >\n                  {t('variableHelp')}\n                </button>\n              </div>\n              <textarea\n                ref={promptTextAreaRef}\n                value={template.prompt_template}\n                onChange={(e) => setTemplate({ ...template, prompt_template: e.target.value })}\n                placeholder={t('promptTemplatePlaceholder')}\n                rows={12}\n                className=\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm\"\n              />\n              <p className=\"mt-1 text-sm text-secondary-500\">\n                {t('templatePromptHelp')}\n              </p>\n            </div>\n\n            <Select\n              label={t('outputFormat')}\n              value={template.output_format}\n              onChange={(e) => setTemplate({ ...template, output_format: e.target.value as any })}\n              options={[\n                { value: 'text', label: t('plainText') },\n                { value: 'markdown', label: t('markdown') },\n                { value: 'json', label: t('json') },\n                { value: 'image', label: t('generatedImages') },\n              ]}\n            />\n\n            {/* Model Settings */}\n            <div className=\"border-t border-secondary-200 pt-4\">\n              <h3 className=\"text-sm font-medium text-secondary-700 mb-3\">{t('modelSettings')}</h3>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <Input\n                  label={t('temperature')}\n                  type=\"number\"\n                  min=\"0\"\n                  max=\"2\"\n                  step=\"0.1\"\n                  value={JSON.parse(template.model_config || '{}').temperature || 0.7}\n                  onChange={(e) => {\n                    const config = JSON.parse(template.model_config || '{}');\n                    config.temperature = parseFloat(e.target.value);\n                    setTemplate({ ...template, model_config: JSON.stringify(config) });\n                  }}\n                />\n                <Input\n                  label={t('maxTokens')}\n                  type=\"number\"\n                  min=\"100\"\n                  max=\"100000\"\n                  step=\"100\"\n                  value={JSON.parse(template.model_config || '{}').maxTokens || 2000}\n                  onChange={(e) => {\n                    const config = JSON.parse(template.model_config || '{}');\n                    config.maxTokens = parseInt(e.target.value);\n                    setTemplate({ ...template, model_config: JSON.stringify(config) });\n                  }}\n                />\n              </div>\n            </div>\n          </CardBody>\n        </Card>\n      ) : (\n        /* Dynamic Executor Configuration (script, http, transform, etc.) */\n        <ExecutorConfigForm\n          stepType={template.step_type}\n          executors={executors}\n          executorConfig={template.executor_config}\n          onConfigChange={(config) => setTemplate({ ...template, executor_config: config })}\n        />\n      )}\n\n      {/* Input Variables */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"font-semibold text-secondary-900\">{t('inputVariables')}</h2>\n              <p className=\"text-sm text-secondary-500 mt-1\">{t('inputVariablesDesc')}</p>\n            </div>\n            <Button size=\"sm\" onClick={() => setShowAddVariable(true)}>\n              + {t('addVariable')}\n            </Button>\n          </div>\n        </CardHeader>\n        <CardBody>\n          {allVariables.length === 0 ? (\n            <div className=\"text-center py-8 text-secondary-500\">\n              <div className=\"text-4xl mb-2\">ðŸ“¥</div>\n              <p>{t('noVariablesYet')}</p>\n              <p className=\"text-sm mt-1\">{t('addVariablesHint')}</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {allVariables.map((varName) => {\n                const config = getInputConfig(varName);\n                const isExpanded = expandedVariable === varName;\n                const typeOption = INPUT_TYPE_OPTIONS.find(o => o.value === config.type);\n                const isInPrompt = promptVariables.includes(varName);\n                const isEditing = editingVariableName === varName;\n\n                return (\n                  <div\n                    key={varName}\n                    className=\"border border-secondary-200 rounded-lg overflow-hidden\"\n                  >\n                    <div\n                      className=\"flex items-center justify-between px-4 py-3 bg-secondary-50\"\n                    >\n                      <div\n                        className=\"flex items-center gap-3 flex-1 cursor-pointer\"\n                        onClick={() => setExpandedVariable(isExpanded ? null : varName)}\n                      >\n                        <span className=\"text-lg\">{typeOption?.icon || 'ðŸ“'}</span>\n                        <div className=\"flex items-center gap-2\">\n                          {isEditing ? (\n                            <input\n                              type=\"text\"\n                              value={editedName}\n                              onChange={(e) => setEditedName(e.target.value)}\n                              onBlur={() => renameVariable(varName, editedName)}\n                              onKeyDown={(e) => {\n                                if (e.key === 'Enter') renameVariable(varName, editedName);\n                                if (e.key === 'Escape') setEditingVariableName(null);\n                              }}\n                              onClick={(e) => e.stopPropagation()}\n                              className=\"px-2 py-1 border border-primary-300 rounded text-sm font-mono focus:outline-none focus:ring-2 focus:ring-primary-500\"\n                              autoFocus\n                            />\n                          ) : (\n                            <code className=\"font-semibold text-secondary-900\">{varName}</code>\n                          )}\n                          <span className=\"text-sm text-secondary-500\">\n                            {typeOption ? t(typeOption.labelKey) : t('inputTypeText')}\n                          </span>\n                          {isInPrompt ? (\n                            <span className=\"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded\">\n                              {t('inPrompt')}\n                            </span>\n                          ) : (\n                            <span className=\"px-2 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded\">\n                              {t('notInPrompt')}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        {!isInPrompt && (\n                          <button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              insertVariableIntoPrompt(varName);\n                            }}\n                            className=\"p-1.5 text-primary-600 hover:bg-primary-50 rounded\"\n                            title={t('insertIntoPrompt')}\n                          >\n                            <InsertIcon className=\"w-4 h-4\" />\n                          </button>\n                        )}\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setEditedName(varName);\n                            setEditingVariableName(varName);\n                          }}\n                          className=\"p-1.5 text-secondary-500 hover:bg-secondary-100 rounded\"\n                          title={t('rename')}\n                        >\n                          <EditIcon className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            if (isInPrompt) {\n                              if (window.confirm(t('confirmDeleteVariableInPrompt'))) {\n                                deleteVariable(varName);\n                              }\n                            } else {\n                              deleteVariable(varName);\n                            }\n                          }}\n                          className=\"p-1.5 text-red-500 hover:bg-red-50 rounded\"\n                          title={t('delete')}\n                        >\n                          <TrashIcon className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={() => setExpandedVariable(isExpanded ? null : varName)}\n                          className=\"p-1.5 text-secondary-400 hover:bg-secondary-100 rounded\"\n                        >\n                          <ChevronIcon className={`w-5 h-5 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />\n                        </button>\n                      </div>\n                    </div>\n\n                    {isExpanded && (\n                      <div className=\"px-4 py-4 space-y-4 border-t border-secondary-200\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-secondary-700 mb-2\">\n                            {t('inputType')}\n                          </label>\n                          <div className=\"grid grid-cols-5 gap-2\">\n                            {INPUT_TYPE_OPTIONS.map((option) => (\n                              <button\n                                key={option.value}\n                                onClick={() => updateInputConfig(varName, { type: option.value })}\n                                className={`flex flex-col items-center p-3 rounded-lg border-2 transition-colors ${\n                                  config.type === option.value\n                                    ? 'border-primary-500 bg-primary-50'\n                                    : 'border-secondary-200 hover:border-secondary-300'\n                                }`}\n                              >\n                                <span className=\"text-2xl mb-1\">{option.icon}</span>\n                                <span className=\"text-xs text-secondary-700\">{t(option.labelKey)}</span>\n                              </button>\n                            ))}\n                          </div>\n                        </div>\n\n                        <Input\n                          label={t('fieldLabel')}\n                          value={config.label || ''}\n                          onChange={(e) => updateInputConfig(varName, { label: e.target.value })}\n                          placeholder={varName}\n                        />\n\n                        <Input\n                          label={t('placeholderText')}\n                          value={config.placeholder || ''}\n                          onChange={(e) => updateInputConfig(varName, { placeholder: e.target.value })}\n                          placeholder={t('placeholderExample')}\n                        />\n\n                        <TextArea\n                          label={t('helpText')}\n                          value={config.description || ''}\n                          onChange={(e) => updateInputConfig(varName, { description: e.target.value })}\n                          placeholder={t('helpTextExample')}\n                          rows={2}\n                        />\n\n                        {/* Type-specific options */}\n                        {config.type === 'file' && (\n                          <Input\n                            label={t('acceptedFileTypes')}\n                            value={(config.acceptedFileTypes || []).join(', ')}\n                            onChange={(e) => updateInputConfig(varName, {\n                              acceptedFileTypes: e.target.value.split(',').map(s => s.trim()).filter(Boolean)\n                            })}\n                            placeholder=\".csv, .xlsx, .json\"\n                          />\n                        )}\n\n                        {config.type === 'url_list' && (\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            <Input\n                              label={t('minUrls')}\n                              type=\"number\"\n                              min=\"1\"\n                              value={config.minUrls || 1}\n                              onChange={(e) => updateInputConfig(varName, { minUrls: parseInt(e.target.value) })}\n                            />\n                            <Input\n                              label={t('maxUrls')}\n                              type=\"number\"\n                              min=\"1\"\n                              value={config.maxUrls || 10}\n                              onChange={(e) => updateInputConfig(varName, { maxUrls: parseInt(e.target.value) })}\n                            />\n                          </div>\n                        )}\n\n                        {config.type === 'image' && (\n                          <Input\n                            label={t('maxImageSizeMB')}\n                            type=\"number\"\n                            min=\"1\"\n                            max=\"50\"\n                            value={config.maxImageSize || 10}\n                            onChange={(e) => updateInputConfig(varName, { maxImageSize: parseInt(e.target.value) })}\n                          />\n                        )}\n                      </div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </CardBody>\n      </Card>\n\n      {/* Add Variable Modal */}\n      <Modal\n        isOpen={showAddVariable}\n        onClose={() => {\n          setShowAddVariable(false);\n          setNewVariableName('');\n          setNewVariableType('text');\n        }}\n        title={t('addNewVariable')}\n      >\n        <div className=\"space-y-4\">\n          <Input\n            label={t('variableName')}\n            value={newVariableName}\n            onChange={(e) => setNewVariableName(e.target.value)}\n            placeholder={t('variableNamePlaceholder')}\n          />\n          <p className=\"text-xs text-secondary-500 -mt-2\">\n            {t('variableNameHint')}\n          </p>\n\n          <div>\n            <label className=\"block text-sm font-medium text-secondary-700 mb-2\">\n              {t('inputType')}\n            </label>\n            <div className=\"grid grid-cols-5 gap-2\">\n              {INPUT_TYPE_OPTIONS.map((option) => (\n                <button\n                  key={option.value}\n                  onClick={() => setNewVariableType(option.value)}\n                  className={`flex flex-col items-center p-3 rounded-lg border-2 transition-colors ${\n                    newVariableType === option.value\n                      ? 'border-primary-500 bg-primary-50'\n                      : 'border-secondary-200 hover:border-secondary-300'\n                  }`}\n                >\n                  <span className=\"text-2xl mb-1\">{option.icon}</span>\n                  <span className=\"text-xs text-secondary-700\">{t(option.labelKey)}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"flex justify-end gap-3 pt-4\">\n            <Button variant=\"ghost\" onClick={() => setShowAddVariable(false)}>\n              {t('cancel')}\n            </Button>\n            <Button onClick={addVariable} disabled={!newVariableName.trim()}>\n              {t('addVariable')}\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Variable Help Modal */}\n      <Modal\n        isOpen={showVariableHelp}\n        onClose={() => setShowVariableHelp(false)}\n        title={t('variableReference')}\n        size=\"lg\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <h3 className=\"font-semibold text-secondary-900\">{t('supportedInputTypes')}</h3>\n            <div className=\"mt-2 space-y-2\">\n              {INPUT_TYPE_OPTIONS.map((option) => (\n                <div key={option.value} className=\"flex items-center gap-2 text-sm\">\n                  <span>{option.icon}</span>\n                  <span className=\"font-medium\">{t(option.labelKey)}</span>\n                  <span className=\"text-secondary-500\">- {t(`inputType_${option.value}_desc`)}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n          <div>\n            <h3 className=\"font-semibold text-secondary-900\">{t('variableSyntax')}</h3>\n            <p className=\"text-sm text-secondary-600 mt-1\">\n              <code className=\"bg-secondary-100 px-1 rounded\">{'{{variable_name}}'}</code> {t('templateVariableDesc')}\n            </p>\n            <div className=\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\">\n              {'{{product_image}}'} - {t('forImageUpload')}<br/>\n              {'{{product_urls}}'} - {t('forUrlList')}<br/>\n              {'{{sales_data}}'} - {t('forFileUpload')}\n            </div>\n          </div>\n          <div>\n            <h3 className=\"font-semibold text-secondary-900\">{t('companyStandards')}</h3>\n            <p className=\"text-sm text-secondary-600 mt-1\">\n              {t('companyStandardsDesc')}\n            </p>\n            <div className=\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\">\n              {'{{brand_voice}}'}<br/>\n              {'{{amazon_requirements}}'}<br/>\n              {'{{image_style_guidelines}}'}\n            </div>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Test Template Panel */}\n      <Modal\n        isOpen={showTestPanel}\n        onClose={() => setShowTestPanel(false)}\n        title={t('testTemplate')}\n        size=\"xl\"\n      >\n        <div className=\"space-y-6\">\n          {/* Template Info */}\n          <div className=\"bg-secondary-50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"font-medium text-secondary-900\">{template.name || t('untitledTemplate')}</h3>\n                <p className=\"text-sm text-secondary-500 mt-1\">\n                  {t('model')}: {models.find(m => m.id === template.ai_model)?.name || template.ai_model}\n                </p>\n              </div>\n              <span className=\"px-2 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded\">\n                {template.output_format}\n              </span>\n            </div>\n          </div>\n\n          {/* Input Fields */}\n          {allVariables.length > 0 ? (\n            <div>\n              <h3 className=\"font-medium text-secondary-900 mb-3\">{t('inputValues')}</h3>\n              <div className=\"space-y-4\">\n                {allVariables.map((varName) => {\n                  const config = getInputConfig(varName);\n                  const displayConfig = {\n                    ...config,\n                    label: config.label || varName,\n                  };\n\n                  return (\n                    <DynamicInput\n                      key={varName}\n                      name={varName}\n                      config={displayConfig}\n                      value={testInputValues[varName]}\n                      onChange={(value) =>\n                        setTestInputValues({ ...testInputValues, [varName]: value })\n                      }\n                      t={t}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-4 text-secondary-500\">\n              <p>{t('noInputVariables')}</p>\n            </div>\n          )}\n\n          {/* Error Display */}\n          {testError && (\n            <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\">\n              {testError}\n            </div>\n          )}\n\n          {/* Output Display */}\n          {(testOutput || testGeneratedImages.length > 0) && (\n            <div>\n              <h3 className=\"font-medium text-secondary-900 mb-3\">{t('output')}</h3>\n\n              {/* Generated Images Display */}\n              {testGeneratedImages.length > 0 && (\n                <div className=\"mb-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    {testGeneratedImages.map((image, index) => (\n                      <div key={index} className=\"relative group\">\n                        <div className=\"bg-secondary-100 rounded-lg overflow-hidden\">\n                          <img\n                            src={`data:${image.mimeType};base64,${image.base64}`}\n                            alt={`Generated image ${index + 1}`}\n                            className=\"w-full h-auto object-contain\"\n                          />\n                        </div>\n                        <div className=\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                          <button\n                            onClick={() => {\n                              // Open image in new tab for full size view\n                              const win = window.open();\n                              if (win) {\n                                win.document.write(`\n                                  <html>\n                                    <head><title>Generated Image ${index + 1}</title></head>\n                                    <body style=\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\">\n                                      <img src=\"data:${image.mimeType};base64,${image.base64}\" style=\"max-width:100%;max-height:100vh;\" />\n                                    </body>\n                                  </html>\n                                `);\n                              }\n                            }}\n                            className=\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm\"\n                            title={t('viewFullSize')}\n                          >\n                            <ExpandIcon className=\"w-4 h-4\" />\n                          </button>\n                          <button\n                            onClick={() => {\n                              // Download image\n                              const link = document.createElement('a');\n                              link.href = `data:${image.mimeType};base64,${image.base64}`;\n                              link.download = `generated-image-${index + 1}.${image.mimeType.split('/')[1] || 'png'}`;\n                              document.body.appendChild(link);\n                              link.click();\n                              document.body.removeChild(link);\n                            }}\n                            className=\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm\"\n                            title={t('downloadImage')}\n                          >\n                            <DownloadIcon className=\"w-4 h-4\" />\n                          </button>\n                        </div>\n                        <div className=\"absolute top-2 left-2\">\n                          <span className=\"px-2 py-1 bg-black/50 text-white text-xs rounded\">\n                            {t('image')} {index + 1}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Text Output Display */}\n              {testOutput && (\n                <div className=\"bg-secondary-50 rounded-lg p-4 max-h-96 overflow-auto\">\n                  {template.output_format === 'markdown' ? (\n                    <div className=\"prose prose-sm max-w-none\">\n                      <ReactMarkdown>{testOutput}</ReactMarkdown>\n                    </div>\n                  ) : template.output_format === 'json' ? (\n                    <pre className=\"text-sm font-mono whitespace-pre-wrap\">\n                      {(() => {\n                        try {\n                          return JSON.stringify(JSON.parse(testOutput), null, 2);\n                        } catch {\n                          return testOutput;\n                        }\n                      })()}\n                    </pre>\n                  ) : (\n                    <p className=\"text-sm whitespace-pre-wrap\">{testOutput}</p>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Actions */}\n          <div className=\"flex justify-between items-center pt-4 border-t border-secondary-200\">\n            <Button variant=\"ghost\" onClick={() => setShowTestPanel(false)}>\n              {t('close')}\n            </Button>\n            <div className=\"flex gap-3\">\n              {(testOutput || testGeneratedImages.length > 0) && (\n                <Button\n                  variant=\"secondary\"\n                  onClick={() => {\n                    setTestOutput(null);\n                    setTestGeneratedImages([]);\n                    setTestError(null);\n                  }}\n                >\n                  {t('clearOutput')}\n                </Button>\n              )}\n              <Button onClick={runTest} isLoading={isTestRunning}>\n                <PlayIcon className=\"w-4 h-4 mr-2\" />\n                {t('runTest')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\n/**\n * Dynamic config form for executor types (script, http, transform, etc.)\n * Renders form fields based on the executor's config schema.\n */\nfunction ExecutorConfigForm({\n  stepType,\n  executors,\n  executorConfig,\n  onConfigChange,\n}: {\n  stepType: string;\n  executors: ExecutorInfo[];\n  executorConfig: string;\n  onConfigChange: (config: string) => void;\n}) {\n  const executor = executors.find(e => e.type === stepType);\n  if (!executor) return null;\n\n  let config: Record<string, any> = {};\n  try {\n    config = executorConfig ? JSON.parse(executorConfig) : {};\n  } catch {\n    config = {};\n  }\n\n  const updateField = (name: string, value: any) => {\n    const updated = { ...config, [name]: value };\n    onConfigChange(JSON.stringify(updated));\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-center space-x-2\">\n          <span className=\"text-2xl\">{executor.icon}</span>\n          <div>\n            <h2 className=\"font-semibold text-secondary-900\">{executor.displayName} Configuration</h2>\n            <p className=\"text-sm text-secondary-500\">{executor.description}</p>\n          </div>\n        </div>\n      </CardHeader>\n      <CardBody className=\"space-y-4\">\n        {executor.configSchema.fields.map((field) => {\n          const value = config[field.name] ?? field.defaultValue ?? '';\n\n          switch (field.type) {\n            case 'select':\n              return (\n                <Select\n                  key={field.name}\n                  label={field.label}\n                  value={value}\n                  onChange={(e) => updateField(field.name, e.target.value)}\n                  options={field.options || []}\n                />\n              );\n\n            case 'textarea':\n              return (\n                <div key={field.name}>\n                  <TextArea\n                    label={field.label}\n                    value={value}\n                    onChange={(e) => updateField(field.name, e.target.value)}\n                    rows={6}\n                    className=\"font-mono text-sm\"\n                  />\n                  {field.helpText && (\n                    <p className=\"mt-1 text-sm text-secondary-500\">{field.helpText}</p>\n                  )}\n                </div>\n              );\n\n            case 'code':\n              return (\n                <div key={field.name}>\n                  <label className=\"block text-sm font-medium text-secondary-700 mb-1\">\n                    {field.label}\n                    {field.required && <span className=\"text-red-500 ml-1\">*</span>}\n                  </label>\n                  <textarea\n                    value={value}\n                    onChange={(e) => updateField(field.name, e.target.value)}\n                    rows={12}\n                    className=\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm bg-secondary-50\"\n                    placeholder={`Enter ${field.language || 'code'} here...`}\n                  />\n                  {field.helpText && (\n                    <p className=\"mt-1 text-sm text-secondary-500\">{field.helpText}</p>\n                  )}\n                </div>\n              );\n\n            case 'number':\n              return (\n                <Input\n                  key={field.name}\n                  label={field.label}\n                  type=\"number\"\n                  value={value}\n                  onChange={(e) => updateField(field.name, parseInt(e.target.value) || 0)}\n                />\n              );\n\n            case 'json':\n              return (\n                <div key={field.name}>\n                  <label className=\"block text-sm font-medium text-secondary-700 mb-1\">\n                    {field.label}\n                  </label>\n                  <textarea\n                    value={typeof value === 'string' ? value : JSON.stringify(value, null, 2)}\n                    onChange={(e) => {\n                      try {\n                        updateField(field.name, JSON.parse(e.target.value));\n                      } catch {\n                        // Allow invalid JSON while typing\n                        const updated = { ...config, [field.name]: e.target.value };\n                        onConfigChange(JSON.stringify(updated));\n                      }\n                    }}\n                    rows={4}\n                    className=\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm\"\n                    placeholder='{\"key\": \"value\"}'\n                  />\n                  {field.helpText && (\n                    <p className=\"mt-1 text-sm text-secondary-500\">{field.helpText}</p>\n                  )}\n                </div>\n              );\n\n            case 'boolean':\n              return (\n                <div key={field.name} className=\"flex items-center space-x-3\">\n                  <input\n                    type=\"checkbox\"\n                    checked={!!value}\n                    onChange={(e) => updateField(field.name, e.target.checked)}\n                    className=\"rounded border-secondary-300 text-primary-600 focus:ring-primary-500\"\n                  />\n                  <label className=\"text-sm font-medium text-secondary-700\">{field.label}</label>\n                </div>\n              );\n\n            default: // 'text'\n              return (\n                <div key={field.name}>\n                  <Input\n                    label={field.label}\n                    value={value}\n                    onChange={(e) => updateField(field.name, e.target.value)}\n                    placeholder={field.helpText || ''}\n                  />\n                  {field.helpText && (\n                    <p className=\"mt-1 text-sm text-secondary-500\">{field.helpText}</p>\n                  )}\n                </div>\n              );\n          }\n        })}\n      </CardBody>\n    </Card>\n  );\n}\n\nfunction ChevronIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n    </svg>\n  );\n}\n\nfunction InsertIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n    </svg>\n  );\n}\n\nfunction EditIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n    </svg>\n  );\n}\n\nfunction TrashIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n    </svg>\n  );\n}\n\nfunction PlayIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\" />\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n    </svg>\n  );\n}\n\nfunction ExpandIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\" />\n    </svg>\n  );\n}\n\nfunction DownloadIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n    </svg>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}