{"ast":null,"code":"// Cache for translations to avoid repeated API calls\nconst translationCache = new Map();\n\n// Generate cache key\nfunction getCacheKey(text, from, to) {\n  return `${from}:${to}:${text}`;\n}\n\n// Translate text using MyMemory free translation API\nexport async function translateText(text, from, to) {\n  // If same language or empty text, return as-is\n  if (from === to || !text || !text.trim()) {\n    return text;\n  }\n\n  // Check cache first\n  const cacheKey = getCacheKey(text, from, to);\n  if (translationCache.has(cacheKey)) {\n    return translationCache.get(cacheKey);\n  }\n  try {\n    var _data$responseData;\n    // Map language codes for the API\n    const langMap = {\n      en: 'en',\n      zh: 'zh-CN'\n    };\n    const response = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${langMap[from]}|${langMap[to]}`);\n    if (!response.ok) {\n      console.warn('Translation API error, returning original text');\n      return text;\n    }\n    const data = await response.json();\n    if (data.responseStatus === 200 && (_data$responseData = data.responseData) !== null && _data$responseData !== void 0 && _data$responseData.translatedText) {\n      const translated = data.responseData.translatedText;\n      // Cache the result\n      translationCache.set(cacheKey, translated);\n      return translated;\n    }\n    return text;\n  } catch (error) {\n    console.warn('Translation failed, returning original text:', error);\n    return text;\n  }\n}\n\n// Batch translate multiple texts\nexport async function translateTexts(texts, from, to) {\n  // If same language, return as-is\n  if (from === to) {\n    return texts;\n  }\n\n  // Translate all texts in parallel\n  const promises = texts.map(text => translateText(text, from, to));\n  return Promise.all(promises);\n}\n\n// Clear translation cache (useful when needed)\nexport function clearTranslationCache() {\n  translationCache.clear();\n}","map":{"version":3,"names":["translationCache","Map","getCacheKey","text","from","to","translateText","trim","cacheKey","has","get","_data$responseData","langMap","en","zh","response","fetch","encodeURIComponent","ok","console","warn","data","json","responseStatus","responseData","translatedText","translated","set","error","translateTexts","texts","promises","map","Promise","all","clearTranslationCache","clear"],"sources":["/Users/eveyhuang/Documents/novohaven-app/client/src/services/translationService.ts"],"sourcesContent":["import { Language } from '../i18n/translations';\n\n// Cache for translations to avoid repeated API calls\nconst translationCache = new Map<string, string>();\n\n// Generate cache key\nfunction getCacheKey(text: string, from: Language, to: Language): string {\n  return `${from}:${to}:${text}`;\n}\n\n// Translate text using MyMemory free translation API\nexport async function translateText(\n  text: string,\n  from: Language,\n  to: Language\n): Promise<string> {\n  // If same language or empty text, return as-is\n  if (from === to || !text || !text.trim()) {\n    return text;\n  }\n\n  // Check cache first\n  const cacheKey = getCacheKey(text, from, to);\n  if (translationCache.has(cacheKey)) {\n    return translationCache.get(cacheKey)!;\n  }\n\n  try {\n    // Map language codes for the API\n    const langMap: Record<Language, string> = {\n      en: 'en',\n      zh: 'zh-CN',\n    };\n\n    const response = await fetch(\n      `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${langMap[from]}|${langMap[to]}`\n    );\n\n    if (!response.ok) {\n      console.warn('Translation API error, returning original text');\n      return text;\n    }\n\n    const data = await response.json();\n\n    if (data.responseStatus === 200 && data.responseData?.translatedText) {\n      const translated = data.responseData.translatedText;\n      // Cache the result\n      translationCache.set(cacheKey, translated);\n      return translated;\n    }\n\n    return text;\n  } catch (error) {\n    console.warn('Translation failed, returning original text:', error);\n    return text;\n  }\n}\n\n// Batch translate multiple texts\nexport async function translateTexts(\n  texts: string[],\n  from: Language,\n  to: Language\n): Promise<string[]> {\n  // If same language, return as-is\n  if (from === to) {\n    return texts;\n  }\n\n  // Translate all texts in parallel\n  const promises = texts.map((text) => translateText(text, from, to));\n  return Promise.all(promises);\n}\n\n// Clear translation cache (useful when needed)\nexport function clearTranslationCache(): void {\n  translationCache.clear();\n}\n"],"mappings":"AAEA;AACA,MAAMA,gBAAgB,GAAG,IAAIC,GAAG,CAAiB,CAAC;;AAElD;AACA,SAASC,WAAWA,CAACC,IAAY,EAAEC,IAAc,EAAEC,EAAY,EAAU;EACvE,OAAO,GAAGD,IAAI,IAAIC,EAAE,IAAIF,IAAI,EAAE;AAChC;;AAEA;AACA,OAAO,eAAeG,aAAaA,CACjCH,IAAY,EACZC,IAAc,EACdC,EAAY,EACK;EACjB;EACA,IAAID,IAAI,KAAKC,EAAE,IAAI,CAACF,IAAI,IAAI,CAACA,IAAI,CAACI,IAAI,CAAC,CAAC,EAAE;IACxC,OAAOJ,IAAI;EACb;;EAEA;EACA,MAAMK,QAAQ,GAAGN,WAAW,CAACC,IAAI,EAAEC,IAAI,EAAEC,EAAE,CAAC;EAC5C,IAAIL,gBAAgB,CAACS,GAAG,CAACD,QAAQ,CAAC,EAAE;IAClC,OAAOR,gBAAgB,CAACU,GAAG,CAACF,QAAQ,CAAC;EACvC;EAEA,IAAI;IAAA,IAAAG,kBAAA;IACF;IACA,MAAMC,OAAiC,GAAG;MACxCC,EAAE,EAAE,IAAI;MACRC,EAAE,EAAE;IACN,CAAC;IAED,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAC1B,6CAA6CC,kBAAkB,CAACd,IAAI,CAAC,aAAaS,OAAO,CAACR,IAAI,CAAC,IAAIQ,OAAO,CAACP,EAAE,CAAC,EAChH,CAAC;IAED,IAAI,CAACU,QAAQ,CAACG,EAAE,EAAE;MAChBC,OAAO,CAACC,IAAI,CAAC,gDAAgD,CAAC;MAC9D,OAAOjB,IAAI;IACb;IAEA,MAAMkB,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;IAElC,IAAID,IAAI,CAACE,cAAc,KAAK,GAAG,KAAAZ,kBAAA,GAAIU,IAAI,CAACG,YAAY,cAAAb,kBAAA,eAAjBA,kBAAA,CAAmBc,cAAc,EAAE;MACpE,MAAMC,UAAU,GAAGL,IAAI,CAACG,YAAY,CAACC,cAAc;MACnD;MACAzB,gBAAgB,CAAC2B,GAAG,CAACnB,QAAQ,EAAEkB,UAAU,CAAC;MAC1C,OAAOA,UAAU;IACnB;IAEA,OAAOvB,IAAI;EACb,CAAC,CAAC,OAAOyB,KAAK,EAAE;IACdT,OAAO,CAACC,IAAI,CAAC,8CAA8C,EAAEQ,KAAK,CAAC;IACnE,OAAOzB,IAAI;EACb;AACF;;AAEA;AACA,OAAO,eAAe0B,cAAcA,CAClCC,KAAe,EACf1B,IAAc,EACdC,EAAY,EACO;EACnB;EACA,IAAID,IAAI,KAAKC,EAAE,EAAE;IACf,OAAOyB,KAAK;EACd;;EAEA;EACA,MAAMC,QAAQ,GAAGD,KAAK,CAACE,GAAG,CAAE7B,IAAI,IAAKG,aAAa,CAACH,IAAI,EAAEC,IAAI,EAAEC,EAAE,CAAC,CAAC;EACnE,OAAO4B,OAAO,CAACC,GAAG,CAACH,QAAQ,CAAC;AAC9B;;AAEA;AACA,OAAO,SAASI,qBAAqBA,CAAA,EAAS;EAC5CnC,gBAAgB,CAACoC,KAAK,CAAC,CAAC;AAC1B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}