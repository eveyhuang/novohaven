{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect,useCallback}from'react';import api from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(undefined);export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[isLoading,setIsLoading]=useState(true);const checkAuth=useCallback(async()=>{try{const token=api.getToken();if(!token){// Auto-login for MVP\nawait login('demo@novohaven.com','password');return;}const{user:currentUser}=await api.getCurrentUser();setUser(currentUser);}catch(error){// Auto-login for MVP\ntry{await login('demo@novohaven.com','password');}catch(_unused){setUser(null);api.setToken(null);}}finally{setIsLoading(false);}},[]);useEffect(()=>{checkAuth();},[checkAuth]);const login=async(email,password)=>{setIsLoading(true);try{const response=await api.login({email,password});setUser(response.user);}finally{setIsLoading(false);}};const logout=async()=>{setIsLoading(true);try{await api.logout();setUser(null);}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,isLoading,isAuthenticated:!!user,login,logout,checkAuth},children:children});}export function useAuth(){const context=useContext(AuthContext);if(context===undefined){throw new Error('useAuth must be used within an AuthProvider');}return context;}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","api","jsx","_jsx","AuthContext","undefined","AuthProvider","_ref","children","user","setUser","isLoading","setIsLoading","checkAuth","token","getToken","login","currentUser","getCurrentUser","error","_unused","setToken","email","password","response","logout","Provider","value","isAuthenticated","useAuth","context","Error"],"sources":["/Users/eveyhuang/Documents/novohaven-app/client/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\nimport { User } from '../types';\nimport api from '../services/api';\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  isAuthenticated: boolean;\n  login: (email: string, password: string) => Promise<void>;\n  logout: () => Promise<void>;\n  checkAuth: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const checkAuth = useCallback(async () => {\n    try {\n      const token = api.getToken();\n      if (!token) {\n        // Auto-login for MVP\n        await login('demo@novohaven.com', 'password');\n        return;\n      }\n\n      const { user: currentUser } = await api.getCurrentUser();\n      setUser(currentUser);\n    } catch (error) {\n      // Auto-login for MVP\n      try {\n        await login('demo@novohaven.com', 'password');\n      } catch {\n        setUser(null);\n        api.setToken(null);\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    checkAuth();\n  }, [checkAuth]);\n\n  const login = async (email: string, password: string) => {\n    setIsLoading(true);\n    try {\n      const response = await api.login({ email, password });\n      setUser(response.user);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const logout = async () => {\n    setIsLoading(true);\n    try {\n      await api.logout();\n      setUser(null);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isLoading,\n        isAuthenticated: !!user,\n        login,\n        logout,\n        checkAuth,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,CAAEC,WAAW,KAAQ,OAAO,CAE1F,MAAO,CAAAC,GAAG,KAAM,iBAAiB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAWlC,KAAM,CAAAC,WAAW,cAAGR,aAAa,CAA8BS,SAAS,CAAC,CAEzE,MAAO,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAA8C,IAA7C,CAAEC,QAAwC,CAAC,CAAAD,IAAA,CACtE,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGZ,QAAQ,CAAc,IAAI,CAAC,CACnD,KAAM,CAACa,SAAS,CAAEC,YAAY,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAEhD,KAAM,CAAAe,SAAS,CAAGb,WAAW,CAAC,SAAY,CACxC,GAAI,CACF,KAAM,CAAAc,KAAK,CAAGb,GAAG,CAACc,QAAQ,CAAC,CAAC,CAC5B,GAAI,CAACD,KAAK,CAAE,CACV;AACA,KAAM,CAAAE,KAAK,CAAC,oBAAoB,CAAE,UAAU,CAAC,CAC7C,OACF,CAEA,KAAM,CAAEP,IAAI,CAAEQ,WAAY,CAAC,CAAG,KAAM,CAAAhB,GAAG,CAACiB,cAAc,CAAC,CAAC,CACxDR,OAAO,CAACO,WAAW,CAAC,CACtB,CAAE,MAAOE,KAAK,CAAE,CACd;AACA,GAAI,CACF,KAAM,CAAAH,KAAK,CAAC,oBAAoB,CAAE,UAAU,CAAC,CAC/C,CAAE,MAAAI,OAAA,CAAM,CACNV,OAAO,CAAC,IAAI,CAAC,CACbT,GAAG,CAACoB,QAAQ,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,OAAS,CACRT,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAAE,EAAE,CAAC,CAENb,SAAS,CAAC,IAAM,CACdc,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,CAACA,SAAS,CAAC,CAAC,CAEf,KAAM,CAAAG,KAAK,CAAG,KAAAA,CAAOM,KAAa,CAAEC,QAAgB,GAAK,CACvDX,YAAY,CAAC,IAAI,CAAC,CAClB,GAAI,CACF,KAAM,CAAAY,QAAQ,CAAG,KAAM,CAAAvB,GAAG,CAACe,KAAK,CAAC,CAAEM,KAAK,CAAEC,QAAS,CAAC,CAAC,CACrDb,OAAO,CAACc,QAAQ,CAACf,IAAI,CAAC,CACxB,CAAC,OAAS,CACRG,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,KAAM,CAAAa,MAAM,CAAG,KAAAA,CAAA,GAAY,CACzBb,YAAY,CAAC,IAAI,CAAC,CAClB,GAAI,CACF,KAAM,CAAAX,GAAG,CAACwB,MAAM,CAAC,CAAC,CAClBf,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,OAAS,CACRE,YAAY,CAAC,KAAK,CAAC,CACrB,CACF,CAAC,CAED,mBACET,IAAA,CAACC,WAAW,CAACsB,QAAQ,EACnBC,KAAK,CAAE,CACLlB,IAAI,CACJE,SAAS,CACTiB,eAAe,CAAE,CAAC,CAACnB,IAAI,CACvBO,KAAK,CACLS,MAAM,CACNZ,SACF,CAAE,CAAAL,QAAA,CAEDA,QAAQ,CACW,CAAC,CAE3B,CAEA,MAAO,SAAS,CAAAqB,OAAOA,CAAA,CAAG,CACxB,KAAM,CAAAC,OAAO,CAAGjC,UAAU,CAACO,WAAW,CAAC,CACvC,GAAI0B,OAAO,GAAKzB,SAAS,CAAE,CACzB,KAAM,IAAI,CAAA0B,KAAK,CAAC,6CAA6C,CAAC,CAChE,CACA,MAAO,CAAAD,OAAO,CAChB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}