{"ast":null,"code":"import _objectSpread from\"/Users/eveyhuang/Documents/novohaven-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useMemo,useRef}from'react';import{useParams,useNavigate}from'react-router-dom';import api from'../../services/api';import{Button,Input,TextArea,Select,Card,CardBody,CardHeader,Modal,DynamicInput}from'../common';import{useLanguage}from'../../context/LanguageContext';import ReactMarkdown from'react-markdown';// System variables that shouldn't be treated as user inputs\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SYSTEM_VARIABLES=['brand_voice','amazon_requirements','image_style_guidelines','social_media_guidelines','platform_requirements','tone_guidelines'];// Extract user input variables from prompt template\nfunction extractInputsFromPrompt(promptTemplate){const variables=[];const matches=promptTemplate.match(/\\{\\{([^}]+)\\}\\}/g)||[];matches.forEach(match=>{const varName=match.replace(/\\{\\{|\\}\\}/g,'').trim();if(!varName.match(/^step_\\d+_output$/)&&!SYSTEM_VARIABLES.includes(varName)){if(!variables.includes(varName)){variables.push(varName);}}});return variables;}const INPUT_TYPE_OPTIONS=[{value:'text',labelKey:'inputTypeText',icon:'üìù'},{value:'textarea',labelKey:'inputTypeTextarea',icon:'üìÑ'},{value:'image',labelKey:'inputTypeImage',icon:'üñºÔ∏è'},{value:'url_list',labelKey:'inputTypeUrlList',icon:'üîó'},{value:'file',labelKey:'inputTypeFile',icon:'üìÅ'}];const DEFAULT_INPUT_CONFIG={type:'text',placeholder:'',description:''};export function TemplateEditor(){var _models$find;const{id}=useParams();const navigate=useNavigate();const{t}=useLanguage();const isNew=!id||id==='new';const promptTextAreaRef=useRef(null);const[template,setTemplate]=useState({name:'',description:'',step_name:'',ai_model:'mock',prompt_template:'',output_format:'text',model_config:JSON.stringify({temperature:0.7,maxTokens:2000}),input_config:JSON.stringify({variables:{}})});const[models,setModels]=useState([]);const[isLoading,setIsLoading]=useState(!isNew);const[isSaving,setIsSaving]=useState(false);const[error,setError]=useState(null);const[showVariableHelp,setShowVariableHelp]=useState(false);const[expandedVariable,setExpandedVariable]=useState(null);const[showAddVariable,setShowAddVariable]=useState(false);const[newVariableName,setNewVariableName]=useState('');const[newVariableType,setNewVariableType]=useState('text');const[editingVariableName,setEditingVariableName]=useState(null);const[editedName,setEditedName]=useState('');// Test mode state\nconst[showTestPanel,setShowTestPanel]=useState(false);const[testInputValues,setTestInputValues]=useState({});const[testOutput,setTestOutput]=useState(null);const[testGeneratedImages,setTestGeneratedImages]=useState([]);const[isTestRunning,setIsTestRunning]=useState(false);const[testError,setTestError]=useState(null);useEffect(()=>{loadModels();if(!isNew&&id){loadTemplate(parseInt(id));}},[id,isNew]);const loadModels=async()=>{try{const{all}=await api.getAIModels();setModels(all);}catch(err){console.error('Failed to load models:',err);}};const loadTemplate=async templateId=>{setIsLoading(true);try{var _data$steps;const data=await api.getRecipe(templateId);const step=(_data$steps=data.steps)===null||_data$steps===void 0?void 0:_data$steps[0];setTemplate({name:data.name,description:data.description||'',step_name:(step===null||step===void 0?void 0:step.step_name)||data.name,ai_model:(step===null||step===void 0?void 0:step.ai_model)||'mock',prompt_template:(step===null||step===void 0?void 0:step.prompt_template)||'',output_format:(step===null||step===void 0?void 0:step.output_format)||'text',model_config:(step===null||step===void 0?void 0:step.model_config)||JSON.stringify({temperature:0.7,maxTokens:2000}),input_config:(step===null||step===void 0?void 0:step.input_config)||JSON.stringify({variables:{}})});}catch(err){setError(err.message);}finally{setIsLoading(false);}};// Get input config for a variable\nconst getInputConfig=varName=>{try{var _config$variables;const config=JSON.parse(template.input_config);return((_config$variables=config.variables)===null||_config$variables===void 0?void 0:_config$variables[varName])||_objectSpread({},DEFAULT_INPUT_CONFIG);}catch(_unused){return _objectSpread({},DEFAULT_INPUT_CONFIG);}};// Update input config for a variable\nconst updateInputConfig=(varName,updates)=>{try{const config=JSON.parse(template.input_config);if(!config.variables)config.variables={};config.variables[varName]=_objectSpread(_objectSpread({},getInputConfig(varName)),updates);setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config)}));}catch(_unused2){const config={variables:{[varName]:_objectSpread(_objectSpread({},DEFAULT_INPUT_CONFIG),updates)}};setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config)}));}};// Get all configured variables (including those not in prompt)\nconst getConfiguredVariables=()=>{try{const config=JSON.parse(template.input_config);return Object.keys(config.variables||{});}catch(_unused3){return[];}};// Add a new variable\nconst addVariable=()=>{if(!newVariableName.trim())return;const varName=newVariableName.trim().replace(/\\s+/g,'_').toLowerCase();// Check if variable already exists\nconst allVars=[...new Set([...promptVariables,...getConfiguredVariables()])];if(allVars.includes(varName)){setError(t('variableAlreadyExists'));return;}updateInputConfig(varName,{type:newVariableType});setNewVariableName('');setNewVariableType('text');setShowAddVariable(false);setExpandedVariable(varName);};// Delete a variable from config\nconst deleteVariable=varName=>{try{var _config$variables2;const config=JSON.parse(template.input_config);if((_config$variables2=config.variables)!==null&&_config$variables2!==void 0&&_config$variables2[varName]){delete config.variables[varName];setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config)}));}}catch(_unused4){// Ignore\n}if(expandedVariable===varName){setExpandedVariable(null);}};// Rename a variable\nconst renameVariable=(oldName,newName)=>{if(!newName.trim()||oldName===newName){setEditingVariableName(null);return;}const formattedName=newName.trim().replace(/\\s+/g,'_').toLowerCase();// Update config\ntry{var _config$variables3;const config=JSON.parse(template.input_config);if((_config$variables3=config.variables)!==null&&_config$variables3!==void 0&&_config$variables3[oldName]){config.variables[formattedName]=config.variables[oldName];delete config.variables[oldName];}// Update prompt template - replace old variable with new one\nconst updatedPrompt=template.prompt_template.replace(new RegExp(\"\\\\{\\\\{\\\\s*\".concat(oldName,\"\\\\s*\\\\}\\\\}\"),'g'),\"{{\".concat(formattedName,\"}}\"));setTemplate(_objectSpread(_objectSpread({},template),{},{input_config:JSON.stringify(config),prompt_template:updatedPrompt}));}catch(_unused5){// Ignore\n}setEditingVariableName(null);if(expandedVariable===oldName){setExpandedVariable(formattedName);}};// Insert variable into prompt at cursor position\nconst insertVariableIntoPrompt=varName=>{const textarea=promptTextAreaRef.current;if(!textarea)return;const start=textarea.selectionStart;const end=textarea.selectionEnd;const text=template.prompt_template;const variableText=\"{{\".concat(varName,\"}}\");const newText=text.substring(0,start)+variableText+text.substring(end);setTemplate(_objectSpread(_objectSpread({},template),{},{prompt_template:newText}));// Focus and set cursor position after the inserted variable\nsetTimeout(()=>{textarea.focus();const newCursorPos=start+variableText.length;textarea.setSelectionRange(newCursorPos,newCursorPos);},0);};// Initialize test input values when test panel opens\nconst openTestPanel=()=>{const initialValues={};allVariables.forEach(varName=>{const config=getInputConfig(varName);if(config.type==='url_list'){initialValues[varName]=[''];}else if(config.type==='image'||config.type==='file'){initialValues[varName]=null;}else{initialValues[varName]='';}});setTestInputValues(initialValues);setTestOutput(null);setTestGeneratedImages([]);setTestError(null);setShowTestPanel(true);};// Run test execution\nconst runTest=async()=>{// Validate required inputs\nconst missingInputs=allVariables.filter(varName=>{const value=testInputValues[varName];const config=getInputConfig(varName);if(config.type==='image'||config.type==='file'){return!value;}else if(config.type==='url_list'){return!Array.isArray(value)||value.filter(u=>u.trim()).length===0;}return!value||typeof value==='string'&&!value.trim();});if(missingInputs.length>0){setTestError(\"\".concat(t('fillRequiredFields'),\": \").concat(missingInputs.map(v=>getInputConfig(v).label||v).join(', ')));return;}if(!template.prompt_template.trim()){setTestError(t('promptTemplateRequired'));return;}setIsTestRunning(true);setTestError(null);setTestOutput(null);setTestGeneratedImages([]);try{// Compile prompt by replacing variables\nlet compiledPrompt=template.prompt_template;const images=[];for(const varName of allVariables){const value=testInputValues[varName];const config=getInputConfig(varName);let replacementValue='';if(config.type==='image'&&value!==null&&value!==void 0&&value.base64){// Extract image for vision models\nimages.push({base64:value.base64,mediaType:value.type||'image/jpeg'});replacementValue=\"[See attached image: \".concat(varName,\"]\");}else if(config.type==='file'&&value!==null&&value!==void 0&&value.content){replacementValue=value.content;}else if(config.type==='url_list'&&Array.isArray(value)){replacementValue=value.filter(u=>u.trim()).join('\\n');}else{replacementValue=String(value||'');}compiledPrompt=compiledPrompt.replace(new RegExp(\"\\\\{\\\\{\\\\s*\".concat(varName,\"\\\\s*\\\\}\\\\}\"),'g'),replacementValue);}// Get model config\nconst modelConfig=JSON.parse(template.model_config||'{}');const modelInfo=models.find(m=>m.id===template.ai_model);const provider=(modelInfo===null||modelInfo===void 0?void 0:modelInfo.provider)||'mock';// Call AI test endpoint\nconst response=await api.testAI(provider,template.ai_model,compiledPrompt,{temperature:modelConfig.temperature,maxTokens:modelConfig.maxTokens},images.length>0?images:undefined);if(response.success){setTestOutput(response.content);if(response.generatedImages&&response.generatedImages.length>0){setTestGeneratedImages(response.generatedImages);}}else{setTestError(response.error||t('testFailed'));}}catch(err){setTestError(err.message||t('testFailed'));}finally{setIsTestRunning(false);}};const handleSave=async()=>{if(!template.name){setError(t('templateNameRequired'));return;}if(!template.prompt_template){setError(t('promptTemplateRequired'));return;}setIsSaving(true);setError(null);try{const step={step_order:1,step_name:template.step_name||template.name,ai_model:template.ai_model,prompt_template:template.prompt_template,output_format:template.output_format,model_config:template.model_config,input_config:template.input_config};if(isNew){await api.createRecipe({name:template.name,description:template.description,steps:[step],is_template:true});navigate('/');}else if(id){await api.updateRecipe(parseInt(id),{name:template.name,description:template.description,steps:[step],is_template:true});navigate('/');}}catch(err){setError(err.message);}finally{setIsSaving(false);}};const handleDelete=async()=>{if(!id||!window.confirm(t('confirmDeleteTemplate')))return;try{await api.deleteRecipe(parseInt(id));navigate('/');}catch(err){setError(err.message);}};// Variables extracted from prompt\nconst promptVariables=useMemo(()=>extractInputsFromPrompt(template.prompt_template),[template.prompt_template]);// All variables (from prompt + configured)\nconst allVariables=useMemo(()=>{const configured=getConfiguredVariables();return[...new Set([...promptVariables,...configured])];},[promptVariables,template.input_config]);if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6 max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-secondary-900\",children:isNew?t('createNewTemplate'):t('editTemplate')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-600 mt-1\",children:t('templateEditorSubtitle')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>navigate('/'),children:t('cancel')}),!isNew&&/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:handleDelete,className:\"text-red-600 hover:text-red-700\",children:t('delete')}),/*#__PURE__*/_jsxs(Button,{variant:\"secondary\",onClick:openTestPanel,children:[/*#__PURE__*/_jsx(PlayIcon,{className:\"w-4 h-4 mr-2\"}),t('testTemplate')]}),/*#__PURE__*/_jsx(Button,{onClick:handleSave,isLoading:isSaving,children:isNew?t('createTemplate'):t('saveChanges')})]})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\",children:error}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('templateDetails')})}),/*#__PURE__*/_jsxs(CardBody,{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('templateName'),value:template.name,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{name:e.target.value})),placeholder:t('templateNamePlaceholder')}),/*#__PURE__*/_jsx(TextArea,{label:t('description'),value:template.description,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{description:e.target.value})),placeholder:t('templateDescriptionPlaceholder'),rows:2})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('aiConfiguration')})}),/*#__PURE__*/_jsxs(CardBody,{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Select,{label:t('aiModel'),value:template.ai_model,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{ai_model:e.target.value})),options:models.map(m=>({value:m.id,label:\"\".concat(m.name).concat(m.available?'':\" (\".concat(t('notConfigured'),\")\"))}))}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-1\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700\",children:t('promptTemplate')}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowVariableHelp(true),className:\"text-sm text-primary-600 hover:text-primary-700\",children:t('variableHelp')})]}),/*#__PURE__*/_jsx(\"textarea\",{ref:promptTextAreaRef,value:template.prompt_template,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{prompt_template:e.target.value})),placeholder:t('promptTemplatePlaceholder'),rows:12,className:\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-secondary-500\",children:t('templatePromptHelp')})]}),/*#__PURE__*/_jsx(Select,{label:t('outputFormat'),value:template.output_format,onChange:e=>setTemplate(_objectSpread(_objectSpread({},template),{},{output_format:e.target.value})),options:[{value:'text',label:t('plainText')},{value:'markdown',label:t('markdown')},{value:'json',label:t('json')},{value:'image',label:t('generatedImages')}]}),/*#__PURE__*/_jsxs(\"div\",{className:\"border-t border-secondary-200 pt-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-secondary-700 mb-3\",children:t('modelSettings')}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('temperature'),type:\"number\",min:\"0\",max:\"2\",step:\"0.1\",value:JSON.parse(template.model_config||'{}').temperature||0.7,onChange:e=>{const config=JSON.parse(template.model_config||'{}');config.temperature=parseFloat(e.target.value);setTemplate(_objectSpread(_objectSpread({},template),{},{model_config:JSON.stringify(config)}));}}),/*#__PURE__*/_jsx(Input,{label:t('maxTokens'),type:\"number\",min:\"100\",max:\"100000\",step:\"100\",value:JSON.parse(template.model_config||'{}').maxTokens||2000,onChange:e=>{const config=JSON.parse(template.model_config||'{}');config.maxTokens=parseInt(e.target.value);setTemplate(_objectSpread(_objectSpread({},template),{},{model_config:JSON.stringify(config)}));}})]})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:t('inputVariables')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-secondary-500 mt-1\",children:t('inputVariablesDesc')})]}),/*#__PURE__*/_jsxs(Button,{size:\"sm\",onClick:()=>setShowAddVariable(true),children:[\"+ \",t('addVariable')]})]})}),/*#__PURE__*/_jsx(CardBody,{children:allVariables.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8 text-secondary-500\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"text-4xl mb-2\",children:\"\\uD83D\\uDCE5\"}),/*#__PURE__*/_jsx(\"p\",{children:t('noVariablesYet')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm mt-1\",children:t('addVariablesHint')})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:allVariables.map(varName=>{const config=getInputConfig(varName);const isExpanded=expandedVariable===varName;const typeOption=INPUT_TYPE_OPTIONS.find(o=>o.value===config.type);const isInPrompt=promptVariables.includes(varName);const isEditing=editingVariableName===varName;return/*#__PURE__*/_jsxs(\"div\",{className:\"border border-secondary-200 rounded-lg overflow-hidden\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between px-4 py-3 bg-secondary-50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3 flex-1 cursor-pointer\",onClick:()=>setExpandedVariable(isExpanded?null:varName),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:(typeOption===null||typeOption===void 0?void 0:typeOption.icon)||'üìù'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[isEditing?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editedName,onChange:e=>setEditedName(e.target.value),onBlur:()=>renameVariable(varName,editedName),onKeyDown:e=>{if(e.key==='Enter')renameVariable(varName,editedName);if(e.key==='Escape')setEditingVariableName(null);},onClick:e=>e.stopPropagation(),className:\"px-2 py-1 border border-primary-300 rounded text-sm font-mono focus:outline-none focus:ring-2 focus:ring-primary-500\",autoFocus:true}):/*#__PURE__*/_jsx(\"code\",{className:\"font-semibold text-secondary-900\",children:varName}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-secondary-500\",children:typeOption?t(typeOption.labelKey):t('inputTypeText')}),isInPrompt?/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded\",children:t('inPrompt')}):/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded\",children:t('notInPrompt')})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-1\",children:[!isInPrompt&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();insertVariableIntoPrompt(varName);},className:\"p-1.5 text-primary-600 hover:bg-primary-50 rounded\",title:t('insertIntoPrompt'),children:/*#__PURE__*/_jsx(InsertIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setEditedName(varName);setEditingVariableName(varName);},className:\"p-1.5 text-secondary-500 hover:bg-secondary-100 rounded\",title:t('rename'),children:/*#__PURE__*/_jsx(EditIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();if(isInPrompt){if(window.confirm(t('confirmDeleteVariableInPrompt'))){deleteVariable(varName);}}else{deleteVariable(varName);}},className:\"p-1.5 text-red-500 hover:bg-red-50 rounded\",title:t('delete'),children:/*#__PURE__*/_jsx(TrashIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setExpandedVariable(isExpanded?null:varName),className:\"p-1.5 text-secondary-400 hover:bg-secondary-100 rounded\",children:/*#__PURE__*/_jsx(ChevronIcon,{className:\"w-5 h-5 transition-transform \".concat(isExpanded?'rotate-180':'')})})]})]}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-4 space-y-4 border-t border-secondary-200\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700 mb-2\",children:t('inputType')}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:INPUT_TYPE_OPTIONS.map(option=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>updateInputConfig(varName,{type:option.value}),className:\"flex flex-col items-center p-3 rounded-lg border-2 transition-colors \".concat(config.type===option.value?'border-primary-500 bg-primary-50':'border-secondary-200 hover:border-secondary-300'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mb-1\",children:option.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-secondary-700\",children:t(option.labelKey)})]},option.value))})]}),/*#__PURE__*/_jsx(Input,{label:t('fieldLabel'),value:config.label||'',onChange:e=>updateInputConfig(varName,{label:e.target.value}),placeholder:varName}),/*#__PURE__*/_jsx(Input,{label:t('placeholderText'),value:config.placeholder||'',onChange:e=>updateInputConfig(varName,{placeholder:e.target.value}),placeholder:t('placeholderExample')}),/*#__PURE__*/_jsx(TextArea,{label:t('helpText'),value:config.description||'',onChange:e=>updateInputConfig(varName,{description:e.target.value}),placeholder:t('helpTextExample'),rows:2}),config.type==='file'&&/*#__PURE__*/_jsx(Input,{label:t('acceptedFileTypes'),value:(config.acceptedFileTypes||[]).join(', '),onChange:e=>updateInputConfig(varName,{acceptedFileTypes:e.target.value.split(',').map(s=>s.trim()).filter(Boolean)}),placeholder:\".csv, .xlsx, .json\"}),config.type==='url_list'&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('minUrls'),type:\"number\",min:\"1\",value:config.minUrls||1,onChange:e=>updateInputConfig(varName,{minUrls:parseInt(e.target.value)})}),/*#__PURE__*/_jsx(Input,{label:t('maxUrls'),type:\"number\",min:\"1\",value:config.maxUrls||10,onChange:e=>updateInputConfig(varName,{maxUrls:parseInt(e.target.value)})})]}),config.type==='image'&&/*#__PURE__*/_jsx(Input,{label:t('maxImageSizeMB'),type:\"number\",min:\"1\",max:\"50\",value:config.maxImageSize||10,onChange:e=>updateInputConfig(varName,{maxImageSize:parseInt(e.target.value)})})]})]},varName);})})})]}),/*#__PURE__*/_jsx(Modal,{isOpen:showAddVariable,onClose:()=>{setShowAddVariable(false);setNewVariableName('');setNewVariableType('text');},title:t('addNewVariable'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(Input,{label:t('variableName'),value:newVariableName,onChange:e=>setNewVariableName(e.target.value),placeholder:t('variableNamePlaceholder')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-xs text-secondary-500 -mt-2\",children:t('variableNameHint')}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-secondary-700 mb-2\",children:t('inputType')}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-5 gap-2\",children:INPUT_TYPE_OPTIONS.map(option=>/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setNewVariableType(option.value),className:\"flex flex-col items-center p-3 rounded-lg border-2 transition-colors \".concat(newVariableType===option.value?'border-primary-500 bg-primary-50':'border-secondary-200 hover:border-secondary-300'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl mb-1\",children:option.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-secondary-700\",children:t(option.labelKey)})]},option.value))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-3 pt-4\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>setShowAddVariable(false),children:t('cancel')}),/*#__PURE__*/_jsx(Button,{onClick:addVariable,disabled:!newVariableName.trim(),children:t('addVariable')})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:showVariableHelp,onClose:()=>setShowVariableHelp(false),title:t('variableReference'),size:\"lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-secondary-900\",children:t('supportedInputTypes')}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 space-y-2\",children:INPUT_TYPE_OPTIONS.map(option=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{children:option.icon}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:t(option.labelKey)}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary-500\",children:[\"- \",t(\"inputType_\".concat(option.value,\"_desc\"))]})]},option.value))})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-secondary-900\",children:t('variableSyntax')}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-secondary-600 mt-1\",children:[/*#__PURE__*/_jsx(\"code\",{className:\"bg-secondary-100 px-1 rounded\",children:'{{variable_name}}'}),\" \",t('templateVariableDesc')]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\",children:['{{product_image}}',\" - \",t('forImageUpload'),/*#__PURE__*/_jsx(\"br\",{}),'{{product_urls}}',\" - \",t('forUrlList'),/*#__PURE__*/_jsx(\"br\",{}),'{{sales_data}}',\" - \",t('forFileUpload')]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold text-secondary-900\",children:t('companyStandards')}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-secondary-600 mt-1\",children:t('companyStandardsDesc')}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\",children:['{{brand_voice}}',/*#__PURE__*/_jsx(\"br\",{}),'{{amazon_requirements}}',/*#__PURE__*/_jsx(\"br\",{}),'{{image_style_guidelines}}']})]})]})}),/*#__PURE__*/_jsx(Modal,{isOpen:showTestPanel,onClose:()=>setShowTestPanel(false),title:t('testTemplate'),size:\"xl\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-50 rounded-lg p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-secondary-900\",children:template.name||t('untitledTemplate')}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-secondary-500 mt-1\",children:[t('model'),\": \",((_models$find=models.find(m=>m.id===template.ai_model))===null||_models$find===void 0?void 0:_models$find.name)||template.ai_model]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded\",children:template.output_format})]})}),allVariables.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-secondary-900 mb-3\",children:t('inputValues')}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:allVariables.map(varName=>{const config=getInputConfig(varName);const displayConfig=_objectSpread(_objectSpread({},config),{},{label:config.label||varName});return/*#__PURE__*/_jsx(DynamicInput,{name:varName,config:displayConfig,value:testInputValues[varName],onChange:value=>setTestInputValues(_objectSpread(_objectSpread({},testInputValues),{},{[varName]:value})),t:t},varName);})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4 text-secondary-500\",children:/*#__PURE__*/_jsx(\"p\",{children:t('noInputVariables')})}),testError&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\",children:testError}),(testOutput||testGeneratedImages.length>0)&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-medium text-secondary-900 mb-3\",children:t('output')}),testGeneratedImages.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:testGeneratedImages.map((image,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-100 rounded-lg overflow-hidden\",children:/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(image.mimeType,\";base64,\").concat(image.base64),alt:\"Generated image \".concat(index+1),className:\"w-full h-auto object-contain\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Open image in new tab for full size view\nconst win=window.open();if(win){win.document.write(\"\\n                                  <html>\\n                                    <head><title>Generated Image \".concat(index+1,\"</title></head>\\n                                    <body style=\\\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\\\">\\n                                      <img src=\\\"data:\").concat(image.mimeType,\";base64,\").concat(image.base64,\"\\\" style=\\\"max-width:100%;max-height:100vh;\\\" />\\n                                    </body>\\n                                  </html>\\n                                \"));}},className:\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm\",title:t('viewFullSize'),children:/*#__PURE__*/_jsx(ExpandIcon,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{// Download image\nconst link=document.createElement('a');link.href=\"data:\".concat(image.mimeType,\";base64,\").concat(image.base64);link.download=\"generated-image-\".concat(index+1,\".\").concat(image.mimeType.split('/')[1]||'png');document.body.appendChild(link);link.click();document.body.removeChild(link);},className:\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm\",title:t('downloadImage'),children:/*#__PURE__*/_jsx(DownloadIcon,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-black/50 text-white text-xs rounded\",children:[t('image'),\" \",index+1]})})]},index))})}),testOutput&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-50 rounded-lg p-4 max-h-96 overflow-auto\",children:template.output_format==='markdown'?/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm max-w-none\",children:/*#__PURE__*/_jsx(ReactMarkdown,{children:testOutput})}):template.output_format==='json'?/*#__PURE__*/_jsx(\"pre\",{className:\"text-sm font-mono whitespace-pre-wrap\",children:(()=>{try{return JSON.stringify(JSON.parse(testOutput),null,2);}catch(_unused6){return testOutput;}})()}):/*#__PURE__*/_jsx(\"p\",{className:\"text-sm whitespace-pre-wrap\",children:testOutput})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center pt-4 border-t border-secondary-200\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>setShowTestPanel(false),children:t('close')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-3\",children:[(testOutput||testGeneratedImages.length>0)&&/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:()=>{setTestOutput(null);setTestGeneratedImages([]);setTestError(null);},children:t('clearOutput')}),/*#__PURE__*/_jsxs(Button,{onClick:runTest,isLoading:isTestRunning,children:[/*#__PURE__*/_jsx(PlayIcon,{className:\"w-4 h-4 mr-2\"}),t('runTest')]})]})]})]})})]});}function ChevronIcon(_ref){let{className}=_ref;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 9l-7 7-7-7\"})});}function InsertIcon(_ref2){let{className}=_ref2;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"})});}function EditIcon(_ref3){let{className}=_ref3;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"})});}function TrashIcon(_ref4){let{className}=_ref4;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"})});}function PlayIcon(_ref5){let{className}=_ref5;return/*#__PURE__*/_jsxs(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\"}),/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"})]});}function ExpandIcon(_ref6){let{className}=_ref6;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"})});}function DownloadIcon(_ref7){let{className}=_ref7;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"})});}","map":{"version":3,"names":["React","useEffect","useState","useMemo","useRef","useParams","useNavigate","api","Button","Input","TextArea","Select","Card","CardBody","CardHeader","Modal","DynamicInput","useLanguage","ReactMarkdown","jsx","_jsx","jsxs","_jsxs","SYSTEM_VARIABLES","extractInputsFromPrompt","promptTemplate","variables","matches","match","forEach","varName","replace","trim","includes","push","INPUT_TYPE_OPTIONS","value","labelKey","icon","DEFAULT_INPUT_CONFIG","type","placeholder","description","TemplateEditor","_models$find","id","navigate","t","isNew","promptTextAreaRef","template","setTemplate","name","step_name","ai_model","prompt_template","output_format","model_config","JSON","stringify","temperature","maxTokens","input_config","models","setModels","isLoading","setIsLoading","isSaving","setIsSaving","error","setError","showVariableHelp","setShowVariableHelp","expandedVariable","setExpandedVariable","showAddVariable","setShowAddVariable","newVariableName","setNewVariableName","newVariableType","setNewVariableType","editingVariableName","setEditingVariableName","editedName","setEditedName","showTestPanel","setShowTestPanel","testInputValues","setTestInputValues","testOutput","setTestOutput","testGeneratedImages","setTestGeneratedImages","isTestRunning","setIsTestRunning","testError","setTestError","loadModels","loadTemplate","parseInt","all","getAIModels","err","console","templateId","_data$steps","data","getRecipe","step","steps","message","getInputConfig","_config$variables","config","parse","_objectSpread","_unused","updateInputConfig","updates","_unused2","getConfiguredVariables","Object","keys","_unused3","addVariable","toLowerCase","allVars","Set","promptVariables","deleteVariable","_config$variables2","_unused4","renameVariable","oldName","newName","formattedName","_config$variables3","updatedPrompt","RegExp","concat","_unused5","insertVariableIntoPrompt","textarea","current","start","selectionStart","end","selectionEnd","text","variableText","newText","substring","setTimeout","focus","newCursorPos","length","setSelectionRange","openTestPanel","initialValues","allVariables","runTest","missingInputs","filter","Array","isArray","u","map","v","label","join","compiledPrompt","images","replacementValue","base64","mediaType","content","String","modelConfig","modelInfo","find","m","provider","response","testAI","undefined","success","generatedImages","handleSave","step_order","createRecipe","is_template","updateRecipe","handleDelete","window","confirm","deleteRecipe","configured","className","children","variant","onClick","PlayIcon","onChange","e","target","rows","options","available","ref","min","max","parseFloat","size","isExpanded","typeOption","o","isInPrompt","isEditing","onBlur","onKeyDown","key","stopPropagation","autoFocus","title","InsertIcon","EditIcon","TrashIcon","ChevronIcon","option","acceptedFileTypes","split","s","Boolean","minUrls","maxUrls","maxImageSize","isOpen","onClose","disabled","displayConfig","image","index","src","mimeType","alt","win","open","document","write","ExpandIcon","link","createElement","href","download","body","appendChild","click","removeChild","DownloadIcon","_unused6","_ref","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7"],"sources":["/Users/eveyhuang/Documents/novohaven-app/client/src/components/TemplateEditor/TemplateEditor.tsx"],"sourcesContent":["import React, { useEffect, useState, useMemo, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { Recipe, RecipeStep, AIModel, InputType, InputTypeConfig, TemplateInputConfig, GeneratedImage } from '../../types';\nimport api from '../../services/api';\nimport { Button, Input, TextArea, Select, Card, CardBody, CardHeader, Modal, DynamicInput } from '../common';\nimport { useLanguage } from '../../context/LanguageContext';\nimport { TranslationKey } from '../../i18n/translations';\nimport ReactMarkdown from 'react-markdown';\n\n// System variables that shouldn't be treated as user inputs\nconst SYSTEM_VARIABLES = [\n  'brand_voice', 'amazon_requirements', 'image_style_guidelines',\n  'social_media_guidelines', 'platform_requirements', 'tone_guidelines'\n];\n\n// Extract user input variables from prompt template\nfunction extractInputsFromPrompt(promptTemplate: string): string[] {\n  const variables: string[] = [];\n  const matches = promptTemplate.match(/\\{\\{([^}]+)\\}\\}/g) || [];\n  matches.forEach((match) => {\n    const varName = match.replace(/\\{\\{|\\}\\}/g, '').trim();\n    if (!varName.match(/^step_\\d+_output$/) && !SYSTEM_VARIABLES.includes(varName)) {\n      if (!variables.includes(varName)) {\n        variables.push(varName);\n      }\n    }\n  });\n  return variables;\n}\n\nconst INPUT_TYPE_OPTIONS: { value: InputType; labelKey: TranslationKey; icon: string }[] = [\n  { value: 'text', labelKey: 'inputTypeText', icon: 'üìù' },\n  { value: 'textarea', labelKey: 'inputTypeTextarea', icon: 'üìÑ' },\n  { value: 'image', labelKey: 'inputTypeImage', icon: 'üñºÔ∏è' },\n  { value: 'url_list', labelKey: 'inputTypeUrlList', icon: 'üîó' },\n  { value: 'file', labelKey: 'inputTypeFile', icon: 'üìÅ' },\n];\n\nconst DEFAULT_INPUT_CONFIG: InputTypeConfig = {\n  type: 'text',\n  placeholder: '',\n  description: '',\n};\n\nexport function TemplateEditor() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { t } = useLanguage();\n  const isNew = !id || id === 'new';\n  const promptTextAreaRef = useRef<HTMLTextAreaElement>(null);\n\n  const [template, setTemplate] = useState<{\n    name: string;\n    description: string;\n    step_name: string;\n    ai_model: string;\n    prompt_template: string;\n    output_format: 'text' | 'json' | 'markdown' | 'image';\n    model_config: string;\n    input_config: string;\n  }>({\n    name: '',\n    description: '',\n    step_name: '',\n    ai_model: 'mock',\n    prompt_template: '',\n    output_format: 'text',\n    model_config: JSON.stringify({ temperature: 0.7, maxTokens: 2000 }),\n    input_config: JSON.stringify({ variables: {} }),\n  });\n\n  const [models, setModels] = useState<AIModel[]>([]);\n  const [isLoading, setIsLoading] = useState(!isNew);\n  const [isSaving, setIsSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [showVariableHelp, setShowVariableHelp] = useState(false);\n  const [expandedVariable, setExpandedVariable] = useState<string | null>(null);\n  const [showAddVariable, setShowAddVariable] = useState(false);\n  const [newVariableName, setNewVariableName] = useState('');\n  const [newVariableType, setNewVariableType] = useState<InputType>('text');\n  const [editingVariableName, setEditingVariableName] = useState<string | null>(null);\n  const [editedName, setEditedName] = useState('');\n\n  // Test mode state\n  const [showTestPanel, setShowTestPanel] = useState(false);\n  const [testInputValues, setTestInputValues] = useState<Record<string, any>>({});\n  const [testOutput, setTestOutput] = useState<string | null>(null);\n  const [testGeneratedImages, setTestGeneratedImages] = useState<GeneratedImage[]>([]);\n  const [isTestRunning, setIsTestRunning] = useState(false);\n  const [testError, setTestError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadModels();\n    if (!isNew && id) {\n      loadTemplate(parseInt(id));\n    }\n  }, [id, isNew]);\n\n  const loadModels = async () => {\n    try {\n      const { all } = await api.getAIModels();\n      setModels(all);\n    } catch (err: any) {\n      console.error('Failed to load models:', err);\n    }\n  };\n\n  const loadTemplate = async (templateId: number) => {\n    setIsLoading(true);\n    try {\n      const data = await api.getRecipe(templateId);\n      const step = data.steps?.[0];\n      setTemplate({\n        name: data.name,\n        description: data.description || '',\n        step_name: step?.step_name || data.name,\n        ai_model: step?.ai_model || 'mock',\n        prompt_template: step?.prompt_template || '',\n        output_format: step?.output_format || 'text',\n        model_config: step?.model_config || JSON.stringify({ temperature: 0.7, maxTokens: 2000 }),\n        input_config: step?.input_config || JSON.stringify({ variables: {} }),\n      });\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Get input config for a variable\n  const getInputConfig = (varName: string): InputTypeConfig => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      return config.variables?.[varName] || { ...DEFAULT_INPUT_CONFIG };\n    } catch {\n      return { ...DEFAULT_INPUT_CONFIG };\n    }\n  };\n\n  // Update input config for a variable\n  const updateInputConfig = (varName: string, updates: Partial<InputTypeConfig>) => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      if (!config.variables) config.variables = {};\n      config.variables[varName] = { ...getInputConfig(varName), ...updates };\n      setTemplate({ ...template, input_config: JSON.stringify(config) });\n    } catch {\n      const config: TemplateInputConfig = { variables: { [varName]: { ...DEFAULT_INPUT_CONFIG, ...updates } } };\n      setTemplate({ ...template, input_config: JSON.stringify(config) });\n    }\n  };\n\n  // Get all configured variables (including those not in prompt)\n  const getConfiguredVariables = (): string[] => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      return Object.keys(config.variables || {});\n    } catch {\n      return [];\n    }\n  };\n\n  // Add a new variable\n  const addVariable = () => {\n    if (!newVariableName.trim()) return;\n    const varName = newVariableName.trim().replace(/\\s+/g, '_').toLowerCase();\n\n    // Check if variable already exists\n    const allVars = [...new Set([...promptVariables, ...getConfiguredVariables()])];\n    if (allVars.includes(varName)) {\n      setError(t('variableAlreadyExists'));\n      return;\n    }\n\n    updateInputConfig(varName, { type: newVariableType });\n    setNewVariableName('');\n    setNewVariableType('text');\n    setShowAddVariable(false);\n    setExpandedVariable(varName);\n  };\n\n  // Delete a variable from config\n  const deleteVariable = (varName: string) => {\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      if (config.variables?.[varName]) {\n        delete config.variables[varName];\n        setTemplate({ ...template, input_config: JSON.stringify(config) });\n      }\n    } catch {\n      // Ignore\n    }\n    if (expandedVariable === varName) {\n      setExpandedVariable(null);\n    }\n  };\n\n  // Rename a variable\n  const renameVariable = (oldName: string, newName: string) => {\n    if (!newName.trim() || oldName === newName) {\n      setEditingVariableName(null);\n      return;\n    }\n\n    const formattedName = newName.trim().replace(/\\s+/g, '_').toLowerCase();\n\n    // Update config\n    try {\n      const config: TemplateInputConfig = JSON.parse(template.input_config);\n      if (config.variables?.[oldName]) {\n        config.variables[formattedName] = config.variables[oldName];\n        delete config.variables[oldName];\n      }\n\n      // Update prompt template - replace old variable with new one\n      const updatedPrompt = template.prompt_template.replace(\n        new RegExp(`\\\\{\\\\{\\\\s*${oldName}\\\\s*\\\\}\\\\}`, 'g'),\n        `{{${formattedName}}}`\n      );\n\n      setTemplate({\n        ...template,\n        input_config: JSON.stringify(config),\n        prompt_template: updatedPrompt\n      });\n    } catch {\n      // Ignore\n    }\n\n    setEditingVariableName(null);\n    if (expandedVariable === oldName) {\n      setExpandedVariable(formattedName);\n    }\n  };\n\n  // Insert variable into prompt at cursor position\n  const insertVariableIntoPrompt = (varName: string) => {\n    const textarea = promptTextAreaRef.current;\n    if (!textarea) return;\n\n    const start = textarea.selectionStart;\n    const end = textarea.selectionEnd;\n    const text = template.prompt_template;\n    const variableText = `{{${varName}}}`;\n\n    const newText = text.substring(0, start) + variableText + text.substring(end);\n    setTemplate({ ...template, prompt_template: newText });\n\n    // Focus and set cursor position after the inserted variable\n    setTimeout(() => {\n      textarea.focus();\n      const newCursorPos = start + variableText.length;\n      textarea.setSelectionRange(newCursorPos, newCursorPos);\n    }, 0);\n  };\n\n  // Initialize test input values when test panel opens\n  const openTestPanel = () => {\n    const initialValues: Record<string, any> = {};\n    allVariables.forEach((varName) => {\n      const config = getInputConfig(varName);\n      if (config.type === 'url_list') {\n        initialValues[varName] = [''];\n      } else if (config.type === 'image' || config.type === 'file') {\n        initialValues[varName] = null;\n      } else {\n        initialValues[varName] = '';\n      }\n    });\n    setTestInputValues(initialValues);\n    setTestOutput(null);\n    setTestGeneratedImages([]);\n    setTestError(null);\n    setShowTestPanel(true);\n  };\n\n  // Run test execution\n  const runTest = async () => {\n    // Validate required inputs\n    const missingInputs = allVariables.filter((varName) => {\n      const value = testInputValues[varName];\n      const config = getInputConfig(varName);\n      if (config.type === 'image' || config.type === 'file') {\n        return !value;\n      } else if (config.type === 'url_list') {\n        return !Array.isArray(value) || value.filter((u: string) => u.trim()).length === 0;\n      }\n      return !value || (typeof value === 'string' && !value.trim());\n    });\n\n    if (missingInputs.length > 0) {\n      setTestError(`${t('fillRequiredFields')}: ${missingInputs.map(v => getInputConfig(v).label || v).join(', ')}`);\n      return;\n    }\n\n    if (!template.prompt_template.trim()) {\n      setTestError(t('promptTemplateRequired'));\n      return;\n    }\n\n    setIsTestRunning(true);\n    setTestError(null);\n    setTestOutput(null);\n    setTestGeneratedImages([]);\n\n    try {\n      // Compile prompt by replacing variables\n      let compiledPrompt = template.prompt_template;\n      const images: Array<{ base64: string; mediaType: string }> = [];\n\n      for (const varName of allVariables) {\n        const value = testInputValues[varName];\n        const config = getInputConfig(varName);\n        let replacementValue = '';\n\n        if (config.type === 'image' && value?.base64) {\n          // Extract image for vision models\n          images.push({\n            base64: value.base64,\n            mediaType: value.type || 'image/jpeg',\n          });\n          replacementValue = `[See attached image: ${varName}]`;\n        } else if (config.type === 'file' && value?.content) {\n          replacementValue = value.content;\n        } else if (config.type === 'url_list' && Array.isArray(value)) {\n          replacementValue = value.filter((u: string) => u.trim()).join('\\n');\n        } else {\n          replacementValue = String(value || '');\n        }\n\n        compiledPrompt = compiledPrompt.replace(\n          new RegExp(`\\\\{\\\\{\\\\s*${varName}\\\\s*\\\\}\\\\}`, 'g'),\n          replacementValue\n        );\n      }\n\n      // Get model config\n      const modelConfig = JSON.parse(template.model_config || '{}');\n      const modelInfo = models.find(m => m.id === template.ai_model);\n      const provider = modelInfo?.provider || 'mock';\n\n      // Call AI test endpoint\n      const response = await api.testAI(\n        provider,\n        template.ai_model,\n        compiledPrompt,\n        {\n          temperature: modelConfig.temperature,\n          maxTokens: modelConfig.maxTokens,\n        },\n        images.length > 0 ? images : undefined\n      );\n\n      if (response.success) {\n        setTestOutput(response.content);\n        if (response.generatedImages && response.generatedImages.length > 0) {\n          setTestGeneratedImages(response.generatedImages);\n        }\n      } else {\n        setTestError(response.error || t('testFailed'));\n      }\n    } catch (err: any) {\n      setTestError(err.message || t('testFailed'));\n    } finally {\n      setIsTestRunning(false);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!template.name) {\n      setError(t('templateNameRequired'));\n      return;\n    }\n    if (!template.prompt_template) {\n      setError(t('promptTemplateRequired'));\n      return;\n    }\n\n    setIsSaving(true);\n    setError(null);\n    try {\n      const step = {\n        step_order: 1,\n        step_name: template.step_name || template.name,\n        ai_model: template.ai_model,\n        prompt_template: template.prompt_template,\n        output_format: template.output_format,\n        model_config: template.model_config,\n        input_config: template.input_config,\n      };\n\n      if (isNew) {\n        await api.createRecipe({\n          name: template.name,\n          description: template.description,\n          steps: [step],\n          is_template: true,\n        });\n        navigate('/');\n      } else if (id) {\n        await api.updateRecipe(parseInt(id), {\n          name: template.name,\n          description: template.description,\n          steps: [step],\n          is_template: true,\n        });\n        navigate('/');\n      }\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!id || !window.confirm(t('confirmDeleteTemplate'))) return;\n    try {\n      await api.deleteRecipe(parseInt(id));\n      navigate('/');\n    } catch (err: any) {\n      setError(err.message);\n    }\n  };\n\n  // Variables extracted from prompt\n  const promptVariables = useMemo(() => extractInputsFromPrompt(template.prompt_template), [template.prompt_template]);\n\n  // All variables (from prompt + configured)\n  const allVariables = useMemo(() => {\n    const configured = getConfiguredVariables();\n    return [...new Set([...promptVariables, ...configured])];\n  }, [promptVariables, template.input_config]);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6 max-w-4xl mx-auto\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-secondary-900\">\n            {isNew ? t('createNewTemplate') : t('editTemplate')}\n          </h1>\n          <p className=\"text-secondary-600 mt-1\">\n            {t('templateEditorSubtitle')}\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-3\">\n          <Button variant=\"ghost\" onClick={() => navigate('/')}>\n            {t('cancel')}\n          </Button>\n          {!isNew && (\n            <Button variant=\"ghost\" onClick={handleDelete} className=\"text-red-600 hover:text-red-700\">\n              {t('delete')}\n            </Button>\n          )}\n          <Button variant=\"secondary\" onClick={openTestPanel}>\n            <PlayIcon className=\"w-4 h-4 mr-2\" />\n            {t('testTemplate')}\n          </Button>\n          <Button onClick={handleSave} isLoading={isSaving}>\n            {isNew ? t('createTemplate') : t('saveChanges')}\n          </Button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\">\n          {error}\n        </div>\n      )}\n\n      {/* Template Info */}\n      <Card>\n        <CardHeader>\n          <h2 className=\"font-semibold text-secondary-900\">{t('templateDetails')}</h2>\n        </CardHeader>\n        <CardBody className=\"space-y-4\">\n          <Input\n            label={t('templateName')}\n            value={template.name}\n            onChange={(e) => setTemplate({ ...template, name: e.target.value })}\n            placeholder={t('templateNamePlaceholder')}\n          />\n          <TextArea\n            label={t('description')}\n            value={template.description}\n            onChange={(e) => setTemplate({ ...template, description: e.target.value })}\n            placeholder={t('templateDescriptionPlaceholder')}\n            rows={2}\n          />\n        </CardBody>\n      </Card>\n\n      {/* AI Configuration */}\n      <Card>\n        <CardHeader>\n          <h2 className=\"font-semibold text-secondary-900\">{t('aiConfiguration')}</h2>\n        </CardHeader>\n        <CardBody className=\"space-y-4\">\n          <Select\n            label={t('aiModel')}\n            value={template.ai_model}\n            onChange={(e) => setTemplate({ ...template, ai_model: e.target.value })}\n            options={models.map(m => ({\n              value: m.id,\n              label: `${m.name}${m.available ? '' : ` (${t('notConfigured')})`}`,\n            }))}\n          />\n\n          <div>\n            <div className=\"flex items-center justify-between mb-1\">\n              <label className=\"block text-sm font-medium text-secondary-700\">\n                {t('promptTemplate')}\n              </label>\n              <button\n                onClick={() => setShowVariableHelp(true)}\n                className=\"text-sm text-primary-600 hover:text-primary-700\"\n              >\n                {t('variableHelp')}\n              </button>\n            </div>\n            <textarea\n              ref={promptTextAreaRef}\n              value={template.prompt_template}\n              onChange={(e) => setTemplate({ ...template, prompt_template: e.target.value })}\n              placeholder={t('promptTemplatePlaceholder')}\n              rows={12}\n              className=\"w-full px-3 py-2 border border-secondary-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent font-mono text-sm\"\n            />\n            <p className=\"mt-1 text-sm text-secondary-500\">\n              {t('templatePromptHelp')}\n            </p>\n          </div>\n\n          <Select\n            label={t('outputFormat')}\n            value={template.output_format}\n            onChange={(e) => setTemplate({ ...template, output_format: e.target.value as any })}\n            options={[\n              { value: 'text', label: t('plainText') },\n              { value: 'markdown', label: t('markdown') },\n              { value: 'json', label: t('json') },\n              { value: 'image', label: t('generatedImages') },\n            ]}\n          />\n\n          {/* Model Settings */}\n          <div className=\"border-t border-secondary-200 pt-4\">\n            <h3 className=\"text-sm font-medium text-secondary-700 mb-3\">{t('modelSettings')}</h3>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <Input\n                label={t('temperature')}\n                type=\"number\"\n                min=\"0\"\n                max=\"2\"\n                step=\"0.1\"\n                value={JSON.parse(template.model_config || '{}').temperature || 0.7}\n                onChange={(e) => {\n                  const config = JSON.parse(template.model_config || '{}');\n                  config.temperature = parseFloat(e.target.value);\n                  setTemplate({ ...template, model_config: JSON.stringify(config) });\n                }}\n              />\n              <Input\n                label={t('maxTokens')}\n                type=\"number\"\n                min=\"100\"\n                max=\"100000\"\n                step=\"100\"\n                value={JSON.parse(template.model_config || '{}').maxTokens || 2000}\n                onChange={(e) => {\n                  const config = JSON.parse(template.model_config || '{}');\n                  config.maxTokens = parseInt(e.target.value);\n                  setTemplate({ ...template, model_config: JSON.stringify(config) });\n                }}\n              />\n            </div>\n          </div>\n        </CardBody>\n      </Card>\n\n      {/* Input Variables */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"font-semibold text-secondary-900\">{t('inputVariables')}</h2>\n              <p className=\"text-sm text-secondary-500 mt-1\">{t('inputVariablesDesc')}</p>\n            </div>\n            <Button size=\"sm\" onClick={() => setShowAddVariable(true)}>\n              + {t('addVariable')}\n            </Button>\n          </div>\n        </CardHeader>\n        <CardBody>\n          {allVariables.length === 0 ? (\n            <div className=\"text-center py-8 text-secondary-500\">\n              <div className=\"text-4xl mb-2\">üì•</div>\n              <p>{t('noVariablesYet')}</p>\n              <p className=\"text-sm mt-1\">{t('addVariablesHint')}</p>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              {allVariables.map((varName) => {\n                const config = getInputConfig(varName);\n                const isExpanded = expandedVariable === varName;\n                const typeOption = INPUT_TYPE_OPTIONS.find(o => o.value === config.type);\n                const isInPrompt = promptVariables.includes(varName);\n                const isEditing = editingVariableName === varName;\n\n                return (\n                  <div\n                    key={varName}\n                    className=\"border border-secondary-200 rounded-lg overflow-hidden\"\n                  >\n                    <div\n                      className=\"flex items-center justify-between px-4 py-3 bg-secondary-50\"\n                    >\n                      <div\n                        className=\"flex items-center gap-3 flex-1 cursor-pointer\"\n                        onClick={() => setExpandedVariable(isExpanded ? null : varName)}\n                      >\n                        <span className=\"text-lg\">{typeOption?.icon || 'üìù'}</span>\n                        <div className=\"flex items-center gap-2\">\n                          {isEditing ? (\n                            <input\n                              type=\"text\"\n                              value={editedName}\n                              onChange={(e) => setEditedName(e.target.value)}\n                              onBlur={() => renameVariable(varName, editedName)}\n                              onKeyDown={(e) => {\n                                if (e.key === 'Enter') renameVariable(varName, editedName);\n                                if (e.key === 'Escape') setEditingVariableName(null);\n                              }}\n                              onClick={(e) => e.stopPropagation()}\n                              className=\"px-2 py-1 border border-primary-300 rounded text-sm font-mono focus:outline-none focus:ring-2 focus:ring-primary-500\"\n                              autoFocus\n                            />\n                          ) : (\n                            <code className=\"font-semibold text-secondary-900\">{varName}</code>\n                          )}\n                          <span className=\"text-sm text-secondary-500\">\n                            {typeOption ? t(typeOption.labelKey) : t('inputTypeText')}\n                          </span>\n                          {isInPrompt ? (\n                            <span className=\"px-2 py-0.5 text-xs bg-green-100 text-green-700 rounded\">\n                              {t('inPrompt')}\n                            </span>\n                          ) : (\n                            <span className=\"px-2 py-0.5 text-xs bg-yellow-100 text-yellow-700 rounded\">\n                              {t('notInPrompt')}\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                      <div className=\"flex items-center gap-1\">\n                        {!isInPrompt && (\n                          <button\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              insertVariableIntoPrompt(varName);\n                            }}\n                            className=\"p-1.5 text-primary-600 hover:bg-primary-50 rounded\"\n                            title={t('insertIntoPrompt')}\n                          >\n                            <InsertIcon className=\"w-4 h-4\" />\n                          </button>\n                        )}\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            setEditedName(varName);\n                            setEditingVariableName(varName);\n                          }}\n                          className=\"p-1.5 text-secondary-500 hover:bg-secondary-100 rounded\"\n                          title={t('rename')}\n                        >\n                          <EditIcon className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            if (isInPrompt) {\n                              if (window.confirm(t('confirmDeleteVariableInPrompt'))) {\n                                deleteVariable(varName);\n                              }\n                            } else {\n                              deleteVariable(varName);\n                            }\n                          }}\n                          className=\"p-1.5 text-red-500 hover:bg-red-50 rounded\"\n                          title={t('delete')}\n                        >\n                          <TrashIcon className=\"w-4 h-4\" />\n                        </button>\n                        <button\n                          onClick={() => setExpandedVariable(isExpanded ? null : varName)}\n                          className=\"p-1.5 text-secondary-400 hover:bg-secondary-100 rounded\"\n                        >\n                          <ChevronIcon className={`w-5 h-5 transition-transform ${isExpanded ? 'rotate-180' : ''}`} />\n                        </button>\n                      </div>\n                    </div>\n\n                    {isExpanded && (\n                      <div className=\"px-4 py-4 space-y-4 border-t border-secondary-200\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-secondary-700 mb-2\">\n                            {t('inputType')}\n                          </label>\n                          <div className=\"grid grid-cols-5 gap-2\">\n                            {INPUT_TYPE_OPTIONS.map((option) => (\n                              <button\n                                key={option.value}\n                                onClick={() => updateInputConfig(varName, { type: option.value })}\n                                className={`flex flex-col items-center p-3 rounded-lg border-2 transition-colors ${\n                                  config.type === option.value\n                                    ? 'border-primary-500 bg-primary-50'\n                                    : 'border-secondary-200 hover:border-secondary-300'\n                                }`}\n                              >\n                                <span className=\"text-2xl mb-1\">{option.icon}</span>\n                                <span className=\"text-xs text-secondary-700\">{t(option.labelKey)}</span>\n                              </button>\n                            ))}\n                          </div>\n                        </div>\n\n                        <Input\n                          label={t('fieldLabel')}\n                          value={config.label || ''}\n                          onChange={(e) => updateInputConfig(varName, { label: e.target.value })}\n                          placeholder={varName}\n                        />\n\n                        <Input\n                          label={t('placeholderText')}\n                          value={config.placeholder || ''}\n                          onChange={(e) => updateInputConfig(varName, { placeholder: e.target.value })}\n                          placeholder={t('placeholderExample')}\n                        />\n\n                        <TextArea\n                          label={t('helpText')}\n                          value={config.description || ''}\n                          onChange={(e) => updateInputConfig(varName, { description: e.target.value })}\n                          placeholder={t('helpTextExample')}\n                          rows={2}\n                        />\n\n                        {/* Type-specific options */}\n                        {config.type === 'file' && (\n                          <Input\n                            label={t('acceptedFileTypes')}\n                            value={(config.acceptedFileTypes || []).join(', ')}\n                            onChange={(e) => updateInputConfig(varName, {\n                              acceptedFileTypes: e.target.value.split(',').map(s => s.trim()).filter(Boolean)\n                            })}\n                            placeholder=\".csv, .xlsx, .json\"\n                          />\n                        )}\n\n                        {config.type === 'url_list' && (\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            <Input\n                              label={t('minUrls')}\n                              type=\"number\"\n                              min=\"1\"\n                              value={config.minUrls || 1}\n                              onChange={(e) => updateInputConfig(varName, { minUrls: parseInt(e.target.value) })}\n                            />\n                            <Input\n                              label={t('maxUrls')}\n                              type=\"number\"\n                              min=\"1\"\n                              value={config.maxUrls || 10}\n                              onChange={(e) => updateInputConfig(varName, { maxUrls: parseInt(e.target.value) })}\n                            />\n                          </div>\n                        )}\n\n                        {config.type === 'image' && (\n                          <Input\n                            label={t('maxImageSizeMB')}\n                            type=\"number\"\n                            min=\"1\"\n                            max=\"50\"\n                            value={config.maxImageSize || 10}\n                            onChange={(e) => updateInputConfig(varName, { maxImageSize: parseInt(e.target.value) })}\n                          />\n                        )}\n                      </div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          )}\n        </CardBody>\n      </Card>\n\n      {/* Add Variable Modal */}\n      <Modal\n        isOpen={showAddVariable}\n        onClose={() => {\n          setShowAddVariable(false);\n          setNewVariableName('');\n          setNewVariableType('text');\n        }}\n        title={t('addNewVariable')}\n      >\n        <div className=\"space-y-4\">\n          <Input\n            label={t('variableName')}\n            value={newVariableName}\n            onChange={(e) => setNewVariableName(e.target.value)}\n            placeholder={t('variableNamePlaceholder')}\n          />\n          <p className=\"text-xs text-secondary-500 -mt-2\">\n            {t('variableNameHint')}\n          </p>\n\n          <div>\n            <label className=\"block text-sm font-medium text-secondary-700 mb-2\">\n              {t('inputType')}\n            </label>\n            <div className=\"grid grid-cols-5 gap-2\">\n              {INPUT_TYPE_OPTIONS.map((option) => (\n                <button\n                  key={option.value}\n                  onClick={() => setNewVariableType(option.value)}\n                  className={`flex flex-col items-center p-3 rounded-lg border-2 transition-colors ${\n                    newVariableType === option.value\n                      ? 'border-primary-500 bg-primary-50'\n                      : 'border-secondary-200 hover:border-secondary-300'\n                  }`}\n                >\n                  <span className=\"text-2xl mb-1\">{option.icon}</span>\n                  <span className=\"text-xs text-secondary-700\">{t(option.labelKey)}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"flex justify-end gap-3 pt-4\">\n            <Button variant=\"ghost\" onClick={() => setShowAddVariable(false)}>\n              {t('cancel')}\n            </Button>\n            <Button onClick={addVariable} disabled={!newVariableName.trim()}>\n              {t('addVariable')}\n            </Button>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Variable Help Modal */}\n      <Modal\n        isOpen={showVariableHelp}\n        onClose={() => setShowVariableHelp(false)}\n        title={t('variableReference')}\n        size=\"lg\"\n      >\n        <div className=\"space-y-4\">\n          <div>\n            <h3 className=\"font-semibold text-secondary-900\">{t('supportedInputTypes')}</h3>\n            <div className=\"mt-2 space-y-2\">\n              {INPUT_TYPE_OPTIONS.map((option) => (\n                <div key={option.value} className=\"flex items-center gap-2 text-sm\">\n                  <span>{option.icon}</span>\n                  <span className=\"font-medium\">{t(option.labelKey)}</span>\n                  <span className=\"text-secondary-500\">- {t(`inputType_${option.value}_desc`)}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n          <div>\n            <h3 className=\"font-semibold text-secondary-900\">{t('variableSyntax')}</h3>\n            <p className=\"text-sm text-secondary-600 mt-1\">\n              <code className=\"bg-secondary-100 px-1 rounded\">{'{{variable_name}}'}</code> {t('templateVariableDesc')}\n            </p>\n            <div className=\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\">\n              {'{{product_image}}'} - {t('forImageUpload')}<br/>\n              {'{{product_urls}}'} - {t('forUrlList')}<br/>\n              {'{{sales_data}}'} - {t('forFileUpload')}\n            </div>\n          </div>\n          <div>\n            <h3 className=\"font-semibold text-secondary-900\">{t('companyStandards')}</h3>\n            <p className=\"text-sm text-secondary-600 mt-1\">\n              {t('companyStandardsDesc')}\n            </p>\n            <div className=\"mt-2 bg-secondary-50 p-3 rounded text-sm font-mono\">\n              {'{{brand_voice}}'}<br/>\n              {'{{amazon_requirements}}'}<br/>\n              {'{{image_style_guidelines}}'}\n            </div>\n          </div>\n        </div>\n      </Modal>\n\n      {/* Test Template Panel */}\n      <Modal\n        isOpen={showTestPanel}\n        onClose={() => setShowTestPanel(false)}\n        title={t('testTemplate')}\n        size=\"xl\"\n      >\n        <div className=\"space-y-6\">\n          {/* Template Info */}\n          <div className=\"bg-secondary-50 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <h3 className=\"font-medium text-secondary-900\">{template.name || t('untitledTemplate')}</h3>\n                <p className=\"text-sm text-secondary-500 mt-1\">\n                  {t('model')}: {models.find(m => m.id === template.ai_model)?.name || template.ai_model}\n                </p>\n              </div>\n              <span className=\"px-2 py-1 text-xs font-medium bg-primary-100 text-primary-700 rounded\">\n                {template.output_format}\n              </span>\n            </div>\n          </div>\n\n          {/* Input Fields */}\n          {allVariables.length > 0 ? (\n            <div>\n              <h3 className=\"font-medium text-secondary-900 mb-3\">{t('inputValues')}</h3>\n              <div className=\"space-y-4\">\n                {allVariables.map((varName) => {\n                  const config = getInputConfig(varName);\n                  const displayConfig = {\n                    ...config,\n                    label: config.label || varName,\n                  };\n\n                  return (\n                    <DynamicInput\n                      key={varName}\n                      name={varName}\n                      config={displayConfig}\n                      value={testInputValues[varName]}\n                      onChange={(value) =>\n                        setTestInputValues({ ...testInputValues, [varName]: value })\n                      }\n                      t={t}\n                    />\n                  );\n                })}\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-4 text-secondary-500\">\n              <p>{t('noInputVariables')}</p>\n            </div>\n          )}\n\n          {/* Error Display */}\n          {testError && (\n            <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\">\n              {testError}\n            </div>\n          )}\n\n          {/* Output Display */}\n          {(testOutput || testGeneratedImages.length > 0) && (\n            <div>\n              <h3 className=\"font-medium text-secondary-900 mb-3\">{t('output')}</h3>\n\n              {/* Generated Images Display */}\n              {testGeneratedImages.length > 0 && (\n                <div className=\"mb-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    {testGeneratedImages.map((image, index) => (\n                      <div key={index} className=\"relative group\">\n                        <div className=\"bg-secondary-100 rounded-lg overflow-hidden\">\n                          <img\n                            src={`data:${image.mimeType};base64,${image.base64}`}\n                            alt={`Generated image ${index + 1}`}\n                            className=\"w-full h-auto object-contain\"\n                          />\n                        </div>\n                        <div className=\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                          <button\n                            onClick={() => {\n                              // Open image in new tab for full size view\n                              const win = window.open();\n                              if (win) {\n                                win.document.write(`\n                                  <html>\n                                    <head><title>Generated Image ${index + 1}</title></head>\n                                    <body style=\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\">\n                                      <img src=\"data:${image.mimeType};base64,${image.base64}\" style=\"max-width:100%;max-height:100vh;\" />\n                                    </body>\n                                  </html>\n                                `);\n                              }\n                            }}\n                            className=\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm\"\n                            title={t('viewFullSize')}\n                          >\n                            <ExpandIcon className=\"w-4 h-4\" />\n                          </button>\n                          <button\n                            onClick={() => {\n                              // Download image\n                              const link = document.createElement('a');\n                              link.href = `data:${image.mimeType};base64,${image.base64}`;\n                              link.download = `generated-image-${index + 1}.${image.mimeType.split('/')[1] || 'png'}`;\n                              document.body.appendChild(link);\n                              link.click();\n                              document.body.removeChild(link);\n                            }}\n                            className=\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm\"\n                            title={t('downloadImage')}\n                          >\n                            <DownloadIcon className=\"w-4 h-4\" />\n                          </button>\n                        </div>\n                        <div className=\"absolute top-2 left-2\">\n                          <span className=\"px-2 py-1 bg-black/50 text-white text-xs rounded\">\n                            {t('image')} {index + 1}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Text Output Display */}\n              {testOutput && (\n                <div className=\"bg-secondary-50 rounded-lg p-4 max-h-96 overflow-auto\">\n                  {template.output_format === 'markdown' ? (\n                    <div className=\"prose prose-sm max-w-none\">\n                      <ReactMarkdown>{testOutput}</ReactMarkdown>\n                    </div>\n                  ) : template.output_format === 'json' ? (\n                    <pre className=\"text-sm font-mono whitespace-pre-wrap\">\n                      {(() => {\n                        try {\n                          return JSON.stringify(JSON.parse(testOutput), null, 2);\n                        } catch {\n                          return testOutput;\n                        }\n                      })()}\n                    </pre>\n                  ) : (\n                    <p className=\"text-sm whitespace-pre-wrap\">{testOutput}</p>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Actions */}\n          <div className=\"flex justify-between items-center pt-4 border-t border-secondary-200\">\n            <Button variant=\"ghost\" onClick={() => setShowTestPanel(false)}>\n              {t('close')}\n            </Button>\n            <div className=\"flex gap-3\">\n              {(testOutput || testGeneratedImages.length > 0) && (\n                <Button\n                  variant=\"secondary\"\n                  onClick={() => {\n                    setTestOutput(null);\n                    setTestGeneratedImages([]);\n                    setTestError(null);\n                  }}\n                >\n                  {t('clearOutput')}\n                </Button>\n              )}\n              <Button onClick={runTest} isLoading={isTestRunning}>\n                <PlayIcon className=\"w-4 h-4 mr-2\" />\n                {t('runTest')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\nfunction ChevronIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n    </svg>\n  );\n}\n\nfunction InsertIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\" />\n    </svg>\n  );\n}\n\nfunction EditIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\" />\n    </svg>\n  );\n}\n\nfunction TrashIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n    </svg>\n  );\n}\n\nfunction PlayIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z\" />\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n    </svg>\n  );\n}\n\nfunction ExpandIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\" />\n    </svg>\n  );\n}\n\nfunction DownloadIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n    </svg>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}