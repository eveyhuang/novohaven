{"ast":null,"code":"import React,{useEffect,useState,useMemo,useRef}from'react';import{useParams,useNavigate}from'react-router-dom';import ReactMarkdown from'react-markdown';import api from'../../services/api';import{Button,Card,CardBody,CardHeader,Modal,TextArea,TranslatedText}from'../common';import{useLanguage}from'../../context/LanguageContext';import{ReviewAnalysisDisplay}from'../ReviewAnalysis';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function ExecutionView(){var _execution$recipe,_execution$step_execu,_selectedStep$output;const{id}=useParams();const navigate=useNavigate();const{t}=useLanguage();const[execution,setExecution]=useState(null);const[isLoading,setIsLoading]=useState(true);const[actionLoading,setActionLoading]=useState(null);const[error,setError]=useState(null);const[selectedStep,setSelectedStep]=useState(null);const[showPromptModal,setShowPromptModal]=useState(false);const[editedPrompt,setEditedPrompt]=useState('');const[autoRefresh,setAutoRefresh]=useState(true);const pollingRef=useRef(null);useEffect(()=>{if(id){loadExecution(parseInt(id));}},[id]);// Auto-refresh polling for in-progress executions\nuseEffect(()=>{if(!execution||!autoRefresh){if(pollingRef.current){clearInterval(pollingRef.current);pollingRef.current=null;}return;}// Only poll if execution is running or pending\nconst shouldPoll=['running','pending'].includes(execution.status);if(!shouldPoll){if(pollingRef.current){clearInterval(pollingRef.current);pollingRef.current=null;}return;}// Set up polling every 3 seconds\npollingRef.current=setInterval(async()=>{try{var _data$step_executions,_data$step_executions2;const data=await api.getExecution(parseInt(id));setExecution(data);// Update selected step if needed\nconst currentStep=(_data$step_executions=data.step_executions)===null||_data$step_executions===void 0?void 0:_data$step_executions.find(se=>se.status==='awaiting_review');if(currentStep&&(!selectedStep||selectedStep.id!==currentStep.id)){setSelectedStep(currentStep);}else if((_data$step_executions2=data.step_executions)!==null&&_data$step_executions2!==void 0&&_data$step_executions2.length&&!currentStep){const lastStep=data.step_executions[data.step_executions.length-1];if(!selectedStep||selectedStep.id!==lastStep.id||selectedStep.status!==lastStep.status){setSelectedStep(lastStep);}}}catch(err){console.error('Error polling execution:',err);}},3000);return()=>{if(pollingRef.current){clearInterval(pollingRef.current);}};},[execution===null||execution===void 0?void 0:execution.status,autoRefresh,id]);const loadExecution=async executionId=>{setIsLoading(true);try{var _data$step_executions3,_data$step_executions4;const data=await api.getExecution(executionId);setExecution(data);// Auto-select the current step being reviewed\nconst reviewStep=(_data$step_executions3=data.step_executions)===null||_data$step_executions3===void 0?void 0:_data$step_executions3.find(se=>se.status==='awaiting_review');if(reviewStep){setSelectedStep(reviewStep);}else if((_data$step_executions4=data.step_executions)!==null&&_data$step_executions4!==void 0&&_data$step_executions4.length){setSelectedStep(data.step_executions[data.step_executions.length-1]);}}catch(err){setError(err.message);}finally{setIsLoading(false);}};const handleApprove=async stepExecution=>{if(!execution)return;setActionLoading(\"approve-\".concat(stepExecution.id));try{await api.approveStep(execution.id,stepExecution.id);await loadExecution(execution.id);}catch(err){setError(err.message);}finally{setActionLoading(null);}};const handleReject=async stepExecution=>{if(!execution)return;setActionLoading(\"reject-\".concat(stepExecution.id));try{await api.rejectStep(execution.id,stepExecution.id);await loadExecution(execution.id);}catch(err){setError(err.message);}finally{setActionLoading(null);}};const handleRetry=async()=>{if(!execution||!selectedStep)return;setActionLoading(\"retry-\".concat(selectedStep.id));setShowPromptModal(false);try{await api.retryStep(execution.id,selectedStep.id,editedPrompt||undefined);await loadExecution(execution.id);}catch(err){setError(err.message);}finally{setActionLoading(null);}};const openPromptEditor=step=>{setSelectedStep(step);setEditedPrompt(step.prompt_used||'');setShowPromptModal(true);};if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"})});}if(!execution){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-600\",children:\"Execution not found\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>navigate('/executions'),className:\"mt-4\",children:\"View All Executions\"})]});}const statusColors={pending:'bg-secondary-100 text-secondary-700',running:'bg-blue-100 text-blue-700',paused:'bg-yellow-100 text-yellow-700',completed:'bg-green-100 text-green-700',failed:'bg-red-100 text-red-700',awaiting_review:'bg-purple-100 text-purple-700'};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-secondary-900\",children:/*#__PURE__*/_jsx(TranslatedText,{text:((_execution$recipe=execution.recipe)===null||_execution$recipe===void 0?void 0:_execution$recipe.name)||\"Execution #\".concat(execution.id)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mt-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 text-sm font-medium rounded-full \".concat(statusColors[execution.status]),children:execution.status}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-secondary-500\",children:[\"Step \",execution.current_step,\" of \",execution.total_steps]}),['running','pending'].includes(execution.status)&&/*#__PURE__*/_jsxs(\"label\",{className:\"flex items-center space-x-2 text-sm text-secondary-600\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:autoRefresh,onChange:e=>setAutoRefresh(e.target.checked),className:\"rounded border-secondary-300 text-primary-600 focus:ring-primary-500\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Auto-refresh\"})]})]})]}),/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>navigate('/executions'),children:\"Back to Executions\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-span-1\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:\"Steps\"})}),/*#__PURE__*/_jsx(CardBody,{className:\"p-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"divide-y divide-secondary-100\",children:(_execution$step_execu=execution.step_executions)===null||_execution$step_execu===void 0?void 0:_execution$step_execu.map(step=>/*#__PURE__*/_jsx(\"div\",{className:\"p-4 cursor-pointer transition-colors \".concat((selectedStep===null||selectedStep===void 0?void 0:selectedStep.id)===step.id?'bg-primary-50':'hover:bg-secondary-50'),onClick:()=>setSelectedStep(step),children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(StepStatusIcon,{status:step.status}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-secondary-900\",children:/*#__PURE__*/_jsx(TranslatedText,{text:step.step_name||''})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-secondary-500\",children:step.ai_model_used||step.ai_model||'AI'})]})]})})},step.id))})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-span-2\",children:selectedStep?/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardHeader,{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"font-semibold text-secondary-900\",children:/*#__PURE__*/_jsx(TranslatedText,{text:selectedStep.step_name||''})}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-block mt-1 px-2 py-0.5 text-xs font-medium rounded \".concat(statusColors[selectedStep.status]),children:selectedStep.status})]}),selectedStep.status==='awaiting_review'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"ghost\",onClick:()=>openPromptEditor(selectedStep),children:\"Edit Prompt\"}),/*#__PURE__*/_jsx(Button,{size:\"sm\",variant:\"danger\",onClick:()=>handleReject(selectedStep),isLoading:actionLoading===\"reject-\".concat(selectedStep.id),children:\"Reject\"}),/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:()=>handleApprove(selectedStep),isLoading:actionLoading===\"approve-\".concat(selectedStep.id),children:\"Approve\"})]}),selectedStep.status==='failed'&&/*#__PURE__*/_jsx(Button,{size:\"sm\",onClick:()=>openPromptEditor(selectedStep),children:\"Retry\"})]}),/*#__PURE__*/_jsxs(CardBody,{children:[selectedStep.status==='pending'&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8 text-secondary-500\",children:\"This step hasn't been executed yet.\"}),selectedStep.status==='running'&&/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-500 mt-4\",children:\"Processing...\"})]}),selectedStep.status==='failed'&&selectedStep.error_message&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-red-50 text-red-700 px-4 py-3 rounded-lg mb-4\",children:selectedStep.error_message}),(selectedStep.status==='completed'||selectedStep.status==='awaiting_review')&&selectedStep.output&&/*#__PURE__*/_jsxs(\"div\",{children:[selectedStep.output.generatedImages&&selectedStep.output.generatedImages.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-sm font-medium text-secondary-700 mb-3\",children:t('generatedImages')}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-2 gap-4\",children:selectedStep.output.generatedImages.map((image,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"relative group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-secondary-100 rounded-lg overflow-hidden border border-secondary-200\",children:/*#__PURE__*/_jsx(\"img\",{src:\"data:\".concat(image.mimeType,\";base64,\").concat(image.base64),alt:\"Generated image \".concat(index+1),className:\"w-full h-auto object-contain\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{const win=window.open();if(win){win.document.write(\"\\n                                          <html>\\n                                            <head><title>Generated Image \".concat(index+1,\"</title></head>\\n                                            <body style=\\\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\\\">\\n                                              <img src=\\\"data:\").concat(image.mimeType,\";base64,\").concat(image.base64,\"\\\" style=\\\"max-width:100%;max-height:100vh;\\\" />\\n                                            </body>\\n                                          </html>\\n                                        \"));}},className:\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm flex items-center gap-1\",title:t('viewFullSize'),children:[/*#__PURE__*/_jsx(ExpandIcon,{className:\"w-4 h-4\"}),t('viewFullSize')]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{const link=document.createElement('a');link.href=\"data:\".concat(image.mimeType,\";base64,\").concat(image.base64);link.download=\"generated-image-\".concat(index+1,\".\").concat(image.mimeType.split('/')[1]||'png');document.body.appendChild(link);link.click();document.body.removeChild(link);},className:\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm flex items-center gap-1\",title:t('downloadImage'),children:[/*#__PURE__*/_jsx(DownloadIcon,{className:\"w-4 h-4\"}),t('downloadImage')]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-2 left-2\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"px-2 py-1 bg-black/50 text-white text-xs rounded\",children:[t('image'),\" \",index+1]})})]},index))})]}),selectedStep.output.content&&/*#__PURE__*/_jsx(ReviewAwareContentDisplay,{content:selectedStep.output.content,stepName:selectedStep.step_name||''})]}),((_selectedStep$output=selectedStep.output)===null||_selectedStep$output===void 0?void 0:_selectedStep$output.usage)&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 pt-4 border-t border-secondary-200 flex items-center space-x-4 text-sm text-secondary-500\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"Model: \",selectedStep.output.model]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Tokens: \",selectedStep.output.usage.promptTokens,\" in /\",selectedStep.output.usage.completionTokens,\" out\"]})]})]})]}):/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardBody,{className:\"text-center py-12\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-secondary-600\",children:\"Select a step to view details\"})})})})]}),/*#__PURE__*/_jsx(Modal,{isOpen:showPromptModal,onClose:()=>setShowPromptModal(false),title:\"Edit Prompt\",size:\"full\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(TextArea,{label:\"Prompt\",value:editedPrompt,onChange:e=>setEditedPrompt(e.target.value),rows:15,className:\"font-mono text-sm\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-3\",children:[/*#__PURE__*/_jsx(Button,{variant:\"ghost\",onClick:()=>setShowPromptModal(false),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleRetry,isLoading:actionLoading===null||actionLoading===void 0?void 0:actionLoading.startsWith('retry'),children:\"Retry with Modified Prompt\"})]})]})})]});}function StepStatusIcon(_ref){let{status}=_ref;switch(status){case'completed':return/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-green-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M5 13l4 4L19 7\"})})});case'running':return/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"})});case'awaiting_review':return/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"svg\",{className:\"w-4 h-4 text-purple-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"}),/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"})]})});case'failed':return/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 text-red-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})});default:return/*#__PURE__*/_jsx(\"div\",{className:\"w-6 h-6 rounded-full bg-secondary-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full bg-secondary-400\"})});}}function ExpandIcon(_ref2){let{className}=_ref2;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"})});}function DownloadIcon(_ref3){let{className}=_ref3;return/*#__PURE__*/_jsx(\"svg\",{className:className,fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"})});}// Component to detect and render review analysis content appropriately\nfunction ReviewAwareContentDisplay(_ref4){let{content,stepName}=_ref4;const analysisType=useMemo(()=>{const lowerName=stepName.toLowerCase();// Detect review analysis step types\nif(lowerName.includes('categorize')||lowerName.includes('categorization')){return'categorized';}if(lowerName.includes('positive')&&lowerName.includes('analy')){return'positive';}if(lowerName.includes('negative')&&lowerName.includes('analy')){return'negative';}if(lowerName.includes('summary')||lowerName.includes('executive')){return'summary';}return null;},[stepName]);// Try to detect if content is JSON\nconst isJson=useMemo(()=>{try{JSON.parse(content);return true;}catch(_unused){return false;}},[content]);// Use specialized display for review analysis steps\nif(analysisType){return/*#__PURE__*/_jsx(ReviewAnalysisDisplay,{data:content,type:analysisType});}// For JSON content, show formatted JSON with copy button\nif(isJson){return/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigator.clipboard.writeText(content),className:\"absolute top-2 right-2 px-2 py-1 text-xs bg-secondary-100 hover:bg-secondary-200 rounded text-secondary-600\",children:\"Copy JSON\"}),/*#__PURE__*/_jsx(\"pre\",{className:\"bg-secondary-50 p-4 rounded-lg overflow-x-auto text-sm font-mono\",children:JSON.stringify(JSON.parse(content),null,2)})]});}// Default: render as markdown\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"prose prose-sm max-w-none\",children:/*#__PURE__*/_jsx(ReactMarkdown,{children:content})});}","map":{"version":3,"names":["React","useEffect","useState","useMemo","useRef","useParams","useNavigate","ReactMarkdown","api","Button","Card","CardBody","CardHeader","Modal","TextArea","TranslatedText","useLanguage","ReviewAnalysisDisplay","jsx","_jsx","jsxs","_jsxs","ExecutionView","_execution$recipe","_execution$step_execu","_selectedStep$output","id","navigate","t","execution","setExecution","isLoading","setIsLoading","actionLoading","setActionLoading","error","setError","selectedStep","setSelectedStep","showPromptModal","setShowPromptModal","editedPrompt","setEditedPrompt","autoRefresh","setAutoRefresh","pollingRef","loadExecution","parseInt","current","clearInterval","shouldPoll","includes","status","setInterval","_data$step_executions","_data$step_executions2","data","getExecution","currentStep","step_executions","find","se","length","lastStep","err","console","executionId","_data$step_executions3","_data$step_executions4","reviewStep","message","handleApprove","stepExecution","concat","approveStep","handleReject","rejectStep","handleRetry","retryStep","undefined","openPromptEditor","step","prompt_used","className","children","onClick","statusColors","pending","running","paused","completed","failed","awaiting_review","text","recipe","name","current_step","total_steps","type","checked","onChange","e","target","variant","map","StepStatusIcon","step_name","ai_model_used","ai_model","size","error_message","output","generatedImages","image","index","src","mimeType","base64","alt","win","window","open","document","write","title","ExpandIcon","link","createElement","href","download","split","body","appendChild","click","removeChild","DownloadIcon","content","ReviewAwareContentDisplay","stepName","usage","model","promptTokens","completionTokens","isOpen","onClose","label","value","rows","startsWith","_ref","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_ref2","_ref3","_ref4","analysisType","lowerName","toLowerCase","isJson","JSON","parse","_unused","navigator","clipboard","writeText","stringify"],"sources":["/Users/eveyhuang/Documents/novohaven-app/client/src/components/WorkflowExecution/ExecutionView.tsx"],"sourcesContent":["import React, { useEffect, useState, useMemo, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\nimport { WorkflowExecution, StepExecution, GeneratedImage } from '../../types';\nimport api from '../../services/api';\nimport { Button, Card, CardBody, CardHeader, Modal, TextArea, TranslatedText } from '../common';\nimport { useLanguage } from '../../context/LanguageContext';\nimport { ReviewAnalysisDisplay } from '../ReviewAnalysis';\n\nexport function ExecutionView() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { t } = useLanguage();\n\n  const [execution, setExecution] = useState<WorkflowExecution | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedStep, setSelectedStep] = useState<StepExecution | null>(null);\n  const [showPromptModal, setShowPromptModal] = useState(false);\n  const [editedPrompt, setEditedPrompt] = useState('');\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const pollingRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    if (id) {\n      loadExecution(parseInt(id));\n    }\n  }, [id]);\n\n  // Auto-refresh polling for in-progress executions\n  useEffect(() => {\n    if (!execution || !autoRefresh) {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n      return;\n    }\n\n    // Only poll if execution is running or pending\n    const shouldPoll = ['running', 'pending'].includes(execution.status);\n\n    if (!shouldPoll) {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n      return;\n    }\n\n    // Set up polling every 3 seconds\n    pollingRef.current = setInterval(async () => {\n      try {\n        const data = await api.getExecution(parseInt(id!));\n        setExecution(data);\n\n        // Update selected step if needed\n        const currentStep = data.step_executions?.find(\n          (se) => se.status === 'awaiting_review'\n        );\n        if (currentStep && (!selectedStep || selectedStep.id !== currentStep.id)) {\n          setSelectedStep(currentStep);\n        } else if (data.step_executions?.length && !currentStep) {\n          const lastStep = data.step_executions[data.step_executions.length - 1];\n          if (!selectedStep || selectedStep.id !== lastStep.id || selectedStep.status !== lastStep.status) {\n            setSelectedStep(lastStep);\n          }\n        }\n      } catch (err) {\n        console.error('Error polling execution:', err);\n      }\n    }, 3000);\n\n    return () => {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n      }\n    };\n  }, [execution?.status, autoRefresh, id]);\n\n  const loadExecution = async (executionId: number) => {\n    setIsLoading(true);\n    try {\n      const data = await api.getExecution(executionId);\n      setExecution(data);\n\n      // Auto-select the current step being reviewed\n      const reviewStep = data.step_executions?.find(\n        (se) => se.status === 'awaiting_review'\n      );\n      if (reviewStep) {\n        setSelectedStep(reviewStep);\n      } else if (data.step_executions?.length) {\n        setSelectedStep(data.step_executions[data.step_executions.length - 1]);\n      }\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleApprove = async (stepExecution: StepExecution) => {\n    if (!execution) return;\n    setActionLoading(`approve-${stepExecution.id}`);\n    try {\n      await api.approveStep(execution.id, stepExecution.id);\n      await loadExecution(execution.id);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleReject = async (stepExecution: StepExecution) => {\n    if (!execution) return;\n    setActionLoading(`reject-${stepExecution.id}`);\n    try {\n      await api.rejectStep(execution.id, stepExecution.id);\n      await loadExecution(execution.id);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleRetry = async () => {\n    if (!execution || !selectedStep) return;\n    setActionLoading(`retry-${selectedStep.id}`);\n    setShowPromptModal(false);\n    try {\n      await api.retryStep(\n        execution.id,\n        selectedStep.id,\n        editedPrompt || undefined\n      );\n      await loadExecution(execution.id);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const openPromptEditor = (step: StepExecution) => {\n    setSelectedStep(step);\n    setEditedPrompt(step.prompt_used || '');\n    setShowPromptModal(true);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  if (!execution) {\n    return (\n      <div className=\"text-center py-12\">\n        <p className=\"text-secondary-600\">Execution not found</p>\n        <Button onClick={() => navigate('/executions')} className=\"mt-4\">\n          View All Executions\n        </Button>\n      </div>\n    );\n  }\n\n  const statusColors: Record<string, string> = {\n    pending: 'bg-secondary-100 text-secondary-700',\n    running: 'bg-blue-100 text-blue-700',\n    paused: 'bg-yellow-100 text-yellow-700',\n    completed: 'bg-green-100 text-green-700',\n    failed: 'bg-red-100 text-red-700',\n    awaiting_review: 'bg-purple-100 text-purple-700',\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-secondary-900\">\n            <TranslatedText text={execution.recipe?.name || `Execution #${execution.id}`} />\n          </h1>\n          <div className=\"flex items-center space-x-3 mt-2\">\n            <span className={`px-3 py-1 text-sm font-medium rounded-full ${statusColors[execution.status]}`}>\n              {execution.status}\n            </span>\n            <span className=\"text-secondary-500\">\n              Step {execution.current_step} of {execution.total_steps}\n            </span>\n            {['running', 'pending'].includes(execution.status) && (\n              <label className=\"flex items-center space-x-2 text-sm text-secondary-600\">\n                <input\n                  type=\"checkbox\"\n                  checked={autoRefresh}\n                  onChange={(e) => setAutoRefresh(e.target.checked)}\n                  className=\"rounded border-secondary-300 text-primary-600 focus:ring-primary-500\"\n                />\n                <span>Auto-refresh</span>\n              </label>\n            )}\n          </div>\n        </div>\n        <Button variant=\"ghost\" onClick={() => navigate('/executions')}>\n          Back to Executions\n        </Button>\n      </div>\n\n      {error && (\n        <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-3 gap-6\">\n        {/* Step List */}\n        <div className=\"col-span-1\">\n          <Card>\n            <CardHeader>\n              <h2 className=\"font-semibold text-secondary-900\">Steps</h2>\n            </CardHeader>\n            <CardBody className=\"p-0\">\n              <div className=\"divide-y divide-secondary-100\">\n                {execution.step_executions?.map((step) => (\n                  <div\n                    key={step.id}\n                    className={`p-4 cursor-pointer transition-colors ${\n                      selectedStep?.id === step.id\n                        ? 'bg-primary-50'\n                        : 'hover:bg-secondary-50'\n                    }`}\n                    onClick={() => setSelectedStep(step)}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-3\">\n                        <StepStatusIcon status={step.status} />\n                        <div>\n                          <h4 className=\"font-medium text-secondary-900\">\n                            <TranslatedText text={step.step_name || ''} />\n                          </h4>\n                          <p className=\"text-sm text-secondary-500\">\n                            {step.ai_model_used || step.ai_model || 'AI'}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardBody>\n          </Card>\n        </div>\n\n        {/* Step Output */}\n        <div className=\"col-span-2\">\n          {selectedStep ? (\n            <Card>\n              <CardHeader className=\"flex items-center justify-between\">\n                <div>\n                  <h2 className=\"font-semibold text-secondary-900\">\n                    <TranslatedText text={selectedStep.step_name || ''} />\n                  </h2>\n                  <span className={`inline-block mt-1 px-2 py-0.5 text-xs font-medium rounded ${statusColors[selectedStep.status]}`}>\n                    {selectedStep.status}\n                  </span>\n                </div>\n                {selectedStep.status === 'awaiting_review' && (\n                  <div className=\"flex items-center space-x-2\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => openPromptEditor(selectedStep)}\n                    >\n                      Edit Prompt\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"danger\"\n                      onClick={() => handleReject(selectedStep)}\n                      isLoading={actionLoading === `reject-${selectedStep.id}`}\n                    >\n                      Reject\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={() => handleApprove(selectedStep)}\n                      isLoading={actionLoading === `approve-${selectedStep.id}`}\n                    >\n                      Approve\n                    </Button>\n                  </div>\n                )}\n                {selectedStep.status === 'failed' && (\n                  <Button\n                    size=\"sm\"\n                    onClick={() => openPromptEditor(selectedStep)}\n                  >\n                    Retry\n                  </Button>\n                )}\n              </CardHeader>\n              <CardBody>\n                {selectedStep.status === 'pending' && (\n                  <div className=\"text-center py-8 text-secondary-500\">\n                    This step hasn't been executed yet.\n                  </div>\n                )}\n                {selectedStep.status === 'running' && (\n                  <div className=\"text-center py-8\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"></div>\n                    <p className=\"text-secondary-500 mt-4\">Processing...</p>\n                  </div>\n                )}\n                {selectedStep.status === 'failed' && selectedStep.error_message && (\n                  <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg mb-4\">\n                    {selectedStep.error_message}\n                  </div>\n                )}\n                {(selectedStep.status === 'completed' ||\n                  selectedStep.status === 'awaiting_review') &&\n                  selectedStep.output && (\n                    <div>\n                      {/* Generated Images Display */}\n                      {selectedStep.output.generatedImages && selectedStep.output.generatedImages.length > 0 && (\n                        <div className=\"mb-6\">\n                          <h3 className=\"text-sm font-medium text-secondary-700 mb-3\">{t('generatedImages')}</h3>\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            {selectedStep.output.generatedImages.map((image, index) => (\n                              <div key={index} className=\"relative group\">\n                                <div className=\"bg-secondary-100 rounded-lg overflow-hidden border border-secondary-200\">\n                                  <img\n                                    src={`data:${image.mimeType};base64,${image.base64}`}\n                                    alt={`Generated image ${index + 1}`}\n                                    className=\"w-full h-auto object-contain\"\n                                  />\n                                </div>\n                                <div className=\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                  <button\n                                    onClick={() => {\n                                      const win = window.open();\n                                      if (win) {\n                                        win.document.write(`\n                                          <html>\n                                            <head><title>Generated Image ${index + 1}</title></head>\n                                            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\">\n                                              <img src=\"data:${image.mimeType};base64,${image.base64}\" style=\"max-width:100%;max-height:100vh;\" />\n                                            </body>\n                                          </html>\n                                        `);\n                                      }\n                                    }}\n                                    className=\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm flex items-center gap-1\"\n                                    title={t('viewFullSize')}\n                                  >\n                                    <ExpandIcon className=\"w-4 h-4\" />\n                                    {t('viewFullSize')}\n                                  </button>\n                                  <button\n                                    onClick={() => {\n                                      const link = document.createElement('a');\n                                      link.href = `data:${image.mimeType};base64,${image.base64}`;\n                                      link.download = `generated-image-${index + 1}.${image.mimeType.split('/')[1] || 'png'}`;\n                                      document.body.appendChild(link);\n                                      link.click();\n                                      document.body.removeChild(link);\n                                    }}\n                                    className=\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm flex items-center gap-1\"\n                                    title={t('downloadImage')}\n                                  >\n                                    <DownloadIcon className=\"w-4 h-4\" />\n                                    {t('downloadImage')}\n                                  </button>\n                                </div>\n                                <div className=\"absolute top-2 left-2\">\n                                  <span className=\"px-2 py-1 bg-black/50 text-white text-xs rounded\">\n                                    {t('image')} {index + 1}\n                                  </span>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Text Content Display */}\n                      {selectedStep.output.content && (\n                        <ReviewAwareContentDisplay\n                          content={selectedStep.output.content}\n                          stepName={selectedStep.step_name || ''}\n                        />\n                      )}\n                    </div>\n                  )}\n\n                {/* Token Usage */}\n                {selectedStep.output?.usage && (\n                  <div className=\"mt-6 pt-4 border-t border-secondary-200 flex items-center space-x-4 text-sm text-secondary-500\">\n                    <span>Model: {selectedStep.output.model}</span>\n                    <span>\n                      Tokens: {selectedStep.output.usage.promptTokens} in /\n                      {selectedStep.output.usage.completionTokens} out\n                    </span>\n                  </div>\n                )}\n              </CardBody>\n            </Card>\n          ) : (\n            <Card>\n              <CardBody className=\"text-center py-12\">\n                <p className=\"text-secondary-600\">Select a step to view details</p>\n              </CardBody>\n            </Card>\n          )}\n        </div>\n      </div>\n\n      {/* Prompt Editor Modal */}\n      <Modal\n        isOpen={showPromptModal}\n        onClose={() => setShowPromptModal(false)}\n        title=\"Edit Prompt\"\n        size=\"full\"\n      >\n        <div className=\"space-y-4\">\n          <TextArea\n            label=\"Prompt\"\n            value={editedPrompt}\n            onChange={(e) => setEditedPrompt(e.target.value)}\n            rows={15}\n            className=\"font-mono text-sm\"\n          />\n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"ghost\" onClick={() => setShowPromptModal(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleRetry}\n              isLoading={actionLoading?.startsWith('retry')}\n            >\n              Retry with Modified Prompt\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\nfunction StepStatusIcon({ status }: { status: string }) {\n  switch (status) {\n    case 'completed':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center\">\n          <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n          </svg>\n        </div>\n      );\n    case 'running':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center\">\n          <div className=\"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n        </div>\n      );\n    case 'awaiting_review':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center\">\n          <svg className=\"w-4 h-4 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n          </svg>\n        </div>\n      );\n    case 'failed':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center\">\n          <svg className=\"w-4 h-4 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </div>\n      );\n    default:\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-secondary-100 flex items-center justify-center\">\n          <div className=\"w-2 h-2 rounded-full bg-secondary-400\"></div>\n        </div>\n      );\n  }\n}\n\nfunction ExpandIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\" />\n    </svg>\n  );\n}\n\nfunction DownloadIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n    </svg>\n  );\n}\n\n// Component to detect and render review analysis content appropriately\nfunction ReviewAwareContentDisplay({ content, stepName }: { content: string; stepName: string }) {\n  const analysisType = useMemo(() => {\n    const lowerName = stepName.toLowerCase();\n\n    // Detect review analysis step types\n    if (lowerName.includes('categorize') || lowerName.includes('categorization')) {\n      return 'categorized';\n    }\n    if (lowerName.includes('positive') && lowerName.includes('analy')) {\n      return 'positive';\n    }\n    if (lowerName.includes('negative') && lowerName.includes('analy')) {\n      return 'negative';\n    }\n    if (lowerName.includes('summary') || lowerName.includes('executive')) {\n      return 'summary';\n    }\n\n    return null;\n  }, [stepName]);\n\n  // Try to detect if content is JSON\n  const isJson = useMemo(() => {\n    try {\n      JSON.parse(content);\n      return true;\n    } catch {\n      return false;\n    }\n  }, [content]);\n\n  // Use specialized display for review analysis steps\n  if (analysisType) {\n    return <ReviewAnalysisDisplay data={content} type={analysisType} />;\n  }\n\n  // For JSON content, show formatted JSON with copy button\n  if (isJson) {\n    return (\n      <div className=\"relative\">\n        <button\n          onClick={() => navigator.clipboard.writeText(content)}\n          className=\"absolute top-2 right-2 px-2 py-1 text-xs bg-secondary-100 hover:bg-secondary-200 rounded text-secondary-600\"\n        >\n          Copy JSON\n        </button>\n        <pre className=\"bg-secondary-50 p-4 rounded-lg overflow-x-auto text-sm font-mono\">\n          {JSON.stringify(JSON.parse(content), null, 2)}\n        </pre>\n      </div>\n    );\n  }\n\n  // Default: render as markdown\n  return (\n    <div className=\"prose prose-sm max-w-none\">\n      <ReactMarkdown>{content}</ReactMarkdown>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}