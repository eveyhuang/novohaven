{"ast":null,"code":"var _jsxFileName = \"/Users/eveyhuang/Documents/novohaven-app/client/src/components/WorkflowExecution/ExecutionView.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState, useMemo, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\nimport api from '../../services/api';\nimport { Button, Card, CardBody, CardHeader, Modal, TextArea, TranslatedText } from '../common';\nimport { useLanguage } from '../../context/LanguageContext';\nimport { ReviewAnalysisDisplay } from '../ReviewAnalysis';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function ExecutionView() {\n  _s();\n  var _execution$recipe, _execution$step_execu, _selectedStep$output;\n  const {\n    id\n  } = useParams();\n  const navigate = useNavigate();\n  const {\n    t\n  } = useLanguage();\n  const [execution, setExecution] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState(null);\n  const [error, setError] = useState(null);\n  const [selectedStep, setSelectedStep] = useState(null);\n  const [showPromptModal, setShowPromptModal] = useState(false);\n  const [editedPrompt, setEditedPrompt] = useState('');\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const pollingRef = useRef(null);\n  useEffect(() => {\n    if (id) {\n      loadExecution(parseInt(id));\n    }\n  }, [id]);\n\n  // Auto-refresh polling for in-progress executions\n  useEffect(() => {\n    if (!execution || !autoRefresh) {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n      return;\n    }\n\n    // Only poll if execution is running or pending\n    const shouldPoll = ['running', 'pending'].includes(execution.status);\n    if (!shouldPoll) {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n      return;\n    }\n\n    // Set up polling every 3 seconds\n    pollingRef.current = setInterval(async () => {\n      try {\n        var _data$step_executions, _data$step_executions2;\n        const data = await api.getExecution(parseInt(id));\n        setExecution(data);\n\n        // Update selected step if needed\n        const currentStep = (_data$step_executions = data.step_executions) === null || _data$step_executions === void 0 ? void 0 : _data$step_executions.find(se => se.status === 'awaiting_review');\n        if (currentStep && (!selectedStep || selectedStep.id !== currentStep.id)) {\n          setSelectedStep(currentStep);\n        } else if ((_data$step_executions2 = data.step_executions) !== null && _data$step_executions2 !== void 0 && _data$step_executions2.length && !currentStep) {\n          const lastStep = data.step_executions[data.step_executions.length - 1];\n          if (!selectedStep || selectedStep.id !== lastStep.id || selectedStep.status !== lastStep.status) {\n            setSelectedStep(lastStep);\n          }\n        }\n      } catch (err) {\n        console.error('Error polling execution:', err);\n      }\n    }, 3000);\n    return () => {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n      }\n    };\n  }, [execution === null || execution === void 0 ? void 0 : execution.status, autoRefresh, id]);\n  const loadExecution = async executionId => {\n    setIsLoading(true);\n    try {\n      var _data$step_executions3, _data$step_executions4;\n      const data = await api.getExecution(executionId);\n      setExecution(data);\n\n      // Auto-select the current step being reviewed\n      const reviewStep = (_data$step_executions3 = data.step_executions) === null || _data$step_executions3 === void 0 ? void 0 : _data$step_executions3.find(se => se.status === 'awaiting_review');\n      if (reviewStep) {\n        setSelectedStep(reviewStep);\n      } else if ((_data$step_executions4 = data.step_executions) !== null && _data$step_executions4 !== void 0 && _data$step_executions4.length) {\n        setSelectedStep(data.step_executions[data.step_executions.length - 1]);\n      }\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleApprove = async stepExecution => {\n    if (!execution) return;\n    setActionLoading(`approve-${stepExecution.id}`);\n    try {\n      await api.approveStep(execution.id, stepExecution.id);\n      await loadExecution(execution.id);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n  const handleReject = async stepExecution => {\n    if (!execution) return;\n    setActionLoading(`reject-${stepExecution.id}`);\n    try {\n      await api.rejectStep(execution.id, stepExecution.id);\n      await loadExecution(execution.id);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n  const handleRetry = async () => {\n    if (!execution || !selectedStep) return;\n    setActionLoading(`retry-${selectedStep.id}`);\n    setShowPromptModal(false);\n    try {\n      await api.retryStep(execution.id, selectedStep.id, editedPrompt || undefined);\n      await loadExecution(execution.id);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n  const openPromptEditor = step => {\n    setSelectedStep(step);\n    setEditedPrompt(step.prompt_used || '');\n    setShowPromptModal(true);\n  };\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 7\n    }, this);\n  }\n  if (!execution) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-secondary-600\",\n        children: \"Execution not found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        onClick: () => navigate('/executions'),\n        className: \"mt-4\",\n        children: \"View All Executions\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 7\n    }, this);\n  }\n  const statusColors = {\n    pending: 'bg-secondary-100 text-secondary-700',\n    running: 'bg-blue-100 text-blue-700',\n    paused: 'bg-yellow-100 text-yellow-700',\n    completed: 'bg-green-100 text-green-700',\n    failed: 'bg-red-100 text-red-700',\n    awaiting_review: 'bg-purple-100 text-purple-700'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-2xl font-bold text-secondary-900\",\n          children: /*#__PURE__*/_jsxDEV(TranslatedText, {\n            text: ((_execution$recipe = execution.recipe) === null || _execution$recipe === void 0 ? void 0 : _execution$recipe.name) || `Execution #${execution.id}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-3 mt-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: `px-3 py-1 text-sm font-medium rounded-full ${statusColors[execution.status]}`,\n            children: execution.status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-secondary-500\",\n            children: [\"Step \", execution.current_step, \" of \", execution.total_steps]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 13\n          }, this), ['running', 'pending'].includes(execution.status) && /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"flex items-center space-x-2 text-sm text-secondary-600\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: autoRefresh,\n              onChange: e => setAutoRefresh(e.target.checked),\n              className: \"rounded border-secondary-300 text-primary-600 focus:ring-primary-500\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Auto-refresh\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"ghost\",\n        onClick: () => navigate('/executions'),\n        children: \"Back to Executions\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-50 text-red-700 px-4 py-3 rounded-lg\",\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"grid grid-cols-3 gap-6\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-span-1\",\n        children: /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              className: \"font-semibold text-secondary-900\",\n              children: \"Steps\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CardBody, {\n            className: \"p-0\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"divide-y divide-secondary-100\",\n              children: (_execution$step_execu = execution.step_executions) === null || _execution$step_execu === void 0 ? void 0 : _execution$step_execu.map(step => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `p-4 cursor-pointer transition-colors ${(selectedStep === null || selectedStep === void 0 ? void 0 : selectedStep.id) === step.id ? 'bg-primary-50' : 'hover:bg-secondary-50'}`,\n                onClick: () => setSelectedStep(step),\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between\",\n                  children: /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex items-center space-x-3\",\n                    children: [/*#__PURE__*/_jsxDEV(StepStatusIcon, {\n                      status: step.status\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 242,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                        className: \"font-medium text-secondary-900\",\n                        children: /*#__PURE__*/_jsxDEV(TranslatedText, {\n                          text: step.step_name || ''\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 245,\n                          columnNumber: 29\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 244,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: \"text-sm text-secondary-500\",\n                        children: step.ai_model || step.ai_model_used\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 247,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 243,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 241,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 240,\n                  columnNumber: 21\n                }, this)\n              }, step.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-span-2\",\n        children: selectedStep ? /*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n                className: \"font-semibold text-secondary-900\",\n                children: /*#__PURE__*/_jsxDEV(TranslatedText, {\n                  text: selectedStep.step_name || ''\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `inline-block mt-1 px-2 py-0.5 text-xs font-medium rounded ${statusColors[selectedStep.status]}`,\n                children: selectedStep.status\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 17\n            }, this), selectedStep.status === 'awaiting_review' && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                variant: \"ghost\",\n                onClick: () => openPromptEditor(selectedStep),\n                children: \"Edit Prompt\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                variant: \"danger\",\n                onClick: () => handleReject(selectedStep),\n                isLoading: actionLoading === `reject-${selectedStep.id}`,\n                children: \"Reject\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Button, {\n                size: \"sm\",\n                onClick: () => handleApprove(selectedStep),\n                isLoading: actionLoading === `approve-${selectedStep.id}`,\n                children: \"Approve\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 19\n            }, this), selectedStep.status === 'failed' && /*#__PURE__*/_jsxDEV(Button, {\n              size: \"sm\",\n              onClick: () => openPromptEditor(selectedStep),\n              children: \"Retry\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(CardBody, {\n            children: [selectedStep.status === 'pending' && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-8 text-secondary-500\",\n              children: \"This step hasn't been executed yet.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 19\n            }, this), selectedStep.status === 'running' && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center py-8\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 316,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-secondary-500 mt-4\",\n                children: \"Processing...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 19\n            }, this), selectedStep.status === 'failed' && selectedStep.error_message && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"bg-red-50 text-red-700 px-4 py-3 rounded-lg mb-4\",\n              children: selectedStep.error_message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 19\n            }, this), (selectedStep.status === 'completed' || selectedStep.status === 'awaiting_review') && selectedStep.output && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [selectedStep.output.generatedImages && selectedStep.output.generatedImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mb-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"text-sm font-medium text-secondary-700 mb-3\",\n                  children: t('generatedImages')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"grid grid-cols-2 gap-4\",\n                  children: selectedStep.output.generatedImages.map((image, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative group\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"bg-secondary-100 rounded-lg overflow-hidden border border-secondary-200\",\n                      children: /*#__PURE__*/_jsxDEV(\"img\", {\n                        src: `data:${image.mimeType};base64,${image.base64}`,\n                        alt: `Generated image ${index + 1}`,\n                        className: \"w-full h-auto object-contain\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 337,\n                        columnNumber: 35\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 336,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\",\n                      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => {\n                          const win = window.open();\n                          if (win) {\n                            win.document.write(`\n                                          <html>\n                                            <head><title>Generated Image ${index + 1}</title></head>\n                                            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\">\n                                              <img src=\"data:${image.mimeType};base64,${image.base64}\" style=\"max-width:100%;max-height:100vh;\" />\n                                            </body>\n                                          </html>\n                                        `);\n                          }\n                        },\n                        className: \"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm flex items-center gap-1\",\n                        title: t('viewFullSize'),\n                        children: [/*#__PURE__*/_jsxDEV(ExpandIcon, {\n                          className: \"w-4 h-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 361,\n                          columnNumber: 37\n                        }, this), t('viewFullSize')]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 344,\n                        columnNumber: 35\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        onClick: () => {\n                          const link = document.createElement('a');\n                          link.href = `data:${image.mimeType};base64,${image.base64}`;\n                          link.download = `generated-image-${index + 1}.${image.mimeType.split('/')[1] || 'png'}`;\n                          document.body.appendChild(link);\n                          link.click();\n                          document.body.removeChild(link);\n                        },\n                        className: \"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm flex items-center gap-1\",\n                        title: t('downloadImage'),\n                        children: [/*#__PURE__*/_jsxDEV(DownloadIcon, {\n                          className: \"w-4 h-4\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 376,\n                          columnNumber: 37\n                        }, this), t('downloadImage')]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 364,\n                        columnNumber: 35\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 343,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"absolute top-2 left-2\",\n                      children: /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"px-2 py-1 bg-black/50 text-white text-xs rounded\",\n                        children: [t('image'), \" \", index + 1]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 381,\n                        columnNumber: 35\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 380,\n                      columnNumber: 33\n                    }, this)]\n                  }, index, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 335,\n                    columnNumber: 31\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 333,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 25\n              }, this), selectedStep.output.content && /*#__PURE__*/_jsxDEV(ReviewAwareContentDisplay, {\n                content: selectedStep.output.content,\n                stepName: selectedStep.step_name || ''\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 393,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 328,\n              columnNumber: 21\n            }, this), ((_selectedStep$output = selectedStep.output) === null || _selectedStep$output === void 0 ? void 0 : _selectedStep$output.usage) && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 pt-4 border-t border-secondary-200 flex items-center space-x-4 text-sm text-secondary-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"Model: \", selectedStep.output.model]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 404,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"Tokens: \", selectedStep.output.usage.promptTokens, \" in /\", selectedStep.output.usage.completionTokens, \" out\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 405,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(Card, {\n          children: /*#__PURE__*/_jsxDEV(CardBody, {\n            className: \"text-center py-12\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-secondary-600\",\n              children: \"Select a step to view details\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 416,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 415,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: showPromptModal,\n      onClose: () => setShowPromptModal(false),\n      title: \"Edit Prompt\",\n      size: \"full\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(TextArea, {\n          label: \"Prompt\",\n          value: editedPrompt,\n          onChange: e => setEditedPrompt(e.target.value),\n          rows: 15,\n          className: \"font-mono text-sm\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end space-x-3\",\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            variant: \"ghost\",\n            onClick: () => setShowPromptModal(false),\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            onClick: handleRetry,\n            isLoading: actionLoading === null || actionLoading === void 0 ? void 0 : actionLoading.startsWith('retry'),\n            children: \"Retry with Modified Prompt\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 438,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 5\n  }, this);\n}\n_s(ExecutionView, \"hv1ak3705tTeyklP+Vy0HlKYf9E=\", false, function () {\n  return [useParams, useNavigate, useLanguage];\n});\n_c = ExecutionView;\nfunction StepStatusIcon({\n  status\n}) {\n  switch (status) {\n    case 'completed':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"w-4 h-4 text-green-600\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M5 13l4 4L19 7\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 9\n      }, this);\n    case 'running':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 9\n      }, this);\n    case 'awaiting_review':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"w-4 h-4 text-purple-600\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: [/*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 476,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 473,\n        columnNumber: 9\n      }, this);\n    case 'failed':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          className: \"w-4 h-4 text-red-600\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          viewBox: \"0 0 24 24\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            strokeLinecap: \"round\",\n            strokeLinejoin: \"round\",\n            strokeWidth: 2,\n            d: \"M6 18L18 6M6 6l12 12\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 9\n      }, this);\n    default:\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-6 h-6 rounded-full bg-secondary-100 flex items-center justify-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"w-2 h-2 rounded-full bg-secondary-400\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 9\n      }, this);\n  }\n}\n_c2 = StepStatusIcon;\nfunction ExpandIcon({\n  className\n}) {\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    className: className,\n    fill: \"none\",\n    stroke: \"currentColor\",\n    viewBox: \"0 0 24 24\",\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeWidth: 2,\n      d: \"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 499,\n    columnNumber: 5\n  }, this);\n}\n_c3 = ExpandIcon;\nfunction DownloadIcon({\n  className\n}) {\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    className: className,\n    fill: \"none\",\n    stroke: \"currentColor\",\n    viewBox: \"0 0 24 24\",\n    children: /*#__PURE__*/_jsxDEV(\"path\", {\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeWidth: 2,\n      d: \"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 507,\n    columnNumber: 5\n  }, this);\n}\n\n// Component to detect and render review analysis content appropriately\n_c4 = DownloadIcon;\nfunction ReviewAwareContentDisplay({\n  content,\n  stepName\n}) {\n  _s2();\n  const analysisType = useMemo(() => {\n    const lowerName = stepName.toLowerCase();\n\n    // Detect review analysis step types\n    if (lowerName.includes('categorize') || lowerName.includes('categorization')) {\n      return 'categorized';\n    }\n    if (lowerName.includes('positive') && lowerName.includes('analy')) {\n      return 'positive';\n    }\n    if (lowerName.includes('negative') && lowerName.includes('analy')) {\n      return 'negative';\n    }\n    if (lowerName.includes('summary') || lowerName.includes('executive')) {\n      return 'summary';\n    }\n    return null;\n  }, [stepName]);\n\n  // Try to detect if content is JSON\n  const isJson = useMemo(() => {\n    try {\n      JSON.parse(content);\n      return true;\n    } catch {\n      return false;\n    }\n  }, [content]);\n\n  // Use specialized display for review analysis steps\n  if (analysisType) {\n    return /*#__PURE__*/_jsxDEV(ReviewAnalysisDisplay, {\n      data: content,\n      type: analysisType\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 12\n    }, this);\n  }\n\n  // For JSON content, show formatted JSON with copy button\n  if (isJson) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigator.clipboard.writeText(content),\n        className: \"absolute top-2 right-2 px-2 py-1 text-xs bg-secondary-100 hover:bg-secondary-200 rounded text-secondary-600\",\n        children: \"Copy JSON\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"pre\", {\n        className: \"bg-secondary-50 p-4 rounded-lg overflow-x-auto text-sm font-mono\",\n        children: JSON.stringify(JSON.parse(content), null, 2)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 560,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Default: render as markdown\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"prose prose-sm max-w-none\",\n    children: /*#__PURE__*/_jsxDEV(ReactMarkdown, {\n      children: content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 570,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 569,\n    columnNumber: 5\n  }, this);\n}\n_s2(ReviewAwareContentDisplay, \"Gi+v7CxOoe2nfs/nJZIpDDdizSc=\");\n_c5 = ReviewAwareContentDisplay;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"ExecutionView\");\n$RefreshReg$(_c2, \"StepStatusIcon\");\n$RefreshReg$(_c3, \"ExpandIcon\");\n$RefreshReg$(_c4, \"DownloadIcon\");\n$RefreshReg$(_c5, \"ReviewAwareContentDisplay\");","map":{"version":3,"names":["React","useEffect","useState","useMemo","useRef","useParams","useNavigate","ReactMarkdown","api","Button","Card","CardBody","CardHeader","Modal","TextArea","TranslatedText","useLanguage","ReviewAnalysisDisplay","jsxDEV","_jsxDEV","ExecutionView","_s","_execution$recipe","_execution$step_execu","_selectedStep$output","id","navigate","t","execution","setExecution","isLoading","setIsLoading","actionLoading","setActionLoading","error","setError","selectedStep","setSelectedStep","showPromptModal","setShowPromptModal","editedPrompt","setEditedPrompt","autoRefresh","setAutoRefresh","pollingRef","loadExecution","parseInt","current","clearInterval","shouldPoll","includes","status","setInterval","_data$step_executions","_data$step_executions2","data","getExecution","currentStep","step_executions","find","se","length","lastStep","err","console","executionId","_data$step_executions3","_data$step_executions4","reviewStep","message","handleApprove","stepExecution","approveStep","handleReject","rejectStep","handleRetry","retryStep","undefined","openPromptEditor","step","prompt_used","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","statusColors","pending","running","paused","completed","failed","awaiting_review","text","recipe","name","current_step","total_steps","type","checked","onChange","e","target","variant","map","StepStatusIcon","step_name","ai_model","ai_model_used","size","error_message","output","generatedImages","image","index","src","mimeType","base64","alt","win","window","open","document","write","title","ExpandIcon","link","createElement","href","download","split","body","appendChild","click","removeChild","DownloadIcon","content","ReviewAwareContentDisplay","stepName","usage","model","promptTokens","completionTokens","isOpen","onClose","label","value","rows","startsWith","_c","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","_c2","_c3","_c4","_s2","analysisType","lowerName","toLowerCase","isJson","JSON","parse","navigator","clipboard","writeText","stringify","_c5","$RefreshReg$"],"sources":["/Users/eveyhuang/Documents/novohaven-app/client/src/components/WorkflowExecution/ExecutionView.tsx"],"sourcesContent":["import React, { useEffect, useState, useMemo, useRef } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';\nimport { WorkflowExecution, StepExecution, GeneratedImage } from '../../types';\nimport api from '../../services/api';\nimport { Button, Card, CardBody, CardHeader, Modal, TextArea, TranslatedText } from '../common';\nimport { useLanguage } from '../../context/LanguageContext';\nimport { ReviewAnalysisDisplay } from '../ReviewAnalysis';\n\nexport function ExecutionView() {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { t } = useLanguage();\n\n  const [execution, setExecution] = useState<WorkflowExecution | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [actionLoading, setActionLoading] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [selectedStep, setSelectedStep] = useState<StepExecution | null>(null);\n  const [showPromptModal, setShowPromptModal] = useState(false);\n  const [editedPrompt, setEditedPrompt] = useState('');\n  const [autoRefresh, setAutoRefresh] = useState(true);\n  const pollingRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    if (id) {\n      loadExecution(parseInt(id));\n    }\n  }, [id]);\n\n  // Auto-refresh polling for in-progress executions\n  useEffect(() => {\n    if (!execution || !autoRefresh) {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n      return;\n    }\n\n    // Only poll if execution is running or pending\n    const shouldPoll = ['running', 'pending'].includes(execution.status);\n\n    if (!shouldPoll) {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n        pollingRef.current = null;\n      }\n      return;\n    }\n\n    // Set up polling every 3 seconds\n    pollingRef.current = setInterval(async () => {\n      try {\n        const data = await api.getExecution(parseInt(id!));\n        setExecution(data);\n\n        // Update selected step if needed\n        const currentStep = data.step_executions?.find(\n          (se) => se.status === 'awaiting_review'\n        );\n        if (currentStep && (!selectedStep || selectedStep.id !== currentStep.id)) {\n          setSelectedStep(currentStep);\n        } else if (data.step_executions?.length && !currentStep) {\n          const lastStep = data.step_executions[data.step_executions.length - 1];\n          if (!selectedStep || selectedStep.id !== lastStep.id || selectedStep.status !== lastStep.status) {\n            setSelectedStep(lastStep);\n          }\n        }\n      } catch (err) {\n        console.error('Error polling execution:', err);\n      }\n    }, 3000);\n\n    return () => {\n      if (pollingRef.current) {\n        clearInterval(pollingRef.current);\n      }\n    };\n  }, [execution?.status, autoRefresh, id]);\n\n  const loadExecution = async (executionId: number) => {\n    setIsLoading(true);\n    try {\n      const data = await api.getExecution(executionId);\n      setExecution(data);\n\n      // Auto-select the current step being reviewed\n      const reviewStep = data.step_executions?.find(\n        (se) => se.status === 'awaiting_review'\n      );\n      if (reviewStep) {\n        setSelectedStep(reviewStep);\n      } else if (data.step_executions?.length) {\n        setSelectedStep(data.step_executions[data.step_executions.length - 1]);\n      }\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleApprove = async (stepExecution: StepExecution) => {\n    if (!execution) return;\n    setActionLoading(`approve-${stepExecution.id}`);\n    try {\n      await api.approveStep(execution.id, stepExecution.id);\n      await loadExecution(execution.id);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleReject = async (stepExecution: StepExecution) => {\n    if (!execution) return;\n    setActionLoading(`reject-${stepExecution.id}`);\n    try {\n      await api.rejectStep(execution.id, stepExecution.id);\n      await loadExecution(execution.id);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const handleRetry = async () => {\n    if (!execution || !selectedStep) return;\n    setActionLoading(`retry-${selectedStep.id}`);\n    setShowPromptModal(false);\n    try {\n      await api.retryStep(\n        execution.id,\n        selectedStep.id,\n        editedPrompt || undefined\n      );\n      await loadExecution(execution.id);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setActionLoading(null);\n    }\n  };\n\n  const openPromptEditor = (step: StepExecution) => {\n    setSelectedStep(step);\n    setEditedPrompt(step.prompt_used || '');\n    setShowPromptModal(true);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  if (!execution) {\n    return (\n      <div className=\"text-center py-12\">\n        <p className=\"text-secondary-600\">Execution not found</p>\n        <Button onClick={() => navigate('/executions')} className=\"mt-4\">\n          View All Executions\n        </Button>\n      </div>\n    );\n  }\n\n  const statusColors: Record<string, string> = {\n    pending: 'bg-secondary-100 text-secondary-700',\n    running: 'bg-blue-100 text-blue-700',\n    paused: 'bg-yellow-100 text-yellow-700',\n    completed: 'bg-green-100 text-green-700',\n    failed: 'bg-red-100 text-red-700',\n    awaiting_review: 'bg-purple-100 text-purple-700',\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-secondary-900\">\n            <TranslatedText text={execution.recipe?.name || `Execution #${execution.id}`} />\n          </h1>\n          <div className=\"flex items-center space-x-3 mt-2\">\n            <span className={`px-3 py-1 text-sm font-medium rounded-full ${statusColors[execution.status]}`}>\n              {execution.status}\n            </span>\n            <span className=\"text-secondary-500\">\n              Step {execution.current_step} of {execution.total_steps}\n            </span>\n            {['running', 'pending'].includes(execution.status) && (\n              <label className=\"flex items-center space-x-2 text-sm text-secondary-600\">\n                <input\n                  type=\"checkbox\"\n                  checked={autoRefresh}\n                  onChange={(e) => setAutoRefresh(e.target.checked)}\n                  className=\"rounded border-secondary-300 text-primary-600 focus:ring-primary-500\"\n                />\n                <span>Auto-refresh</span>\n              </label>\n            )}\n          </div>\n        </div>\n        <Button variant=\"ghost\" onClick={() => navigate('/executions')}>\n          Back to Executions\n        </Button>\n      </div>\n\n      {error && (\n        <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg\">\n          {error}\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-3 gap-6\">\n        {/* Step List */}\n        <div className=\"col-span-1\">\n          <Card>\n            <CardHeader>\n              <h2 className=\"font-semibold text-secondary-900\">Steps</h2>\n            </CardHeader>\n            <CardBody className=\"p-0\">\n              <div className=\"divide-y divide-secondary-100\">\n                {execution.step_executions?.map((step) => (\n                  <div\n                    key={step.id}\n                    className={`p-4 cursor-pointer transition-colors ${\n                      selectedStep?.id === step.id\n                        ? 'bg-primary-50'\n                        : 'hover:bg-secondary-50'\n                    }`}\n                    onClick={() => setSelectedStep(step)}\n                  >\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-3\">\n                        <StepStatusIcon status={step.status} />\n                        <div>\n                          <h4 className=\"font-medium text-secondary-900\">\n                            <TranslatedText text={step.step_name || ''} />\n                          </h4>\n                          <p className=\"text-sm text-secondary-500\">\n                            {step.ai_model || step.ai_model_used}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </CardBody>\n          </Card>\n        </div>\n\n        {/* Step Output */}\n        <div className=\"col-span-2\">\n          {selectedStep ? (\n            <Card>\n              <CardHeader className=\"flex items-center justify-between\">\n                <div>\n                  <h2 className=\"font-semibold text-secondary-900\">\n                    <TranslatedText text={selectedStep.step_name || ''} />\n                  </h2>\n                  <span className={`inline-block mt-1 px-2 py-0.5 text-xs font-medium rounded ${statusColors[selectedStep.status]}`}>\n                    {selectedStep.status}\n                  </span>\n                </div>\n                {selectedStep.status === 'awaiting_review' && (\n                  <div className=\"flex items-center space-x-2\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => openPromptEditor(selectedStep)}\n                    >\n                      Edit Prompt\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"danger\"\n                      onClick={() => handleReject(selectedStep)}\n                      isLoading={actionLoading === `reject-${selectedStep.id}`}\n                    >\n                      Reject\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={() => handleApprove(selectedStep)}\n                      isLoading={actionLoading === `approve-${selectedStep.id}`}\n                    >\n                      Approve\n                    </Button>\n                  </div>\n                )}\n                {selectedStep.status === 'failed' && (\n                  <Button\n                    size=\"sm\"\n                    onClick={() => openPromptEditor(selectedStep)}\n                  >\n                    Retry\n                  </Button>\n                )}\n              </CardHeader>\n              <CardBody>\n                {selectedStep.status === 'pending' && (\n                  <div className=\"text-center py-8 text-secondary-500\">\n                    This step hasn't been executed yet.\n                  </div>\n                )}\n                {selectedStep.status === 'running' && (\n                  <div className=\"text-center py-8\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600 mx-auto\"></div>\n                    <p className=\"text-secondary-500 mt-4\">Processing...</p>\n                  </div>\n                )}\n                {selectedStep.status === 'failed' && selectedStep.error_message && (\n                  <div className=\"bg-red-50 text-red-700 px-4 py-3 rounded-lg mb-4\">\n                    {selectedStep.error_message}\n                  </div>\n                )}\n                {(selectedStep.status === 'completed' ||\n                  selectedStep.status === 'awaiting_review') &&\n                  selectedStep.output && (\n                    <div>\n                      {/* Generated Images Display */}\n                      {selectedStep.output.generatedImages && selectedStep.output.generatedImages.length > 0 && (\n                        <div className=\"mb-6\">\n                          <h3 className=\"text-sm font-medium text-secondary-700 mb-3\">{t('generatedImages')}</h3>\n                          <div className=\"grid grid-cols-2 gap-4\">\n                            {selectedStep.output.generatedImages.map((image, index) => (\n                              <div key={index} className=\"relative group\">\n                                <div className=\"bg-secondary-100 rounded-lg overflow-hidden border border-secondary-200\">\n                                  <img\n                                    src={`data:${image.mimeType};base64,${image.base64}`}\n                                    alt={`Generated image ${index + 1}`}\n                                    className=\"w-full h-auto object-contain\"\n                                  />\n                                </div>\n                                <div className=\"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                  <button\n                                    onClick={() => {\n                                      const win = window.open();\n                                      if (win) {\n                                        win.document.write(`\n                                          <html>\n                                            <head><title>Generated Image ${index + 1}</title></head>\n                                            <body style=\"margin:0;display:flex;justify-content:center;align-items:center;min-height:100vh;background:#f5f5f5;\">\n                                              <img src=\"data:${image.mimeType};base64,${image.base64}\" style=\"max-width:100%;max-height:100vh;\" />\n                                            </body>\n                                          </html>\n                                        `);\n                                      }\n                                    }}\n                                    className=\"px-3 py-1.5 bg-white/90 hover:bg-white text-secondary-700 text-sm rounded-lg shadow-sm flex items-center gap-1\"\n                                    title={t('viewFullSize')}\n                                  >\n                                    <ExpandIcon className=\"w-4 h-4\" />\n                                    {t('viewFullSize')}\n                                  </button>\n                                  <button\n                                    onClick={() => {\n                                      const link = document.createElement('a');\n                                      link.href = `data:${image.mimeType};base64,${image.base64}`;\n                                      link.download = `generated-image-${index + 1}.${image.mimeType.split('/')[1] || 'png'}`;\n                                      document.body.appendChild(link);\n                                      link.click();\n                                      document.body.removeChild(link);\n                                    }}\n                                    className=\"px-3 py-1.5 bg-primary-600 hover:bg-primary-700 text-white text-sm rounded-lg shadow-sm flex items-center gap-1\"\n                                    title={t('downloadImage')}\n                                  >\n                                    <DownloadIcon className=\"w-4 h-4\" />\n                                    {t('downloadImage')}\n                                  </button>\n                                </div>\n                                <div className=\"absolute top-2 left-2\">\n                                  <span className=\"px-2 py-1 bg-black/50 text-white text-xs rounded\">\n                                    {t('image')} {index + 1}\n                                  </span>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Text Content Display */}\n                      {selectedStep.output.content && (\n                        <ReviewAwareContentDisplay\n                          content={selectedStep.output.content}\n                          stepName={selectedStep.step_name || ''}\n                        />\n                      )}\n                    </div>\n                  )}\n\n                {/* Token Usage */}\n                {selectedStep.output?.usage && (\n                  <div className=\"mt-6 pt-4 border-t border-secondary-200 flex items-center space-x-4 text-sm text-secondary-500\">\n                    <span>Model: {selectedStep.output.model}</span>\n                    <span>\n                      Tokens: {selectedStep.output.usage.promptTokens} in /\n                      {selectedStep.output.usage.completionTokens} out\n                    </span>\n                  </div>\n                )}\n              </CardBody>\n            </Card>\n          ) : (\n            <Card>\n              <CardBody className=\"text-center py-12\">\n                <p className=\"text-secondary-600\">Select a step to view details</p>\n              </CardBody>\n            </Card>\n          )}\n        </div>\n      </div>\n\n      {/* Prompt Editor Modal */}\n      <Modal\n        isOpen={showPromptModal}\n        onClose={() => setShowPromptModal(false)}\n        title=\"Edit Prompt\"\n        size=\"full\"\n      >\n        <div className=\"space-y-4\">\n          <TextArea\n            label=\"Prompt\"\n            value={editedPrompt}\n            onChange={(e) => setEditedPrompt(e.target.value)}\n            rows={15}\n            className=\"font-mono text-sm\"\n          />\n          <div className=\"flex justify-end space-x-3\">\n            <Button variant=\"ghost\" onClick={() => setShowPromptModal(false)}>\n              Cancel\n            </Button>\n            <Button\n              onClick={handleRetry}\n              isLoading={actionLoading?.startsWith('retry')}\n            >\n              Retry with Modified Prompt\n            </Button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}\n\nfunction StepStatusIcon({ status }: { status: string }) {\n  switch (status) {\n    case 'completed':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center\">\n          <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n          </svg>\n        </div>\n      );\n    case 'running':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center\">\n          <div className=\"w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin\"></div>\n        </div>\n      );\n    case 'awaiting_review':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center\">\n          <svg className=\"w-4 h-4 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n          </svg>\n        </div>\n      );\n    case 'failed':\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-red-100 flex items-center justify-center\">\n          <svg className=\"w-4 h-4 text-red-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n          </svg>\n        </div>\n      );\n    default:\n      return (\n        <div className=\"w-6 h-6 rounded-full bg-secondary-100 flex items-center justify-center\">\n          <div className=\"w-2 h-2 rounded-full bg-secondary-400\"></div>\n        </div>\n      );\n  }\n}\n\nfunction ExpandIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4\" />\n    </svg>\n  );\n}\n\nfunction DownloadIcon({ className }: { className?: string }) {\n  return (\n    <svg className={className} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n    </svg>\n  );\n}\n\n// Component to detect and render review analysis content appropriately\nfunction ReviewAwareContentDisplay({ content, stepName }: { content: string; stepName: string }) {\n  const analysisType = useMemo(() => {\n    const lowerName = stepName.toLowerCase();\n\n    // Detect review analysis step types\n    if (lowerName.includes('categorize') || lowerName.includes('categorization')) {\n      return 'categorized';\n    }\n    if (lowerName.includes('positive') && lowerName.includes('analy')) {\n      return 'positive';\n    }\n    if (lowerName.includes('negative') && lowerName.includes('analy')) {\n      return 'negative';\n    }\n    if (lowerName.includes('summary') || lowerName.includes('executive')) {\n      return 'summary';\n    }\n\n    return null;\n  }, [stepName]);\n\n  // Try to detect if content is JSON\n  const isJson = useMemo(() => {\n    try {\n      JSON.parse(content);\n      return true;\n    } catch {\n      return false;\n    }\n  }, [content]);\n\n  // Use specialized display for review analysis steps\n  if (analysisType) {\n    return <ReviewAnalysisDisplay data={content} type={analysisType} />;\n  }\n\n  // For JSON content, show formatted JSON with copy button\n  if (isJson) {\n    return (\n      <div className=\"relative\">\n        <button\n          onClick={() => navigator.clipboard.writeText(content)}\n          className=\"absolute top-2 right-2 px-2 py-1 text-xs bg-secondary-100 hover:bg-secondary-200 rounded text-secondary-600\"\n        >\n          Copy JSON\n        </button>\n        <pre className=\"bg-secondary-50 p-4 rounded-lg overflow-x-auto text-sm font-mono\">\n          {JSON.stringify(JSON.parse(content), null, 2)}\n        </pre>\n      </div>\n    );\n  }\n\n  // Default: render as markdown\n  return (\n    <div className=\"prose prose-sm max-w-none\">\n      <ReactMarkdown>{content}</ReactMarkdown>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}